"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3410],{74946:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var t=l(85893),r=l(11151);const o={title:"[K8s] Kubernetes Controllers",sidebar_position:"20",description:"Kubernetes Controllers",keywords:["kubernetes","controllers"]},s=void 0,a={id:"Kubernetes/Controllers",title:"[K8s] Kubernetes Controllers",description:"Kubernetes Controllers",source:"@site/docs/Kubernetes/Controllers.mdx",sourceDirName:"Kubernetes",slug:"/Kubernetes/Controllers",permalink:"/RulerChen-Website/docs/Kubernetes/Controllers",draft:!1,unlisted:!1,editUrl:"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/Kubernetes/Controllers.mdx",tags:[],version:"current",lastUpdatedAt:1706183872e3,sidebarPosition:20,frontMatter:{title:"[K8s] Kubernetes Controllers",sidebar_position:20,description:"Kubernetes Controllers",keywords:["kubernetes","controllers"]},sidebar:"tutorialSidebar",previous:{title:"[K8s] Kubernetes Pod",permalink:"/RulerChen-Website/docs/Kubernetes/Pod"},next:{title:"[K8s] Kubernetes Scheduler",permalink:"/RulerChen-Website/docs/Kubernetes/Scheduler"}},i={},d=[{value:"Controllers Overview",id:"controllers-overview",level:2},{value:"Controllers Category",id:"controllers-category",level:2},{value:"ReplicaSet",id:"replicaset",level:2},{value:"Deployment",id:"deployment",level:2},{value:"RollingUpdate",id:"rollingupdate",level:3},{value:"Recreate",id:"recreate",level:3},{value:"Rollout",id:"rollout",level:3},{value:"Restart",id:"restart",level:3},{value:"Deployment Strategy",id:"deployment-strategy",level:3},{value:"StatefulSet",id:"statefulset",level:2},{value:"DaemonSet",id:"daemonset",level:2},{value:"Job &amp; CronJob",id:"job--cronjob",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"controllers-overview",children:"Controllers Overview"}),"\n",(0,t.jsx)(n.p,{children:"Controllers \u662f Kubernetes \u7684\u6838\u5fc3\u5143\u4ef6\u4e4b\u4e00\uff0c\u5b83\u5011\u8ca0\u8cac\u76e3\u63a7 Kubernetes \u4e2d\u7684\u8cc7\u6e90\u72c0\u614b\uff0c\u4e26\u4e14\u78ba\u4fdd\u8cc7\u6e90\u7684\u72c0\u614b\u7b26\u5408\u4f7f\u7528\u8005\u6240\u5b9a\u7fa9\u7684\u72c0\u614b\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"controllers-category",children:"Controllers Category"}),"\n",(0,t.jsx)(n.p,{children:"Kubernetes \u4e2d\u6709\u8a31\u591a\u7a2e\u985e\u7684 Controllers\uff0c\u4ee5\u4e0b\u5217\u51fa\u5e7e\u7a2e\u5e38\u898b\u7684 Controllers\uff1a"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Pod Controllers","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"ReplicaSet"}),"\n",(0,t.jsx)(n.li,{children:"Deployment"}),"\n",(0,t.jsx)(n.li,{children:"DaemonSet"}),"\n",(0,t.jsx)(n.li,{children:"StatefulSet"}),"\n",(0,t.jsx)(n.li,{children:"Job"}),"\n",(0,t.jsx)(n.li,{children:"CronJob"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Node Controllers"}),"\n",(0,t.jsx)(n.li,{children:"Service Controllers"}),"\n",(0,t.jsx)(n.li,{children:"Endpoint Controllers"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"replicaset",children:"ReplicaSet"}),"\n",(0,t.jsx)(n.p,{children:"ReplicaSet \u662f kubernetes \u6700\u57fa\u672c\u7684 Pod Controller\uff0c\u5b83\u53ef\u4ee5\u78ba\u4fdd Pod \u7684\u6578\u91cf\u7b26\u5408\u4f7f\u7528\u8005\u6240\u5b9a\u7fa9\u7684\u6578\u91cf\uff0c\n\u57fa\u672c\u4e0a\u6211\u5011\u4e0d\u6703\u76f4\u63a5\u4f7f\u7528 ReplicaSet\uff0c\u800c\u662f\u4f7f\u7528 Deployment \u4f86\u7ba1\u7406 ReplicaSet\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"deployment",children:"Deployment"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53ef\u4ee5\u63cf\u8ff0 Deployment \u7684\u76ee\u6a19\u72c0\u614b\uff0cDeployment \u6703\u78ba\u4fdd\u76ee\u6a19\u72c0\u614b\u8207\u5be6\u969b\u72c0\u614b\u4e00\u81f4\u3002"}),"\n",(0,t.jsx)(n.p,{children:"Deployment \u6703\u5275\u5efa ReplicaSet \u4f86\u78ba\u4fdd\u76ee\u6a19\u72c0\u614b\u4e2d\u7684 Pod \u6578\u91cf\u8207\u5be6\u969b\u72c0\u614b\u4e2d\u7684 Pod \u6578\u91cf\u4e00\u81f4\uff0c\n\u8207 ReplicaSet \u4e0d\u540c\u7684\u662f\uff0cDeployment \u63d0\u4f9b\u4e86\u5f88\u591a\u65b9\u5f0f\u4f86\u66f4\u65b0 Pod\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl create deployment web --image=nginx:1.14.2\nkubectl scale deployment web --replicas=5\n\nkubectl delete deployment web\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: web\n  name: web\nspec:\n  replicas: 5\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n        - image: nginx:1.14.2\n          name: nginx\n"})}),"\n",(0,t.jsx)(n.h3,{id:"rollingupdate",children:"RollingUpdate"}),"\n",(0,t.jsx)(n.p,{children:"Deployment \u9810\u8a2d\u4f7f\u7528 RollingUpdate \u7b56\u7565\uff0c\u7576\u6211\u5011\u66f4\u65b0 Deployment \u7684 Pod Template \u6642\uff0cDeployment \u6703\u9010\u6b65\u66f4\u65b0 Pod\uff0c\n\u6211\u5011\u53ef\u4ee5\u900f\u904e maxSurge \u8207 maxUnavailable \u4f86\u63a7\u5236\u66f4\u65b0 Pod \u7684\u6578\u91cf\u3002"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"maxSurge\uff1a\u6700\u591a\u53ef\u4ee5\u65b0\u589e\u591a\u5c11\u500b Pod"}),"\n",(0,t.jsx)(n.li,{children:"maxUnavailable\uff1a\u6700\u591a\u53ef\u4ee5\u5bb9\u5fcd\u591a\u5c11\u500b Pod \u505c\u6a5f"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 0\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n        - name: nginx\n          image: nginx:1.14.2\n"})}),"\n",(0,t.jsx)(n.h3,{id:"recreate",children:"Recreate"}),"\n",(0,t.jsx)(n.p,{children:"Deployment \u4e5f\u53ef\u4ee5\u4f7f\u7528 Recreate \u7b56\u7565\uff0c\u7576\u6211\u5011\u66f4\u65b0 Deployment \u7684 Pod Template \u6642\uff0cDeployment \u6703\u5148\u522a\u9664\u6240\u6709\u7684 Pod\uff0c\u518d\u91cd\u65b0\u5275\u5efa Pod\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: web\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n        - name: nginx\n          image: nginx:1.14.2\n"})}),"\n",(0,t.jsx)(n.h3,{id:"rollout",children:"Rollout"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u4e5f\u53ef\u4ee5\u4f7f\u7528 Deployment \u4f86\u56de\u6efe Pod \u7684\u7248\u672c\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl rollout history deployment web # \u67e5\u770b\u6b77\u53f2\u7248\u672c\nkubectl rollout history deployment web --revision=1 # \u67e5\u770b\u7279\u5b9a\u7248\u672c\nkubectl rollout undo deployment web --to-revision=1 # \u56de\u6efe\u5230\u7279\u5b9a\u7248\u672c\n"})}),"\n",(0,t.jsx)(n.h3,{id:"restart",children:"Restart"}),"\n",(0,t.jsx)(n.p,{children:"Deployment \u4e5f\u53ef\u4ee5\u7528\u4f86\u91cd\u555f Pod\uff0c\u6703\u5275\u5efa\u4e00\u500b\u65b0\u7684 replicaset \u4f86\u5275\u5efa Pod\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl rollout restart deployment web\n"})}),"\n",(0,t.jsx)(n.h3,{id:"deployment-strategy",children:"Deployment Strategy"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 Deployment \u4f86\u5b8c\u6210 Blue-Green \u90e8\u5c6c\u6216 Canary \u4e4b\u985e\u7684\u90e8\u5c6c\u6a21\u5f0f\u3002"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://ithelp.ithome.com.tw/articles/10290317",children:"Blue-Green"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://ithelp.ithome.com.tw/articles/10290852",children:"Canary"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"statefulset",children:"StatefulSet"}),"\n",(0,t.jsx)(n.p,{children:"StatefulSet \u662f kubernetes \u4e2d\u7528\u4f86\u7ba1\u7406\u6709\u72c0\u614b\u7684\u61c9\u7528\u7a0b\u5f0f\u7684 Controller\uff0c\n\u6709\u72c0\u614b\u61c9\u7528\u662f\u6307\u9700\u8981\u6301\u4e45\u5316\u5b58\u5132\u6216\u7a69\u5b9a\u3001\u552f\u4e00\u7db2\u8def\u6a19\u8b58\u7684\u61c9\u7528\u3002\n\u4f8b\u5982\u8cc7\u6599\u5eab\u3001\u8a0a\u606f\u4f47\u5217\u548c\u6a94\u6848\u7cfb\u7d71\u90fd\u662f\u6709\u72c0\u614b\u61c9\u7528\u3002"}),"\n",(0,t.jsx)(n.p,{children:"StatefulSet \u7528\u4f86\u7ba1\u7406\u67d0\u500b Pod \u7684\u90e8\u5c6c\u548c\u64f4\u5c55\uff0c\u5b83\u6703\u78ba\u4fdd Pod \u7684\u7db2\u8def\u6a19\u8b58\u7b26\u3001\u6301\u4e45\u5316\u5b58\u5132\u548c Pod \u7684\u90e8\u5c6c\u9806\u5e8f\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"daemonset",children:"DaemonSet"}),"\n",(0,t.jsx)(n.p,{children:"DaemonSet \u6703\u78ba\u4fdd\u6bcf\u500b Node \u4e0a\u90fd\u6709\u4e00\u500b Pod\uff0c\u7576\u6211\u5011\u65b0\u589e\u6216\u522a\u9664 Node \u6642\uff0cDaemonSet \u6703\u81ea\u52d5\u65b0\u589e\u6216\u522a\u9664 Pod\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"job--cronjob",children:"Job & CronJob"}),"\n",(0,t.jsx)(n.p,{children:"Job \u53ef\u4ee5\u7528\u65bc\u4e00\u6b21\u6027\u7684\u5de5\u4f5c\uff0c\u4e00\u822c\u662f\u8173\u672c\u4e4b\u985e\u7684\uff0c\u7576 Job \u5b8c\u6210\u5f8c\uff0cPod \u6703\u88ab\u522a\u9664\u3002"}),"\n",(0,t.jsx)(n.p,{children:"CronJob \u53ef\u4ee5\u7528\u65bc\u9031\u671f\u6027\u7684\u5de5\u4f5c\uff0c\u7576 CronJob \u5b8c\u6210\u5f8c\uff0cPod \u6703\u88ab\u522a\u9664\u3002"})]})}function p(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},11151:(e,n,l)=>{l.d(n,{Z:()=>a,a:()=>s});var t=l(67294);const r={},o=t.createContext(r);function s(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);