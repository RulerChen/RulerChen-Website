"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["1409"],{62145:function(e,n,c){c.r(n),c.d(n,{frontMatter:()=>l,default:()=>u,toc:()=>d,metadata:()=>t,assets:()=>r,contentTitle:()=>i});var t=JSON.parse('{"id":"Golang/ut","title":"[Go] \u55AE\u5143\u6E2C\u8A66\u8207\u6027\u80FD\u6E2C\u8A66","description":"Go \u7684\u55AE\u5143\u6E2C\u8A66","source":"@site/docs/Golang/ut.mdx","sourceDirName":"Golang","slug":"/Golang/ut","permalink":"/RulerChen-Website/docs/Golang/ut","draft":false,"unlisted":false,"editUrl":"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/Golang/ut.mdx","tags":[],"version":"current","lastUpdatedAt":1741095426000,"sidebarPosition":40,"frontMatter":{"title":"[Go] \u55AE\u5143\u6E2C\u8A66\u8207\u6027\u80FD\u6E2C\u8A66","sidebar_position":40,"description":"Go \u7684\u55AE\u5143\u6E2C\u8A66","keywords":["Go","\u55AE\u5143\u6E2C\u8A66","testing"]},"sidebar":"tutorialSidebar","previous":{"title":"[Go] \u4F9D\u8CF4\u7BA1\u7406","permalink":"/RulerChen-Website/docs/Golang/dependency"},"next":{"title":"[Go] \u4F75\u767C\u8655\u7406","permalink":"/RulerChen-Website/docs/Golang/mpg"}}'),o=c(85893),s=c(50065);let l={title:"[Go] \u55AE\u5143\u6E2C\u8A66\u8207\u6027\u80FD\u6E2C\u8A66",sidebar_position:40,description:"Go \u7684\u55AE\u5143\u6E2C\u8A66",keywords:["Go","\u55AE\u5143\u6E2C\u8A66","testing"]},i=void 0,r={},d=[{value:"\u55AE\u5143\u6E2C\u8A66",id:"\u55AE\u5143\u6E2C\u8A66",level:2}];function a(e){let n={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"\u672C\u6587\u6703\u4ECB\u7D39 Go \u7684\u55AE\u5143\u6E2C\u8A66\u65B9\u5F0F\uFF0C\u6703\u4F7F\u7528\u9810\u8A2D\u7684\u5957\u4EF6\u4F86\u9032\u884C\u55AE\u5143\u6E2C\u8A66\u8DDF\u6027\u80FD\u6E2C\u8A66"}),"\n",(0,o.jsx)(n.h2,{id:"\u55AE\u5143\u6E2C\u8A66",children:"\u55AE\u5143\u6E2C\u8A66"}),"\n",(0,o.jsx)(n.p,{children:"\u5728\u5BEB\u55AE\u5143\u6E2C\u8A66\u6642\uFF0C\u6709\u4E00\u4E9B\u77E5\u8B58\u9700\u8981\u4E86\u89E3 :"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u55AE\u5143\u6E2C\u8A66\u662F\u6E2C\u8A66\u6700\u5C0F\u7684\u7A0B\u5F0F\u78BC\u55AE\u4F4D\uFF0C\u901A\u5E38\u662F\u4E00\u500B function \u6216\u8005\u4E00\u500B method"}),"\n",(0,o.jsx)(n.li,{children:"\u4E00\u500B\u6E2C\u8A66\u6848\u4F8B\u50C5\u6E2C\u8A66\u4E00\u500B\u529F\u80FD\uFF0C\u4E0D\u540C test case \u4E4B\u9593\u4E0D\u61C9\u8A72\u6709\u76F8\u4F9D\u6027"}),"\n",(0,o.jsx)(n.li,{children:"\u4E0D\u8207\u5916\u90E8\u7CFB\u7D71\u4E92\u52D5\uFF0C\u4E0D\u6703\u6709 I/O\u3001\u7DB2\u8DEF\u8ACB\u6C42\u8207\u8CC7\u6599\u5EAB\u64CD\u4F5C\u7B49\u7B49"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["\u63A5\u4E0B\u4F86\u6703\u4F7F\u7528 Go \u7684\u5167\u5EFA\u5957\u4EF6 ",(0,o.jsx)(n.code,{children:"testing"})," \u642D\u914D ",(0,o.jsx)(n.code,{children:"mockgen"})," \u4F86\u64B0\u5BEB\u55AE\u5143\u6E2C\u8A66\uFF0C\u5B89\u88DD\u524D\u9700\u8981\u78BA\u4FDD GOBIN \u5728 PATH \u4E2D"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"go get github.com/golang/mock/gomock\ngo install github.com/golang/mock/mockgen\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5728\u4E0B\u9762\u9019\u500B\u7BC4\u4F8B\u4E2D\uFF0C\u6211\u5011\u6709\u4E00\u500B ",(0,o.jsx)(n.code,{children:"Calculator"})," \u7684 interface\uFF0C\u88E1\u9762\u6709\u4E00\u500B ",(0,o.jsx)(n.code,{children:"Add"})," \u7684 method\uFF0C\u63A5\u8457\u6709\u4E00\u500B ",(0,o.jsx)(n.code,{children:"ComputeSum"})," \u7684 function \u6703\u547C\u53EB ",(0,o.jsx)(n.code,{children:"Calculator"})," \u7684 ",(0,o.jsx)(n.code,{children:"Add"})," method"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"go mod init unittest\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",metastring:'title="calculator.go"',children:"package calculator\n\ntype Calculator interface {\n	Add(a, b int) int\n}\n\nfunc ComputeSum(calc Calculator, a, b int) int {\n	return calc.Add(a, b)\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u9996\u5148\u6211\u5011\u9700\u8981 mock ",(0,o.jsx)(n.code,{children:"Calculator"})," \u7684 interface\uFF0C\u65B9\u4FBF\u505A\u51FA\u4E00\u4E9B\u5047\u7684\u7D50\u679C\u4F86\u907F\u514D\u53BB\u8207\u5916\u90E8\u4F5C\u4E92\u52D5"]}),"\n",(0,o.jsxs)(n.p,{children:["\u63A5\u8457\u6211\u5011\u53EF\u4EE5\u4F7F\u7528 ",(0,o.jsx)(n.code,{children:"mockgen"})," \u4F86\u7522\u751F mock \u7684\u7A0B\u5F0F\u78BC"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-source"})," : \u8981 mock \u7684\u6A94\u6848"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-destination"})," : \u7522\u751F\u7684 mock \u6A94\u6848"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-package"})," : mock \u6A94\u6848\u7684 package \u540D\u7A31\uFF0C\u6C92\u5BEB\u7684\u8A71\u9810\u8A2D\u662F ",(0,o.jsx)(n.code,{children:"mock_<source_package_name>"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"mockgen -source calculator.go -destination mocks/mock_calculator.go -package mocks\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u6700\u5F8C\u5C31\u53EF\u4EE5\u4F86\u5BEB\u55AE\u5143\u6E2C\u8A66\u4E86\uFF0C\u6211\u5011\u53EF\u4EE5\u4F7F\u7528 ",(0,o.jsx)(n.code,{children:"testing"})," \u5957\u4EF6\u4F86\u64B0\u5BEB\u55AE\u5143\u6E2C\u8A66\uFF0C\u8A18\u5F97\u6A94\u6848\u540D\u7A31\u8981\u4EE5 ",(0,o.jsx)(n.code,{children:"_test.go"})," \u7D50\u5C3E\uFF0C\u6E2C\u8A66\u7684 function \u540D\u7A31\u8981\u4EE5 ",(0,o.jsx)(n.code,{children:"Test"})," \u958B\u982D"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",metastring:'title="calculator_test.go"',children:'package calculator_test\n\nimport (\n	"testing"\n\n	calculator "unittest"\n\n	"unittest/mocks"\n\n	"github.com/golang/mock/gomock"\n)\n\nfunc TestComputeSum(t *testing.T) {\n	ctrl := gomock.NewController(t)\n	defer ctrl.Finish()\n\n	mockCalc := mocks.NewMockCalculator(ctrl)\n\n	a, b := 1, 2\n	mockCalc.EXPECT().Add(a, b).Return(a + b)\n\n	result := calculator.ComputeSum(mockCalc, a, b)\n	if result != 3 {\n		t.Errorf("ComputeSum(%d, %d) = %d; want 3", a, b, result)\n	}\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u63A5\u8457\u4ECB\u7D39\u4E00\u4E9B\u55AE\u5143\u6E2C\u8A66\u5E38\u7528\u7684\u6307\u4EE4 :"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"go test"})," : \u57F7\u884C\u6240\u6709\u7684\u55AE\u5143\u6E2C\u8A66"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"go test -v"})," : \u57F7\u884C\u6240\u6709\u7684\u55AE\u5143\u6E2C\u8A66\u4E26\u4E14\u986F\u793A\u8A73\u7D30\u7684\u7D50\u679C"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"go test -run <test_function_name>"})," : \u57F7\u884C\u7279\u5B9A\u7684\u55AE\u5143\u6E2C\u8A66\uFF0C\u53EF\u4EE5\u4F7F\u7528\u6B63\u898F\u8868\u9054\u5F0F\u4E5F\u53EF\u4EE5\u53EA\u5BEB\u90E8\u5206\u540D\u7A31"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"go test -run <file_name>"})," : \u57F7\u884C\u7279\u5B9A\u7684\u6A94\u6848\u7684\u55AE\u5143\u6E2C\u8A66"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"go test -cover"})," : \u986F\u793A\u6E2C\u8A66\u8986\u84CB\u7387"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"go test -coverprofile coverage.out"})," : \u7522\u751F\u6E2C\u8A66\u8986\u84CB\u7387\u7684\u6A94\u6848"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"go tool cover -html=coverage.out"})," : \u986F\u793A\u6E2C\u8A66\u8986\u84CB\u7387\u7684 HTML"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"start coverage.html"})," : \u7528\u700F\u89BD\u5668\u958B\u555F\u6E2C\u8A66\u8986\u84CB\u7387\u7684 HTML (\u9069\u7528\u65BC Windows\uFF0CMac \u53EF\u4EE5\u4F7F\u7528 ",(0,o.jsx)(n.code,{children:"open coverage.html"}),")"]}),"\n"]}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},50065:function(e,n,c){c.d(n,{Z:()=>i,a:()=>l});var t=c(67294);let o={},s=t.createContext(o);function l(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);