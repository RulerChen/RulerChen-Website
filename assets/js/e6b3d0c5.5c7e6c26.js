"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7395],{5866:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>t,metadata:()=>a,toc:()=>o});var s=r(5893),i=r(1151);const t={title:"[K8s] Kubernetes Service",sidebar_position:"30",description:"Kubernetes Service",keywords:["kubernetes","service"]},c=void 0,a={id:"Kubernetes/Service",title:"[K8s] Kubernetes Service",description:"Kubernetes Service",source:"@site/docs/Kubernetes/Service.mdx",sourceDirName:"Kubernetes",slug:"/Kubernetes/Service",permalink:"/RulerChen-Website/docs/Kubernetes/Service",draft:!1,unlisted:!1,editUrl:"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/Kubernetes/Service.mdx",tags:[],version:"current",lastUpdatedAt:1706183872,formattedLastUpdatedAt:"2024\u5e741\u670825\u65e5",sidebarPosition:30,frontMatter:{title:"[K8s] Kubernetes Service",sidebar_position:30,description:"Kubernetes Service",keywords:["kubernetes","service"]},sidebar:"tutorialSidebar",previous:{title:"[K8s] Kubernetes Scheduler",permalink:"/RulerChen-Website/docs/Kubernetes/Scheduler"},next:{title:"[K8s] Kubernetes Network",permalink:"/RulerChen-Website/docs/Kubernetes/Network"}},l={},o=[{value:"Service Overview",id:"service-overview",level:2},{value:"ClusterIP",id:"clusterip",level:2},{value:"NodePort",id:"nodeport",level:2},{value:"LoadBalancer",id:"loadbalancer",level:2},{value:"ExternalName",id:"externalname",level:2},{value:"Service Discovery",id:"service-discovery",level:2}];function d(e){const n={code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"service-overview",children:"Service Overview"}),"\n",(0,s.jsx)(n.p,{children:"Service \u662f Kubernetes \u4e2d\u7684\u4e00\u500b\u6982\u5ff5\uff0c\u5b83\u662f\u4e00\u500b\u62bd\u8c61\u5c64\uff0c\u7528\u4f86\u5b9a\u7fa9\u4e00\u500b\u61c9\u7528\u7a0b\u5f0f\u7684\u4e00\u500b\u908f\u8f2f\u96c6\u5408\uff0c\n\u9019\u500b\u908f\u8f2f\u96c6\u5408\u53ef\u4ee5\u662f\u4e00\u500b Pod \u6216\u662f\u4e00\u500b Pod \u7684\u7fa4\u96c6\uff0cService \u6703\u63d0\u4f9b\u4e00\u500b\u56fa\u5b9a\u7684 IP \u4f4d\u5740\uff0c\n\u8b93\u5176\u4ed6\u7684\u61c9\u7528\u7a0b\u5f0f\u53ef\u4ee5\u900f\u904e\u9019\u500b IP \u4f4d\u5740\u4f86\u5b58\u53d6\u9019\u500b Service\uff0c\u800c\u4e0d\u9700\u8981\u77e5\u9053\u80cc\u5f8c\u7684 Pod \u7684 IP \u4f4d\u5740\uff0c\n\u9019\u6a23\u7684\u597d\u8655\u662f\u7576 Pod \u7684 IP \u4f4d\u5740\u6539\u8b8a\u6642\uff0c\u4e0d\u9700\u8981\u4fee\u6539\u5176\u4ed6\u61c9\u7528\u7a0b\u5f0f\u7684\u8a2d\u5b9a\uff0c\u53ea\u9700\u8981\u4fee\u6539 Service \u7684\u8a2d\u5b9a\u5373\u53ef\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Service",src:r(338).Z+"",width:"1440",height:"960"})}),"\n",(0,s.jsx)(n.p,{children:"Service \u6709\u4ee5\u4e0b\u5e7e\u7a2e:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ClusterIP"}),"\n",(0,s.jsx)(n.li,{children:"NodePort"}),"\n",(0,s.jsx)(n.li,{children:"LoadBalancer"}),"\n",(0,s.jsx)(n.li,{children:"ExternalName"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"clusterip",children:"ClusterIP"}),"\n",(0,s.jsx)(n.p,{children:"ClusterIP \u662f Kubernetes \u4e2d\u9810\u8a2d\u7684 Service\uff0c\u5b83\u6703\u63d0\u4f9b\u4e00\u500b\u56fa\u5b9a\u7684 IP \u4f4d\u5740\uff0c\n\u8b93\u5176\u4ed6\u7684\u61c9\u7528\u7a0b\u5f0f\u53ef\u4ee5\u900f\u904e\u9019\u500b IP \u4f4d\u5740\u4f86\u5b58\u53d6\u9019\u500b Service\uff0c\u800c\u4e0d\u9700\u8981\u77e5\u9053\u80cc\u5f8c\u7684 Pod \u7684 IP \u4f4d\u5740\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u5011\u9996\u5148\u8981\u5148\u5275\u4e00\u500b Deployment\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: my-nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: my-nginx\n  template:\n    metadata:\n      labels:\n        app: my-nginx\n    spec:\n      containers:\n        - name: nginx\n          image: nginx\n          ports:\n            - containerPort: 80\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u8457\u5275\u4e00\u500b Service\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: my-nginx-service\nspec:\n  type: ClusterIP\n  selector:\n    app: my-nginx\n  ports:\n    - port: 80\n      targetPort: 80\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6700\u5f8c\u6211\u5011\u5c31\u53ef\u4ee5\u5728\u7bc0\u9ede\u4e2d\u900f\u904e service ip \u4f4d\u5740\u4f86\u5b58\u53d6 Pod\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"nodeport",children:"NodePort"}),"\n",(0,s.jsx)(n.p,{children:"\u7576\u6211\u5011\u9700\u8981\u5f9e\u5916\u90e8\u5b58\u53d6 Pod \u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 NodePort\uff0cNodePort \u6703\u5728\u6bcf\u500b\u7bc0\u9ede\u4e0a\u958b\u555f\u4e00\u500b Port\uff0c\n\u4e26\u5c07 Service \u7684 Port \u5c0d\u61c9\u5230\u7bc0\u9ede\u7684 Port \u4e0a\uff0c\u9019\u6a23\u5c31\u53ef\u4ee5\u900f\u904e\u7bc0\u9ede\u7684 IP \u4f4d\u5740\u52a0\u4e0a\u5c0d\u61c9\u7684 Port \u4f86\u5b58\u53d6 Service\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u5011\u4e00\u6a23\u4f7f\u7528\u4e0a\u9762\u7684 Deployment\uff0c\u53ea\u9700\u8981\u4fee\u6539 Service \u7684 type \u70ba NodePort\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl expose deployment my-nginx  --target-port=80 --type=NodePort\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u8a62\u76ee\u524d\u7684 Service\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl get svc\n\nNAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE\nkubernetes   ClusterIP   10.96.0.1       <none>        443/TCP        8d\nmy-nginx     NodePort    10.110.29.234   <none>        80:31916/TCP   7s\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6700\u5f8c\u53ef\u4ee5\u5728 localhost \u4e0a\u8a2a\u554f\u6211\u5011\u7684 Pod\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl 127.0.0.1:31916\n"})}),"\n",(0,s.jsx)(n.h2,{id:"loadbalancer",children:"LoadBalancer"}),"\n",(0,s.jsx)(n.p,{children:"LoadBalancer \u6703\u5728 Cloud Provider \u4e0a\u5efa\u7acb\u4e00\u500b Load Balancer\uff0c\u4e26\u5c07 Service \u7684 Port \u5c0d\u61c9\u5230 Load Balancer \u7684 Port \u4e0a\uff0c\n\u9019\u6a23\u5c31\u53ef\u4ee5\u900f\u904e Load Balancer \u7684 IP \u4f4d\u5740\u52a0\u4e0a\u5c0d\u61c9\u7684 Port \u4f86\u5b58\u53d6 Service\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl expose deployment my-nginx  --target-port=80 --type=LoadBalancer\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u8a62\u76ee\u524d\u7684 Service\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl get svc\n\n$ kubectl get service\nNAME         TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE\nkubernetes   ClusterIP      10.96.0.1       <none>        443/TCP        8d\nmy-nginx     LoadBalancer   10.109.64.250   localhost     80:31261/TCP   7s\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6700\u5f8c\u53ef\u4ee5\u5728 localhost \u4e0a\u8a2a\u554f\u6211\u5011\u7684 Pod\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl localhost:80\n"})}),"\n",(0,s.jsx)(n.h2,{id:"externalname",children:"ExternalName"}),"\n",(0,s.jsx)(n.p,{children:"ExternalName \u6703\u5c07 Service \u7684\u540d\u7a31\u5c0e\u5411\u6307\u5b9a\u7684 DNS \u540d\u7a31\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"kind: Service\napiVersion: v1\nmetadata:\n  name: my-service\n  namespace: prod\nspec:\n  type: ExternalName\n  externalName: my.database.example.com\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7576\u6211\u5011\u518d\u627e my-service.prod.svc \u7684 IP \u4f4d\u5740\u6642\uff0ck8s DNS service \u5c31\u6703\u56de\u61c9 my.database.example.com \u9019\u500b CNAME recrd\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"service-discovery",children:"Service Discovery"}),"\n",(0,s.jsxs)(n.p,{children:["Service Discovery \u662f Kubernetes \u4e2d\u7684\u4e00\u500b\u6982\u5ff5\uff0c\n\u53ef\u4ee5\u8b93\u6211\u6211\u5011\u5728\u4e0d\u77e5\u9053 Pod \u7684 IP \u4f4d\u5740\u7684\u60c5\u6cc1\u4e0b\uff0c\u900f\u904e Service \u7684\u540d\u7a31\u4f86\u5b58\u53d6 Pod\uff0c\n\u9810\u8a2d\u662f ",(0,s.jsx)(n.code,{children:"{service_name}.{namespace}.svc.cluster.local"}),"\u3002"]})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},338:(e,n,r)=>{r.d(n,{Z:()=>s});const s=r.p+"assets/images/1-87382193523752bf397f97bf11d975a4.gif"},1151:(e,n,r)=>{r.d(n,{Z:()=>a,a:()=>c});var s=r(7294);const i={},t=s.createContext(i);function c(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);