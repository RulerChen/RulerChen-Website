"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1694],{18668:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>l,default:()=>E,frontMatter:()=>r,metadata:()=>c,toc:()=>t});var i=s(85893),d=s(11151);const r={title:"Modern SQL",sidebar_position:"2",description:"CMU15-445/645 Modern SQL",keywords:["CMU15-445/645","Modern SQL","CMU15-445/645 \u7b46\u8a18"]},l=void 0,c={id:"CMU15-445/c02",title:"Modern SQL",description:"CMU15-445/645 Modern SQL",source:"@site/docs/CMU15-445/c02.mdx",sourceDirName:"CMU15-445",slug:"/CMU15-445/c02",permalink:"/RulerChen-Website/docs/CMU15-445/c02",draft:!1,unlisted:!1,editUrl:"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/CMU15-445/c02.mdx",tags:[],version:"current",lastUpdatedAt:1725251985e3,sidebarPosition:2,frontMatter:{title:"Modern SQL",sidebar_position:2,description:"CMU15-445/645 Modern SQL",keywords:["CMU15-445/645","Modern SQL","CMU15-445/645 \u7b46\u8a18"]},sidebar:"tutorialSidebar",previous:{title:"Relational Model & Algebra",permalink:"/RulerChen-Website/docs/CMU15-445/c01"},next:{title:"Database Storage",permalink:"/RulerChen-Website/docs/CMU15-445/c03"}},a={},t=[{value:"SQL History",id:"sql-history",level:2},{value:"SQL Introduction",id:"sql-introduction",level:2},{value:"Joins",id:"joins",level:3},{value:"Aggregates",id:"aggregates",level:3},{value:"String Operations",id:"string-operations",level:3},{value:"Date and Time",id:"date-and-time",level:3},{value:"Output Redirection",id:"output-redirection",level:3},{value:"Output Control",id:"output-control",level:3},{value:"Window Functions",id:"window-functions",level:3},{value:"Nested Queries",id:"nested-queries",level:3},{value:"Common Table Expressions",id:"common-table-expressions",level:3},{value:"References",id:"references",level:2}];function o(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.a)(),...n.components},{Head:r}=e;return r||function(n,e){throw new Error("Expected "+(e?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r,{children:(0,i.jsx)("title",{children:"CMU 15-445/645 \u7b46\u8a18 Modern SQL"})}),"\n",(0,i.jsx)(e.h2,{id:"sql-history",children:"SQL History"}),"\n",(0,i.jsx)(e.p,{children:"1971 \u5e74\uff0cIBM \u767c\u660e\u4e86\u7b2c\u4e00\u500b\u67e5\u8a62\u8a9e\u8a00\u53eb\u505a SEQUEL (Structured English Query Language)\uff0c\n\u63a5\u8457\u53c8\u5728 1983 \u5e74\u63a8\u51fa\u4e86\u63a1\u7528\u4e86\u5176\u8a9e\u6cd5\u7684 DB2\uff0cSEQUEL \u4e5f\u96a8\u4e4b\u6539\u540d\u70ba SQL (Structured Query Language)\uff0c\n\u4e26\u52a0\u5165\u4e86 ANSI (1986) \u548c ISO (1987) \u7684\u6a19\u6e96\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"SQL:1999 Regular expressions, Triggers"}),"\n",(0,i.jsx)(e.li,{children:"SQL:2003 XML, Windows, Sequences"}),"\n",(0,i.jsx)(e.li,{children:"SQL:2008 Truncation, Fancy sorting"}),"\n",(0,i.jsx)(e.li,{children:"SQL:2011 Temporal DBs, Pipelined DML"}),"\n",(0,i.jsx)(e.li,{children:"SQL:2016 JSON, Polymorphic tables"}),"\n",(0,i.jsx)(e.li,{children:"SQL:2023 Property Graph Queries, Muti-Dim. Arrays"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"sql-introduction",children:"SQL Introduction"}),"\n",(0,i.jsx)(e.p,{children:"\u8207\u50b3\u7d71\u7684 relational algebra \u76f8\u6bd4\uff0cSQL \u63a1\u7528\u7684\u662f bag (\u7121\u5e8f\u53ef\u91cd\u8986) \u800c\u975e set (\u7121\u5e8f\u4e0d\u53ef\u91cd\u8986)\u3002"}),"\n",(0,i.jsx)(e.p,{children:"SQL \u8a9e\u6cd5\u53ef\u4ee5\u88ab\u5206\u70ba\u4e09\u985e :"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"DML (Data Manipulation Language) : \u67e5\u8a62\u3001\u63d2\u5165\u3001\u66f4\u65b0\u3001\u522a\u9664\u8cc7\u6599"}),"\n",(0,i.jsx)(e.li,{children:"DDL (Data Definition Language) : \u5b9a\u7fa9 table\u3001view\u3001index \u7b49\u7b49"}),"\n",(0,i.jsx)(e.li,{children:"DCL (Data Control Language) : \u5b9a\u7fa9\u6b0a\u9650 (\u8cc7\u5b89\u76f8\u95dc)"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u63a5\u4e0b\u4f86\u6703\u4ecb\u7d39\u5e38\u7528\u8a9e\u6cd5\uff0c\u4f7f\u7528\u7684\u8cc7\u6599\u8868\u5982\u4e0b :"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"sample table",src:s(91347).Z+"",width:"961",height:"538"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"CREATE TABLE student(\n    sid INT PRIMARY KEY,\n    name VARCHAR(16),\n    login VARCHAR(32) UNIQUE,\n    age SMALLINT,\n    gpa FLOAT\n);\n\nCREATE TABLE course(\n    cid VARCHAR(32) PRIMARY KEY,\n    name VARCHAR(32) NOT NULL\n);\n\nCREATE TABLE enrolled(\n    sid INT REFERENCES student(sid),\n    cid VARCHAR(32) REFERENCES course(cid),\n    grade CHAR(1)\n);\n\nINSERT INTO student (sid, name, login, age, gpa) VALUES\n(53666, 'RZA', 'rza@cs', 44, 4.0),\n(53688, 'Bieber', 'jbieber@cs', 27, 3.9),\n(53655, 'Tupac', 'shakur@cs', 25, 3.5);\n\nINSERT INTO course (cid, name) VALUES\n('15-445', 'Database Systems'),\n('15-721', 'Advanced Database Systems'),\n('15-826', 'Data Mining'),\n('15-799', 'Special Topics in Databases');\n\nINSERT INTO enrolled (sid, cid, grade) VALUES\n(53666, '15-445', 'C'),\n(53688, '15-721', 'A'),\n(53688, '15-826', 'B'),\n(53655, '15-445', 'B'),\n(53666, '15-721', 'C');\n"})}),"\n",(0,i.jsx)(e.h3,{id:"joins",children:"Joins"}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u7528\u65bc\u9023\u63a5\u5169\u5f35 table\uff0c\u4e26\u4e14\u53ef\u4ee5\u4f9d\u64da\u4e0d\u540c\u7684\u689d\u4ef6\u4f86\u9023\u63a5\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Inner Join"}),"\n",(0,i.jsx)(e.li,{children:"Left Join"}),"\n",(0,i.jsx)(e.li,{children:"Right Join"}),"\n",(0,i.jsx)(e.li,{children:"Cross Join"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT *\nFROM student AS s\nJOIN enrolled AS e ON s.sid = e.sid;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"aggregates",children:"Aggregates"}),"\n",(0,i.jsxs)(e.p,{children:["\u5e38\u898b\u7684\u5305\u62ec ",(0,i.jsx)(e.code,{children:"COUNT"}),", ",(0,i.jsx)(e.code,{children:"SUM"}),", ",(0,i.jsx)(e.code,{children:"AVG"}),", ",(0,i.jsx)(e.code,{children:"MIN"}),", ",(0,i.jsx)(e.code,{children:"MAX"})," \u7b49\u7b49\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT COUNT(login) AS cnt\nFROM student\nWHERE login LIKE '%@cs';\n\nSELECT COUNT(*) AS cnt\nFROM student\nWHERE login LIKE '%@cs';\n\nSELECT COUNT(1) AS cnt\nFROM student\nWHERE login LIKE '%@cs';\n\nSELECT COUNT(1+1+1) AS cnt\nFROM student\nWHERE login LIKE '%@cs';\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT AVG(gpa), COUNT(sid)\nFROM student\nWHERE login LIKE '%@cs';\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT COUNT(DISTINCT login)\nFROM student\nWHERE login LIKE '%@cs';\n"})}),"\n",(0,i.jsx)(e.p,{children:"Aggregates function \u4e0d\u80fd\u8207\u5176\u4ed6\u6b04\u4f4d\u540c\u6642\u51fa\u73fe\u5728 SELECT \u5b50\u53e5\u4e2d\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u5beb\u6cd5\u662f\u932f\u8aa4\u7684 :"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT AVG(s.gpa), e.cid\nFROM enrolled AS e JOIN student AS s\nON e.sid = s.sid;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u9700\u8981\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"GROUP BY"})," \u5b50\u53e5\u4f86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u6240\u6709\u975e\u805a\u5408\u51fd\u6578\u7684\u6b04\u4f4d\u90fd\u5fc5\u9808\u51fa\u73fe\u5728 ",(0,i.jsx)(e.code,{children:"GROUP BY"})," \u5b50\u53e5\u4e2d\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT AVG(s.gpa), e.cid\nFROM enrolled AS e JOIN student AS s\nON e.sid = s.sid\nGROUP BY e.cid;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679c\u8981\u904e\u6ffe\u7684\u8a71\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"HAVING"})," \u5b50\u53e5"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT AVG(s.gpa), e.cid\nFROM enrolled AS e JOIN student AS s\nON e.sid = s.sid\nGROUP BY e.cid\nHAVING AVG(s.gpa) > 3.8;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"string-operations",children:"String Operations"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0d\u540c\u7684\u8cc7\u6599\u5eab\u6709\u4e0d\u540c\u7684\u6bd4\u8f03\u5b57\u4e32\u4ee5\u53ca\u5927\u5c0f\u5beb\u654f\u611f\u5ea6\uff0c\u5982\u4e0b\u5716\u6240\u793a :"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"string operations",src:s(52879).Z+"",width:"956",height:"534"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4e5f\u53ef\u4ee5\u5728 ",(0,i.jsx)(e.code,{children:"LIKE"})," \u4e2d\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"%"})," \u6216 ",(0,i.jsx)(e.code,{children:"_"})," \u4f86\u9032\u884c\u5b57\u4e32\u6bd4\u8f03\uff0c\n",(0,i.jsx)(e.code,{children:"%"})," \u4ee3\u8868\u4efb\u610f\u9577\u5ea6\u7684\u5b57\u4e32 (\u5305\u62ec\u7a7a\u5b57\u4e32)\uff0c",(0,i.jsx)(e.code,{children:"_"})," \u4ee3\u8868\u4efb\u610f\u55ae\u4e00\u5b57\u5143\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT *\nFROM enrolled AS e\nWHERE e.cid LIKE '15-%';\n\nSELECT *\nFROM student AS s\nWHERE s.login LIKE '%@c_';\n"})}),"\n",(0,i.jsx)(e.p,{children:"SQL-92 \u4e2d\u5b9a\u7fa9\u4e86\u4e00\u4e9b\u5b57\u4e32\u51fd\u6578\uff0c\u4f8b\u5982 :"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT SUBSTRING(name,1,5) AS abbrv_name\nFROM student WHERE sid = 53688\n\nSELECT * FROM student AS s\nWHERE UPPER(s.name) LIKE 'KAN%'\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u9664\u6b64\u4e4b\u5916\uff0c\u5404\u500b\u8cc7\u6599\u5eab\u6709\u4e0d\u540c\u7684\u5b57\u4e32\u51fd\u6578\uff0c\u4f8b\u5982 :"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"-- SQL-92\nSELECT name FROM student\nWHERE login = LOWER(name) || '@cs'\n\n-- MSSQL\nSELECT name FROM student\nWHERE login = LOWER(name) + '@cs'\n\n-- MySQL\nSELECT name FROM student\nWHERE login = CONCAT(LOWER(name), '@cs')\n"})}),"\n",(0,i.jsx)(e.h3,{id:"date-and-time",children:"Date and Time"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0d\u540c\u7684 DBMS \u5dee\u7570\u975e\u5e38\u5927\uff0c\u6240\u4ee5\u9700\u8981\u4f9d\u64da\u4e0d\u540c\u7684 DBMS \u4f86\u64b0\u5beb SQL \u8a9e\u6cd5\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"-- PostgreSQL\nSELECT NOW();\n\nSELECT CURRENT_TIMESTAMP;\n\nSELECT CAST('2023-08-01' AS DATE) - CAST('2023-01-02' AS DATE) AS diff;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"output-redirection",children:"Output Redirection"}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u5c07\u67e5\u8a62\u7d50\u679c\u5132\u5b58\u5230\u53e6\u4e00\u5f35\u5df2\u7d93\u5b58\u5728\u4e14\u6709\u76f8\u540c\u6b04\u4f4d\u7d50\u69cb\u7684 table \u4e2d\uff0c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"-- MySQL\nCREATE TABLE CourseIds (\n    SELECT DISTINCT cid FROM enrolled\n);\n\n-- PostgreSQL\nSELECT DISTINCT cid\nINTO TEMPORARY CourseIds\nFROM enrolled;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4e5f\u53ef\u4ee5\u7528\u65bc insert \u8a9e\u53e5\u4e2d\uff0c\u5c07\u67e5\u8a62\u7d50\u679c\u63d2\u5165\u5230\u53e6\u4e00\u5f35 table \u4e2d\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"-- PostgreSQL\nINSERT INTO CourseIds (cid)\n(SELECT DISTINCT cid FROM enrolled);\n"})}),"\n",(0,i.jsx)(e.h3,{id:"output-control",children:"Output Control"}),"\n",(0,i.jsxs)(e.p,{children:["\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"ORDER BY"})," \u5b50\u53e5\u4f86\u6392\u5e8f\u67e5\u8a62\u7d50\u679c\uff0c\n\u8a9e\u6cd5\u70ba ",(0,i.jsx)(e.code,{children:"ORDER BY <column*> [ASC|DESC]"}),"\uff0c\n\u9810\u8a2d\u70ba ASC\uff0c\u53ef\u4ee5\u4f9d\u64da\u591a\u500b\u6b04\u4f4d\u9032\u884c\u6392\u5e8f\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT sid, grade FROM enrolled\nWHERE cid = '15-721'\nORDER BY 2;\n\nSELECT sid FROM enrolled\nWHERE cid = '15-721'\nORDER BY grade DESC, sid ASC;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"LIMIT"})," \u5b50\u53e5\u4f86\u9650\u5236\u67e5\u8a62\u7d50\u679c\u7684\u6578\u91cf\uff0c\n\u8a9e\u6cd5\u70ba ",(0,i.jsx)(e.code,{children:"LIMIT <number> [OFFSET <number>]"}),"\uff0c"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT * FROM student\nORDER BY sid\nLIMIT 1 OFFSET 1;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u9084\u6709\u4e00\u7a2e\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"FETCH"})," \u7684\u65b9\u6cd5\uff0c\u8a9e\u6cd5\u5982\u4e0b (WITH TIES \u6703\u5c07\u76f8\u540c\u7684\u8cc7\u6599\u5217\u5168\u90e8\u53d6\u51fa) :"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT sid, name\nFROM student\nWHERE login LIKE '%@cs'\nORDER BY gpa\nOFFSET 10 ROWS\nFETCH FIRST 10 ROWS WITH TIES;\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT sid, name\nFROM student\nWHERE login LIKE '%@cs'\nFETCH FIRST 10 ROWS ONLY;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"window-functions",children:"Window Functions"}),"\n",(0,i.jsxs)(e.p,{children:["\u53ef\u4ee5\u5c0d\u6bcf\u4e00\u500b\u6b04\u4f4d\u9032\u884c\u4e00\u4e9b\u904b\u7b97\uff0c\u4f8b\u5982 ",(0,i.jsx)(e.code,{children:"RANK"}),"\u3001",(0,i.jsx)(e.code,{children:"ROW_NUMBER"}),"\u3001",(0,i.jsx)(e.code,{children:"DENSE_RANK"})," \u7b49\u7b49\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT *, ROW_NUMBER() OVER () AS row_num\nFROM enrolled;\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT cid, sid,\n       ROW_NUMBER() OVER (PARTITION BY cid)\nFROM enrolled\nORDER BY cid;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u9078\u6bcf\u5802\u8ab2\u6210\u7e3e\u6700\u9ad8\u7684\u5b78\u751f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT * FROM (\n  SELECT *,\n         RANK() OVER (PARTITION BY cid ORDER BY grade ASC) AS rank\n    FROM enrolled\n  ) AS ranking\nWHERE ranking.rank = 1;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"nested-queries",children:"Nested Queries"}),"\n",(0,i.jsx)(e.p,{children:"\u5305\u542b\u4e86 inner query \u4ee5\u53ca outer query\uff0cinner query \u6703\u5148\u57f7\u884c\uff0c\u7136\u5f8c\u518d\u57f7\u884c outer query\uff0c\u4e14 inner query \u53ef\u4ee5\u4f7f\u7528 outer query \u4e2d\u7684\u6b04\u4f4d\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u53ef\u4ee5\u652f\u6301 ",(0,i.jsx)(e.code,{children:"NOT"}),"\u3001",(0,i.jsx)(e.code,{children:"IN"}),"\u3001",(0,i.jsx)(e.code,{children:"ANY"}),"\u3001",(0,i.jsx)(e.code,{children:"ALL"}),"\u3001",(0,i.jsx)(e.code,{children:"EXISTS"})," \u7b49\u7b49\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT sid, name\nFROM student\nWHERE sid >= ALL (\n    SELECT sid FROM enrolled\n);\n\nSELECT sid, name FROM student\nWHERE sid IN (\n    SELECT MAX(sid) FROM enrolled\n);\n\nSELECT sid, name FROM student\nWHERE sid IN (\n    SELECT sid\n    FROM enrolled\n    ORDER BY sid DESC LIMIT 1\n);\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u9664\u6b64\u4e4b\u5916\u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"LATERAL"})," \u5b50\u53e5\u4f86\u9032\u884c\u67e5\u8a62\uff0c\n",(0,i.jsx)(e.code,{children:"LATERAL"})," \u5b50\u53e5\u53ef\u4ee5\u5c07\u4e00\u500b\u67e5\u8a62\u7684\u7d50\u679c\u4f5c\u70ba\u53e6\u4e00\u500b\u67e5\u8a62\u7684\u8f38\u5165\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT *\nFROM (\n    SELECT 1 AS x\n) AS t1,\nLATERAL (\n    SELECT t1.x+1 AS y\n) AS t2;\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"SELECT * FROM course AS c,\nLATERAL (\n    SELECT COUNT(*) AS cnt\n    FROM enrolled\n    WHERE enrolled.cid = c.cid\n) AS t1,\nLATERAL (\n    SELECT AVG(gpa) AS avg\n    FROM student AS s\n    JOIN enrolled AS e ON s.sid = e.sid\n    WHERE e.cid = c.cid\n) AS t2;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"common-table-expressions",children:"Common Table Expressions"}),"\n",(0,i.jsx)(e.p,{children:"ctes \u53ef\u4ee5\u5e6b\u52a9\u6211\u5011\u5c07\u8907\u96dc\u7684\u67e5\u8a62\u5206\u89e3\u6210\u66f4\u5c0f\u7684\u90e8\u5206\uff0c\n\u4e26\u4e14\u91cd\u8907\u4f7f\u7528\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"WITH cteName AS (\n    SELECT 1\n)\nSELECT * FROM cteName;\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-SQL",children:"WITH cteSource(maxId) AS (\n    SELECT MAX(sid)\n    FROM enrolled\n)\nSELECT name\nFROM student, cteSource\nWHERE student.sid = cteSource.maxId;\n"})}),"\n",(0,i.jsx)(e.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://15445.courses.cs.cmu.edu/fall2023/",children:"CMU 15-445/645: Introduction to Database Systems"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.youtube.com/watch?v=XGMoq-D_mao&list=PLSE8ODhjZXjbj8BMuIrRcacnQh20hmY9g&index=2",children:"CMU 15-445/645: Introduction to Database Systems Youtube 2023 Fall"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://zhenghe.gitbook.io/open-courses/cmu-15-445-645-database-systems/advanced-sql",children:"Notes 1"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://akebee.com/sql-join/",children:"Join \u65b9\u6cd5"})}),"\n"]})]})}function E(n={}){const{wrapper:e}={...(0,d.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(o,{...n})}):o(n)}},52879:(n,e,s)=>{s.d(e,{Z:()=>i});const i=s.p+"assets/images/image-1-b351289ca19478bb368d9b9b54a7a15c.png"},91347:(n,e,s)=>{s.d(e,{Z:()=>i});const i=s.p+"assets/images/image-bfa1fb8a253fc0007ee6f232d7246bed.png"},11151:(n,e,s)=>{s.d(e,{Z:()=>c,a:()=>l});var i=s(67294);const d={},r=i.createContext(d);function l(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:l(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);