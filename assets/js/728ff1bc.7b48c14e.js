"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5548],{6875:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>o});var s=n(85893),t=n(11151);const a={title:"Distributed OLTP Database Systems",sidebar_position:"22",description:"CMU15-445/645 Distributed OLTP Database Systems",keywords:["CMU15-445/645","Distributed OLTP Database Systems","CMU15-445/645 \u7b46\u8a18"]},c=void 0,l={id:"CMU15-445/c22",title:"Distributed OLTP Database Systems",description:"CMU15-445/645 Distributed OLTP Database Systems",source:"@site/docs/CMU15-445/c22.mdx",sourceDirName:"CMU15-445",slug:"/CMU15-445/c22",permalink:"/RulerChen-Website/docs/CMU15-445/c22",draft:!1,unlisted:!1,editUrl:"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/CMU15-445/c22.mdx",tags:[],version:"current",lastUpdatedAt:1725251985e3,sidebarPosition:22,frontMatter:{title:"Distributed OLTP Database Systems",sidebar_position:22,description:"CMU15-445/645 Distributed OLTP Database Systems",keywords:["CMU15-445/645","Distributed OLTP Database Systems","CMU15-445/645 \u7b46\u8a18"]},sidebar:"tutorialSidebar",previous:{title:"Introduction to Distributed Databases",permalink:"/RulerChen-Website/docs/CMU15-445/c21"},next:{title:"Distributed OLAP Database Systems",permalink:"/RulerChen-Website/docs/CMU15-445/c23"}},r={},o=[{value:"Replication",id:"replication",level:2},{value:"Replication Configuration",id:"replication-configuration",level:3},{value:"Primary-Replica",id:"primary-replica",level:4},{value:"Multi-Master",id:"multi-master",level:4},{value:"K-safety",id:"k-safety",level:4},{value:"Propagation Scheme",id:"propagation-scheme",level:3},{value:"Synchronous Propagation",id:"synchronous-propagation",level:4},{value:"Asynchronous Propagation",id:"asynchronous-propagation",level:4},{value:"Propagation Timing",id:"propagation-timing",level:3},{value:"Continuous Propagation",id:"continuous-propagation",level:4},{value:"On Commit Propagation",id:"on-commit-propagation",level:4},{value:"Active vs Passive",id:"active-vs-passive",level:3},{value:"Active-Active",id:"active-active",level:4},{value:"Active-Passive",id:"active-passive",level:4},{value:"Atomic Commit Protocols",id:"atomic-commit-protocols",level:2},{value:"Two-Phase Commit (2PC)",id:"two-phase-commit-2pc",level:3},{value:"2PC Success",id:"2pc-success",level:4},{value:"2PC Abort",id:"2pc-abort",level:4},{value:"2PC Optimization",id:"2pc-optimization",level:4},{value:"2PC Fault Tolerance",id:"2pc-fault-tolerance",level:4},{value:"Paxos",id:"paxos",level:3},{value:"Multi-Paxos",id:"multi-paxos",level:4},{value:"Consistency Issues (CAP / PACELC)",id:"consistency-issues-cap--pacelc",level:2},{value:"CAP",id:"cap",level:3},{value:"PACELC",id:"pacelc",level:3},{value:"CAP vs PACELC",id:"cap-vs-pacelc",level:3},{value:"Google Spanner",id:"google-spanner",level:2},{value:"References",id:"references",level:2}];function d(e){const i={a:"a",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",ul:"ul",...(0,t.a)(),...e.components},{Head:a}=i;return a||function(e,i){throw new Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a,{children:(0,s.jsx)("title",{children:"CMU 15-445/645 \u7b46\u8a18 Distributed OLTP Database Systems"})}),"\n",(0,s.jsx)(i.p,{children:"\u5728\u4e0a\u7bc0\u4e2d\uff0c\u6211\u5011\u8a0e\u8ad6\u4e86\u57fa\u672c\u7684\u5206\u6563\u5f0f\u8cc7\u6599\u5eab\u7cfb\u7d71\uff0c\u4f46\u4ecd\u7136\u6709\u5f88\u591a\u7d30\u7bc0\u6c92\u6709\u8a0e\u8ad6\u5230\uff0c\u9019\u7bc0\u6703\u8a0e\u8ad6\u4e00\u4e9b\u5206\u6563\u5f0f OLTP \u7cfb\u7d71\u7684\u7d30\u7bc0\uff0c\u50cf\u662f :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u5982\u679c\u5176\u4e2d\u6709\u7bc0\u9ede\u767c\u751f\u6545\u969c\u600e\u9ebc\u8655\u7406"}),"\n",(0,s.jsx)(i.li,{children:"\u5982\u679c\u8a0a\u606f\u5728\u7db2\u8def\u4e0a\u5ef6\u9072\u600e\u9ebc\u8655\u7406"}),"\n",(0,s.jsx)(i.li,{children:"\u662f\u5426\u9700\u8981\u6240\u6709\u7bc0\u9ede\u90fd\u540c\u610f\u624d\u80fd commit \u4e00\u500b transaction"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"\u6211\u5011\u8981\u5047\u8a2d\u6240\u6709\u7684\u7bc0\u9ede\u90fd\u662f\u53ef\u4fe1\u4efb\u7684\uff0c\u4e0d\u7136\u5c31\u9700\u8981\u63a1\u7528 Byzantine Fault Tolerance \u7684\u65b9\u6cd5 (blockchain)\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"replication",children:"Replication"}),"\n",(0,s.jsx)(i.p,{children:"DBMS \u53ef\u4ee5\u5c07\u8cc7\u6599\u8907\u88fd\u5230\u591a\u500b\u7bc0\u9ede\u4e0a\u4ee5\u53ca\u9ad8\u53ef\u7528\u6027\uff0c\u5728\u5be6\u73fe\u4e0a\uff0c\u6709\u5e7e\u500b\u91cd\u8981\u7684\u8003\u616e\u56e0\u7d20 :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Replication Configuration"}),"\n",(0,s.jsx)(i.li,{children:"Propagation Scheme"}),"\n",(0,s.jsx)(i.li,{children:"Propagation Timing"}),"\n",(0,s.jsx)(i.li,{children:"Update Method"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"replication-configuration",children:"Replication Configuration"}),"\n",(0,s.jsx)(i.p,{children:"\u4e3b\u8981\u53ef\u4ee5\u5206\u70ba\u5169\u7a2e\u65b9\u5f0f\uff0cPrimary-Replica \u548c Multi-Master\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Replication",src:n(99339).Z+"",width:"958",height:"536"})}),"\n",(0,s.jsx)(i.h4,{id:"primary-replica",children:"Primary-Replica"}),"\n",(0,s.jsx)(i.p,{children:"\u6240\u6709\u95dc\u65bc\u5beb\u7684\u64cd\u4f5c\u90fd\u6703\u5148\u5beb\u5230 primary node\uff0c primary node \u66f4\u65b0\u5b8c\u5f8c\u518d\u901a\u77e5\u5176\u4ed6 replica node \u66f4\u65b0\uff0c\u800c\u53ea\u8b80\u7684\u8cc7\u6599\u53ef\u4ee5\u76f4\u63a5\u5f9e replica node \u8b80\u53d6\u3002\n\u5982\u679c master \u7bc0\u9ede\u5d29\u6f70\uff0c\u5247\u7531\u5171\u8b58\u7b97\u6cd5\u9078\u64c7\u65b0\u7684 master \u7bc0\u9ede\u3002"}),"\n",(0,s.jsx)(i.h4,{id:"multi-master",children:"Multi-Master"}),"\n",(0,s.jsx)(i.p,{children:"\u6bcf\u500b\u7bc0\u9ede\u90fd\u53ef\u4ee5\u66f4\u65b0\u8cc7\u6599\uff0c\u4f46\u7bc0\u9ede\u4e4b\u9593\u9700\u8981\u900f\u904e atomic commit protocol \u4f86\u78ba\u4fdd\u4e00\u81f4\u6027\u3002"}),"\n",(0,s.jsx)(i.h4,{id:"k-safety",children:"K-safety"}),"\n",(0,s.jsx)(i.p,{children:"K-safety \u662f\u7528\u4f86\u8861\u91cf\u8cc7\u6599\u5eab\u7684\u5bb9\u932f\u80fd\u529b\u7684\u95be\u503c\uff0cK \u503c\u8868\u793a\u6bcf\u500b\u7269\u4ef6\u5fc5\u9808\u59cb\u7d42\u53ef\u7528\u7684\u526f\u672c\u6578\u91cf\uff0c\u5982\u679c\u526f\u672c\u6578\u91cf\u4f4e\u65bc\u9019\u500b\u95be\u503c\uff0cDBMS \u6703\u505c\u6b62\u7cfb\u7d71\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"propagation-scheme",children:"Propagation Scheme"}),"\n",(0,s.jsx)(i.p,{children:"\u7576\u4ea4\u6613\u5728\u8cc7\u6599\u5eab\u4e0a\u63d0\u4ea4\u6642\uff0cDBMS \u6703\u6c7a\u5b9a\u662f\u5426\u9700\u8981\u7b49\u5f85\u8a72\u4ea4\u6613\u50b3\u64ad\u5230\u5176\u4ed6\u7bc0\u9ede\u5f8c\u518d\u5411\u61c9\u7528\u7a0b\u5f0f\u5ba2\u6236\u7aef\u767c\u9001\u78ba\u8a8d\uff0c\u4e3b\u8981\u6709\u5169\u7a2e\u65b9\u5f0f :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Synchronous Propagation : Strong Consistency"}),"\n",(0,s.jsx)(i.li,{children:"Asynchronous Propagation : Eventual Consistency"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Propagation Scheme",src:n(78171).Z+"",width:"958",height:"537"})}),"\n",(0,s.jsx)(i.h4,{id:"synchronous-propagation",children:"Synchronous Propagation"}),"\n",(0,s.jsx)(i.p,{children:"\u4e3b\u7bc0\u9ede\u5c07\u66f4\u65b0\u767c\u9001\u5230\u5f9e\u7bc0\u9ede\uff0c\u4e26\u7b49\u5f85\u5b83\u5011\u78ba\u8a8d\u5df2\u5b8c\u5168\u61c9\u7528\u66f4\u6539\u5f8c\uff0c\u518d\u901a\u77e5\u5ba2\u6236\u7aef\u66f4\u65b0\u6210\u529f\u3002\n\u78ba\u4fdd\u4e86\u5f37\u4e00\u81f4\u6027\uff0c\u4e0d\u6703\u4e1f\u5931\u4efb\u4f55\u6578\u64da\uff0c\u901a\u5e38\u5728\u50b3\u7d71\u7684 DBMS \u4e2d\u4f7f\u7528\u3002"}),"\n",(0,s.jsx)(i.h4,{id:"asynchronous-propagation",children:"Asynchronous Propagation"}),"\n",(0,s.jsx)(i.p,{children:"\u4e3b\u7bc0\u9ede\u5728\u672c\u5730\u66f4\u65b0\u5b8c\u5f8c\u7acb\u5373\u5411\u61c9\u7528\u7a0b\u5f0f\u8fd4\u56de\u78ba\u8a8d\uff0c\u800c\u4e0d\u7b49\u5f85\u5f9e\u7bc0\u9ede\u66f4\u6539\u5b8c\u6210\u3002\n\u53ef\u80fd\u6703\u5c0e\u81f4\u8b80\u53d6\u904e\u671f\u6578\u64da\uff0c\u4f46\u5982\u679c\u53ef\u4ee5\u5bb9\u5fcd\u67d0\u4e9b\u6578\u64da\u4e1f\u5931\uff0c\u9019\u7a2e\u65b9\u5f0f\u662f\u4e00\u7a2e\u6709\u6548\u7684\u512a\u5316\uff0c\u901a\u5e38\u5728 NoSQL \u7cfb\u7d71\u4e2d\u4f7f\u7528\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"propagation-timing",children:"Propagation Timing"}),"\n",(0,s.jsx)(i.p,{children:"\u4e3b\u7bc0\u9ede\u751a\u9ebc\u6642\u5019\u5c07\u66f4\u65b0\u767c\u9001\u5230\u5f9e\u7bc0\u9ede\u7684\u7b56\u7565\uff0c\u4e3b\u8981\u6709\u5169\u7a2e\u65b9\u5f0f :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Continuous Propagation"}),"\n",(0,s.jsx)(i.li,{children:"On Commit Propagation"}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"continuous-propagation",children:"Continuous Propagation"}),"\n",(0,s.jsx)(i.p,{children:"DBMS \u5728\u751f\u6210 log \u5f8c\u7acb\u5373\u767c\u9001 log \u7d66\u5f9e\u7bc0\u9ede\uff0c\u5176\u4e2d\u5305\u62ec\u63d0\u4ea4\u548c\u4e2d\u6b62\u6d88\u606f\u3002"}),"\n",(0,s.jsx)(i.h4,{id:"on-commit-propagation",children:"On Commit Propagation"}),"\n",(0,s.jsx)(i.p,{children:"DBMS \u53ea\u6709\u5728\u4ea4\u6613\u63d0\u4ea4\u5f8c\u624d\u5c07\u8a72\u4ea4\u6613\u7684 log \u767c\u9001\u5230\u5f9e\u7bc0\u9ede\uff0c\u907f\u514d\u4e86\u70ba abort \u7684\u4ea4\u6613\u50b3\u9001 log\uff0c\u4f46\u6703\u5c0e\u81f4\u540c\u6b65\u6548\u7387\u8f03\u4f4e\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"active-vs-passive",children:"Active vs Passive"}),"\n",(0,s.jsx)(i.p,{children:"\u6839\u64da\u5982\u4f55\u5c07\u66f4\u6539\u61c9\u7528\u5230\u5f9e\u7bc0\u9ede\u4e0a\uff0c\u8907\u88fd\u53ef\u4ee5\u5206\u70ba :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Active-Active"}),"\n",(0,s.jsx)(i.li,{children:"Active-Passive"}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"active-active",children:"Active-Active"}),"\n",(0,s.jsx)(i.p,{children:"\u4ea4\u6613\u5728\u6bcf\u500b\u5f9e\u7bc0\u9ede\u4e0a\u7368\u7acb\u57f7\u884c\uff0c\u6700\u5f8c DBMS \u6aa2\u67e5\u6bcf\u500b\u7bc0\u9ede\u4e0a\u7684\u7d50\u679c\u662f\u5426\u4e00\u81f4\uff0c\u4ee5\u78ba\u4fdd\u4ea4\u6613\u6b63\u78ba\u63d0\u4ea4\u3002"}),"\n",(0,s.jsx)(i.h4,{id:"active-passive",children:"Active-Passive"}),"\n",(0,s.jsx)(i.p,{children:"\u4ea4\u6613\u5728\u4e00\u500b\u7bc0\u9ede\u4e0a\u57f7\u884c\uff0c\u7136\u5f8c\u5c07\u7e3d\u9ad4\u66f4\u6539\u50b3\u64ad\u5230\u5f9e\u7bc0\u9ede\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"atomic-commit-protocols",children:"Atomic Commit Protocols"}),"\n",(0,s.jsx)(i.p,{children:"\u7576\u4e00\u500b\u6a6b\u8de8\u591a\u500b\u7bc0\u9ede\u7684\u4ea4\u6613\u5b8c\u6210\u6642\uff0cDBMS \u9700\u8981\u8a62\u554f\u6240\u6709\u53c3\u8207\u7684\u7bc0\u9ede\u662f\u5426\u53ef\u4ee5\u5b89\u5168\u5730\u63d0\u4ea4\u4ea4\u6613\u3002\n\u6839\u64da\u6240\u4f7f\u7528\u7684\u5354\u8b70\uff0c\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u6578\u91cf\u7684\u7bc0\u9ede\u540c\u610f\u624d\u80fd\u63d0\u4ea4\u4ea4\u6613\uff0c"}),"\n",(0,s.jsx)(i.p,{children:"\u5e38\u898b\u7684\u5354\u8b70\u5305\u62ec :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Two-Phase Commit (2PC)"}),"\n",(0,s.jsx)(i.li,{children:"Three-Phase Commit (3PC)"}),"\n",(0,s.jsx)(i.li,{children:"Paxos"}),"\n",(0,s.jsx)(i.li,{children:"Raft"}),"\n",(0,s.jsx)(i.li,{children:"Zookeeper Atomic Broadcast (ZAB)"}),"\n",(0,s.jsx)(i.li,{children:"Viewstamped Replication"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"\u672c\u7bc0\u4e3b\u8981\u8a0e\u8ad6 2PC \u548c Paxos\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"two-phase-commit-2pc",children:"Two-Phase Commit (2PC)"}),"\n",(0,s.jsx)(i.p,{children:"2PC \u662f\u4e00\u500b\u7d93\u5178\u7684\u5206\u6563\u5f0f\u4ea4\u6613\u63d0\u4ea4\u5354\u8b70\uff0c\u5206\u70ba\u5169\u500b\u968e\u6bb5 :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Prepare Phase"}),"\n",(0,s.jsx)(i.li,{children:"Commit Phase"}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"2pc-success",children:"2PC Success"}),"\n",(0,s.jsx)(i.p,{children:"\u9996\u5148\u61c9\u7528\u7a0b\u5f0f\u6703\u5411\u5354\u8abf\u8005\u767c\u9001\u63d0\u4ea4\u8acb\u6c42\u4e4b\u5f8c\u9032\u5165\u6e96\u5099\u968e\u6bb5 (Prepare Phase)\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u5354\u8abf\u8005\u5411\u53c3\u8207\u7bc0\u9ede\u767c\u9001 prepare \u8acb\u6c42\uff0c\u8a62\u554f\u5b83\u5011\u662f\u5426\u53ef\u4ee5\u63d0\u4ea4\u7576\u524d\u4ea4\u6613"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"2PC",src:n(44835).Z+"",width:"958",height:"535"})}),"\n",(0,s.jsx)(i.p,{children:"\u7b49\u5f85\u6240\u6709\u7bc0\u9ede\u56de\u8986 OK \u5f8c\uff0c\u5247\u9032\u5165\u63d0\u4ea4\u968e\u6bb5 (Commit Phase)\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u5354\u8abf\u8005\u6703\u5411\u6240\u6709\u53c3\u8207\u8005\u767c\u9001\u63d0\u4ea4\u6d88\u606f\uff0c\u901a\u77e5\u5b83\u5011\u63d0\u4ea4\u4ea4\u6613\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"2PC",src:n(53235).Z+"",width:"959",height:"537"})}),"\n",(0,s.jsx)(i.p,{children:"\u7b49\u5f85\u6240\u6709\u4ea4\u6613\u63d0\u4ea4\u5f8c\uff0c\u5354\u8abf\u8005\u5411\u61c9\u7528\u7a0b\u5f0f\u56de\u8986\u63d0\u4ea4\u6210\u529f\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"2PC",src:n(72510).Z+"",width:"958",height:"536"})}),"\n",(0,s.jsx)(i.h4,{id:"2pc-abort",children:"2PC Abort"}),"\n",(0,s.jsx)(i.p,{children:"\u5728\u6e96\u5099\u968e\u6bb5\u6642\uff0c\u5982\u679c\u6709\u4efb\u4f55\u4e00\u500b\u7bc0\u9ede\u7121\u6cd5\u57f7\u884c\uff0c\u5247\u61c9\u8a72\u56de\u8986 ABORT \u7d66\u5354\u8abf\u8005\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"2PC",src:n(27230).Z+"",width:"958",height:"537"})}),"\n",(0,s.jsx)(i.p,{children:"\u800c\u6b64\u6642\u5354\u8abf\u8005\u61c9\u8a72\u5411\u61c9\u7528\u7a0b\u5f0f\u56de\u8986\u63d0\u4ea4\u5931\u6557\uff0c\u540c\u6642\u5411\u6240\u6709\u53c3\u8207\u8005\u767c\u9001\u4e2d\u6b62\u6d88\u606f\uff0c\u4e26\u4e14\u78ba\u4fdd\u6240\u6709\u4ea4\u6613\u90fd\u6709\u56de\u6efe\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"2PC",src:n(78667).Z+"",width:"959",height:"536"})}),"\n",(0,s.jsx)(i.h4,{id:"2pc-optimization",children:"2PC Optimization"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Early Prepare Voting (Rare): \u5982\u679c DBMS \u767c\u9001\u7684\u67e5\u8a62\u5df2\u7d93\u662f\u67d0\u500b\u7bc0\u9ede\u6700\u5f8c\u7684\u67e5\u8a62\uff0c\u8a72\u7bc0\u9ede\u53ef\u4ee5\u5c07\u67e5\u8a62\u7d50\u679c\u548c\u6e96\u5099\u968e\u6bb5\u7684\u6295\u7968\u4e00\u8d77\u8fd4\u56de"}),"\n",(0,s.jsx)(i.li,{children:"Early Acknowledgement after Prepare (Common): \u5982\u679c\u6240\u6709\u7bc0\u9ede\u90fd\u5728\u6e96\u5099\u968e\u6bb5\u540c\u610f\u63d0\u4ea4\u4ea4\u6613\uff0c\u5354\u8abf\u8005\u53ef\u4ee5\u5728\u63d0\u4ea4\u968e\u6bb5\u5b8c\u6210\u524d\u5411\u5ba2\u6236\u7aef\u767c\u9001\u6210\u529f\u78ba\u8a8d"}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"2pc-fault-tolerance",children:"2PC Fault Tolerance"}),"\n",(0,s.jsx)(i.p,{children:"\u5728 2PC \u4e2d\uff0c\u6bcf\u500b\u7bc0\u9ede\u90fd\u9700\u8981\u4fdd\u5b58\u6bcf\u500b\u968e\u6bb5\u8f38\u5165\u548c\u8f38\u51fa\u7684 log \u4f86\u5e6b\u52a9\u6062\u5fa9\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u5728 recovery \u6642\u53ef\u80fd\u6703\u6709\u4ee5\u4e0b\u60c5\u6cc1 :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u5982\u679c\u4ea4\u6613\u5728\u6e96\u5099\u968e\u6bb5\uff0c\u5247\u9023\u7d61\u5354\u8abf\u8005\u78ba\u8a8d\u6700\u5f8c\u7684\u4ea4\u6613\u7d50\u679c"}),"\n",(0,s.jsx)(i.li,{children:"\u5982\u679c\u4ea4\u6613\u4e0d\u5728\u6e96\u5099\u72c0\u614b\uff0c\u5247\u8a72\u4ea4\u6613\u7acb\u5373\u4e2d\u6b62\uff0c\u56e0\u70ba\u7bc0\u9ede\u5728\u5d29\u6f70\u4e4b\u524d\u4e26\u672a\u9054\u5230\u6e96\u5099\u72c0\u614b"}),"\n",(0,s.jsx)(i.li,{children:"\u5982\u679c\u4ea4\u6613\u6b63\u5728\u63d0\u4ea4\u4e14\u8a72\u7bc0\u9ede\u662f\u5354\u8abf\u8005\uff0c\u6703\u5728\u91cd\u555f\u5f8c\u5411\u6240\u6709\u53c3\u8207\u7bc0\u9ede\u767c\u9001 COMMIT \u6d88\u606f\uff0c\u4ee5\u5b8c\u6210\u4ea4\u6613\u63d0\u4ea4"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u679c\u662f\u5354\u8abf\u8005\u5728 commit \u4e4b\u524d\u767c\u751f\u6545\u969c\uff0c\u5247\u53ea\u9700\u8981\u7b49\u5f85\u5354\u8abf\u8005\u91cd\u555f\u5f8c\u518d\u6b21\u767c\u9001 COMMIT \u6d88\u606f\u5373\u53ef\uff0c\u5982\u679c\u662f\u5728 commit \u958b\u59cb\u4e4b\u5f8c\u767c\u751f\u6545\u969c\uff0c\u5247\u5176\u4ed6\u7bc0\u9ede\u9700\u8981\u7b49\u5f85\u8a72\u7bc0\u9ede\u91cd\u555f\u6216\u8005\u76f4\u63a5\u6c7a\u5b9a\u65b0\u7684\u5354\u8abf\u8005\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u679c\u662f\u53c3\u8207\u8005\u5728 commit \u958b\u59cb\u4e4b\u524d\u767c\u751f\u6545\u969c\uff0c\u5247\u5354\u8abf\u8005\u53ea\u8981\u4f9d\u64da\u8d85\u6642\u6a5f\u5236\u5c07\u4ea4\u6613\u4e2d\u6b62\u5373\u53ef\uff0c\u5982\u679c\u662f\u5728 commit \u958b\u59cb\u4e4b\u5f8c\u767c\u751f\u6545\u969c\uff0c\u5247\u5354\u8abf\u8005\u9700\u8981\u4e0d\u65b7\u91cd\u8a66\u4f86\u4fdd\u8b49\u4e00\u81f4\u6027\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u7531\u65bc 2PC \u9700\u8981\u7b49\u5f85\u6240\u6709\u7bc0\u9ede\u7684\u56de\u8986\uff0c\u53ef\u80fd\u6703\u5c0e\u81f4 live lock\uff0c\u56e0\u6b64\u6709\u4e86\u5171\u8b58\u7b97\u6cd5\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"paxos",children:"Paxos"}),"\n",(0,s.jsx)(i.p,{children:"Paxos \u662f\u4e00\u7a2e\u5171\u8b58\u7b97\u6cd5\uff0c\u5728\u9019\u500b\u7b97\u6cd5\u4e2d\uff0c\u63d0\u8b70\u8005\u6703\u8ca0\u8cac\u63d0\u4ea4 commit \u6216 abort \u7684\u6307\u4ee4\uff0c\u800c\u63a5\u53d7\u8005\u5247\u6295\u7968\u6c7a\u5b9a\u662f\u5426\u63a5\u53d7\u63d0\u8b70\uff0c\u7531\u65bc\u4e0d\u9700\u8981\u6bcf\u500b\u7bc0\u9ede\u90fd\u540c\u610f\uff0c\u56e0\u6b64\u6548\u80fd\u4e0a\u6703\u6bd4 2PC \u597d\u3002"}),"\n",(0,s.jsx)(i.p,{children:"Paxos \u7684\u5354\u8abf\u8005\u88ab\u7a31\u70ba\u63d0\u8b70\u8005 (Proposer)\uff0c\u53c3\u8207\u8005\u88ab\u7a31\u70ba\u63a5\u53d7\u8005 (Acceptor)\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u9996\u5148\uff0c\u61c9\u7528\u7a0b\u5f0f\u6703\u5411 proposer \u767c\u9001\u63d0\u4ea4\u8acb\u6c42\uff0c\u7136\u5f8c proposer \u6703\u5411 acceptor \u767c\u9001\u63d0\u8b70"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Paxos",src:n(44681).Z+"",width:"960",height:"538"})}),"\n",(0,s.jsx)(i.p,{children:"\u8207 2PC \u4e0d\u540c\u7684\u662f\uff0cPaxos \u4e0d\u9700\u8981\u7b49\u5f85\u6240\u6709\u7bc0\u9ede\u7684\u56de\u8986\uff0c\u53ea\u9700\u8981\u7b49\u5f85\u904e\u534a\u6578\u7684\u7bc0\u9ede\u540c\u610f\u5373\u53ef\uff0c\u56e0\u6b64\u6703\u7e7c\u7e8c\u5411 acceptor \u767c\u9001 commit \u8acb\u6c42\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Paxos",src:n(69022).Z+"",width:"960",height:"538"})}),"\n",(0,s.jsx)(i.p,{children:"\u4f46\u4e0d\u540c\u7684\u662f\uff0c\u5373\u4f7f\u5728 commit \u968e\u6bb5\uff0cacceptor \u4e5f\u53ef\u4ee5\u62d2\u7d55\u63d0\u8b70\uff0c\u8209\u4f8b\u5982\u4e0b :"}),"\n",(0,s.jsx)(i.p,{children:"\u5047\u8a2d\u6709\u5169\u500b proposer\uff0cproposer 1 \u5728 n \u7684\u6642\u9593\u63d0\u51fa\u5354\u8b70\u4e26\u88ab\u6240\u6709\u4eba agree"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Paxos",src:n(22870).Z+"",width:"958",height:"539"})}),"\n",(0,s.jsx)(i.p,{children:"\u9019\u6642\u5019 proposer 2 \u5728 n+1 \u7684\u6642\u9593\u63d0\u51fa\u5354\u8b70\uff0c\u63a5\u8457 proposer 1 \u767c\u51fa commit \u8acb\u6c42\uff0c\u7531\u65bc\u6642\u9593\u5148\u5f8c\u9806\u5e8f\uff0cacceptor \u6703\u62d2\u7d55 proposer 1 \u7684\u63d0\u8b70\uff0c\u4e4b\u5f8c proposer 2 \u6703\u7e7c\u7e8c\u76f4\u5230\u63d0\u4ea4\u5b8c\u6210\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Paxos",src:n(79783).Z+"",width:"958",height:"537"})}),"\n",(0,s.jsx)(i.p,{children:"\u9019\u6a23\u6703\u5c0e\u81f4\u7684\u554f\u984c\u662f\u6709\u53ef\u80fd\u540c\u6642\u5169\u500b proposer \u4e92\u76f8\u7d44\u585e\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u900f\u904e Multi-Paxos \u4f86\u89e3\u6c7a\u9019\u500b\u554f\u984c\u3002"}),"\n",(0,s.jsx)(i.h4,{id:"multi-paxos",children:"Multi-Paxos"}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u679c\u7cfb\u7d71\u5167\u5e38\u6709\u4efb\u610f\u6578\u91cf\u7684 proposer\uff0c\u9054\u6210\u5171\u8b58\u5c31\u6703\u6709\u9ede\u56f0\u96e3\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u5148\u900f\u904e Paxos \u9078\u51fa\u4e00\u500b\u4e3b\u8981\u7684\u63d0\u8b70\u8005\uff0c\u7136\u5f8c\u7531\u4e3b\u8981\u63d0\u8b70\u8005\u4f86\u9032\u884c\u63d0\u8b70\uff0c\u4e26\u5728\u9054\u5230\u4e00\u5b9a\u6642\u9593\u4e4b\u5f8c\u518d\u91cd\u65b0\u9078\u8209\u4e3b\u8981\u63d0\u8b70\u8005\u3002\n\u9019\u6a23\u5728\u4e00\u6bb5\u6642\u9593\u5167\u63d0\u4ea4\u4ea4\u6613\u5c31\u4e0d\u9700\u8981 propose \u800c\u662f\u76f4\u63a5\u9032\u884c commit\uff0c\u9019\u6a23\u5c31\u80fd\u63d0\u9ad8\u6548\u7387\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"consistency-issues-cap--pacelc",children:"Consistency Issues (CAP / PACELC)"}),"\n",(0,s.jsx)(i.h3,{id:"cap",children:"CAP"}),"\n",(0,s.jsx)(i.p,{children:"CAP \u5b9a\u7406\u6307\u51fa\u4e00\u500b\u5206\u6563\u5f0f\u7cfb\u7d71\u7121\u6cd5\u540c\u6642\u6eff\u8db3\u4ee5\u4e0b\u4e09\u500b\u689d\u4ef6 :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u4e00\u81f4\u6027 (Consistency) : \u5c0d\u6240\u6709\u7bc0\u9ede\u4e0a\u7684\u64cd\u4f5c\u4f86\u8aaa\uff0c\u4e00\u65e6\u5beb\u5165\u5b8c\u6210\uff0c\u6240\u6709\u5f8c\u7e8c\u7684\u8b80\u53d6\u61c9\u8a72\u8fd4\u56de\u8a72\u5beb\u5165\u7684\u503c\u6216\u66f4\u665a\u7684\u5beb\u5165\u503c"}),"\n",(0,s.jsx)(i.li,{children:"\u53ef\u7528\u6027 (Availability) : \u53ef\u7528\u6027\u6307\u7684\u662f\u6240\u6709\u4ecd\u5728\u904b\u884c\u7684\u7bc0\u9ede\u90fd\u80fd\u6eff\u8db3\u6240\u6709\u8acb\u6c42\u7684\u80fd\u529b\u3002\u5373\u4f7f\u90e8\u5206\u7bc0\u9ede\u6545\u969c\uff0c\u4ecd\u7136\u80fd\u5920\u63d0\u4f9b\u670d\u52d9"}),"\n",(0,s.jsx)(i.li,{children:"\u5206\u5340\u5bb9\u932f\u6027 (Partition Tolerance) : \u5206\u5340\u5bb9\u932f\u6027\u610f\u5473\u8457\u5373\u4f7f\u7cfb\u7d71\u4e2d\u90e8\u5206\u7bc0\u9ede\u9593\u7684\u6d88\u606f\u4e1f\u5931\uff0c\u7cfb\u7d71\u4ecd\u80fd\u6b63\u78ba\u904b\u884c"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"pacelc",children:"PACELC"}),"\n",(0,s.jsx)(i.p,{children:"CAP \u5b9a\u7406\u7684\u73fe\u4ee3\u7248\u672c\u662f PACELC \u5b9a\u7406\uff0c\u9019\u500b\u5b9a\u7406\u9032\u4e00\u6b65\u8003\u616e\u4e86\u4e00\u81f4\u6027\u548c\u5ef6\u9072\u4e4b\u9593\u7684\u53d6\u6368\u3002"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"P (Partition)\uff1a\u7576\u5728\u7db2\u7d61\u5206\u5340\u6642\uff0c\u7cfb\u7d71\u5fc5\u9808\u5728\u53ef\u7528\u6027 (A) \u548c\u4e00\u81f4\u6027 (C) \u4e4b\u9593\u505a\u51fa\u9078\u64c7\u3002"}),"\n",(0,s.jsx)(i.li,{children:"EL (Else)\uff1a\u5373\u4f7f\u5728\u7cfb\u7d71\u904b\u884c\u6b63\u5e38\u4e14\u7121\u7db2\u7d61\u5206\u5340\u7684\u60c5\u6cc1\u4e0b\uff0c\u4e5f\u5fc5\u9808\u5728\u5ef6\u9072 (L) \u548c\u4e00\u81f4\u6027 (C) \u4e4b\u9593\u505a\u51fa\u9078\u64c7\u3002"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"cap-vs-pacelc",children:"CAP vs PACELC"}),"\n",(0,s.jsx)(i.p,{children:"\u5728 RDBMS \u4e2d\uff0c\u901a\u5e38\u6703\u5728\u91cd\u8981\u7bc0\u9ede\u6545\u969c\u6642\u62d2\u7d55\u5beb\u5165\uff0c\u4ee5\u78ba\u4fdd\u4e00\u81f4\u6027\uff0c\u800c\u5728 NoSQL \u4e2d\uff0c\u901a\u5e38\u6703\u63a5\u53d7\u5beb\u5165\uff0c\u5e38\u63a1\u7528\u7684\u7b56\u7565\u662f\u6700\u5f8c\u4e00\u6b21\u5beb\u5165\u52dd\u51fa\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"google-spanner",children:"Google Spanner"}),"\n",(0,s.jsx)(i.p,{children:"Google Spanner \u662f\u4e00\u500b\u7531 google \u767c\u660e\u7684\u8cc7\u6599\u5eab\u7cfb\u7d71\uff0c\u5177\u6709\u4ee5\u4e0b\u7279\u9ede :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"semi-relational data model\u3001Decentralized shared-disk architecture \u4ee5\u53ca Log-structured on-disk storage"}),"\n",(0,s.jsx)(i.li,{children:"Strict 2PL + MVCC + Multi-Paxos + 2PC"}),"\n",(0,s.jsx)(i.li,{children:"Externally consistent : Spanner \u4fdd\u8b49\u4e8b\u52d9\u5177\u6709\u5916\u90e8\u4e00\u81f4\u6027\uff0c\u9019\u610f\u5473\u8457\u5982\u679c\u4e8b\u52d9 T1 \u5b8c\u6210\u5f8c\u4e8b\u52d9 T2 \u958b\u59cb\uff0c\u5247 T2 \u5fc5\u9808\u770b\u5230 T1 \u7684\u7d50\u679c\u3002\u70ba\u4e86\u5be6\u73fe\u9019\u4e00\u9ede\uff0cSpanner \u4f7f\u7528\u539f\u5b50\u9418\u548c GPS \u7522\u751f\u7684\u5168\u7403\u552f\u4e00\u6642\u9593\u6233\u4f86\u78ba\u4fdd\u4e8b\u52d9\u9806\u5e8f\u3002"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Google Spanner",src:n(51571).Z+"",width:"958",height:"537"})}),"\n",(0,s.jsx)(i.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://15445.courses.cs.cmu.edu/fall2023/",children:"CMU 15-445/645: Introduction to Database Systems"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://www.youtube.com/watch?v=QRJs_57Pung&list=PLSE8ODhjZXjbj8BMuIrRcacnQh20hmY9g&index=23",children:"CMU 15-445/645: Introduction to Database Systems Youtube 2023 Fall"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://poweichen.gitbook.io/blockchain-guide-zh/distribute_system/paxos",children:"Paxos"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,t.a)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},51571:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-1-56adc1282b54205ccc472e2555a0b4ca.png"},22870:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-10-b9e66593cb10ee44f25c0bc9622063b0.png"},79783:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-11-fd00edc8fd7bb2332462357391baa112.png"},78171:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-2-2f3c9375a167b11c8e298a2c03e383c4.png"},44835:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-3-1cd801c54a457af6d563e0c7c2cb94d5.png"},53235:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-4-5f4000faf6aad0ca0253386442573f79.png"},72510:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-5-514f26f78625e00570595b440401ad66.png"},27230:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-6-724046e719b6f1d9d42dc94408aeffaa.png"},78667:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-7-e6195ef49b3240c911b18f382b01cddf.png"},44681:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-8-e210e467a409aeda83d8f348ff857e6d.png"},69022:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-9-cd08efa859e20988afbe9a19bca5fadb.png"},99339:(e,i,n)=>{n.d(i,{Z:()=>s});const s=n.p+"assets/images/image-51ca14fa6ae023a6796f4e3790543be9.png"},11151:(e,i,n)=>{n.d(i,{Z:()=>l,a:()=>c});var s=n(67294);const t={},a=s.createContext(t);function c(e){const i=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),s.createElement(a.Provider,{value:i},e.children)}}}]);