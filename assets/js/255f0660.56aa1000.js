"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["8521"],{42255:function(e,i,n){n.r(i),n.d(i,{frontMatter:()=>a,default:()=>g,toc:()=>r,metadata:()=>l,assets:()=>t,contentTitle:()=>o});var l=JSON.parse('{"id":"CMU15-445/c19","title":"Database Logging","description":"CMU15-445/645 Database Logging","source":"@site/docs/CMU15-445/c19.mdx","sourceDirName":"CMU15-445","slug":"/CMU15-445/c19","permalink":"/RulerChen-Website/docs/CMU15-445/c19","draft":false,"unlisted":false,"editUrl":"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/CMU15-445/c19.mdx","tags":[],"version":"current","lastUpdatedAt":1737467057000,"sidebarPosition":19,"frontMatter":{"title":"Database Logging","sidebar_position":19,"description":"CMU15-445/645 Database Logging","keywords":["CMU15-445/645","Database Logging","CMU15-445/645 \u7B46\u8A18"]},"sidebar":"tutorialSidebar","previous":{"title":"Multi-Version Concurrency Control","permalink":"/RulerChen-Website/docs/CMU15-445/c18"},"next":{"title":"Database Recovery","permalink":"/RulerChen-Website/docs/CMU15-445/c20"}}'),s=n(85893),c=n(50065);let a={title:"Database Logging",sidebar_position:"19",description:"CMU15-445/645 Database Logging",keywords:["CMU15-445/645","Database Logging","CMU15-445/645 \u7B46\u8A18"]},o=void 0,t={},r=[{value:"Failure Classification",id:"failure-classification",level:2},{value:"Transaction Failures",id:"transaction-failures",level:3},{value:"System Failures",id:"system-failures",level:3},{value:"Storage Media Failure",id:"storage-media-failure",level:3},{value:"Buffer Pool Management Policies",id:"buffer-pool-management-policies",level:2},{value:"Steal Policy",id:"steal-policy",level:3},{value:"Force Policy",id:"force-policy",level:3},{value:"Shadow Paging",id:"shadow-paging",level:2},{value:"Write-Ahead Logging (WAL)",id:"write-ahead-logging-wal",level:2},{value:"WAL Group Commit",id:"wal-group-commit",level:3},{value:"Log-Structured System",id:"log-structured-system",level:3},{value:"Logging Schemes",id:"logging-schemes",level:2},{value:"Physical Logging",id:"physical-logging",level:3},{value:"Logical Logging",id:"logical-logging",level:3},{value:"Physiological Logging",id:"physiological-logging",level:3},{value:"Checkpoint",id:"checkpoint",level:2},{value:"Blocking Checkpoint",id:"blocking-checkpoint",level:3}];function d(e){let i={code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",ul:"ul",...(0,c.a)(),...e.components},{Head:l}=i;return l||function(e,i){throw Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l,{children:(0,s.jsx)("title",{children:"CMU 15-445/645 Database Logging"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Database Logging",src:n(10918).Z+"",width:"961",height:"537"})}),"\n",(0,s.jsx)(i.p,{children:"\u8CC7\u6599\u5EAB\u5728\u904B\u884C\u6642\u53EF\u80FD\u6703\u767C\u751F\u5404\u7A2E\u6545\u969C\uFF0C\u5982\u679C\u4E2D\u65B7\u4E86\u4E8B\u52D9\u7684\u904B\u4F5C\uFF0C\u5C31\u53EF\u80FD\u7522\u751F\u8CC7\u6599\u4E0D\u4E00\u81F4\u7684\u554F\u984C\uFF0C\u9019\u6642\u5019\u5C31\u9700\u8981\u6545\u969C\u6062\u5FA9\u6A5F\u5236\u4F86\u4FDD\u8B49\u8CC7\u6599\u7684\u5B8C\u6574\uFF0C\u4E3B\u8981\u6703\u5206\u6210\u5169\u500B\u90E8\u5206\u4F86\u8A0E\u8AD6 :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u5728\u6B63\u5E38\u64CD\u4F5C\u6642\u9032\u884C\u4E00\u4E9B\u6E96\u5099\u5DE5\u4F5C\uFF0C\u4EE5\u78BA\u4FDD\u7CFB\u7D71\u80FD\u5920\u5F9E\u6545\u969C\u4E2D\u6062\u5FA9 (\u672C\u7BC0)"}),"\n",(0,s.jsx)(i.li,{children:"\u6545\u969C\u767C\u751F\u5F8C\uFF0C\u7528\u4F86\u6062\u5FA9\u8CC7\u6599\u5EAB\u72C0\u614B\u7684\u64CD\u4F5C\uFF0C\u4EE5\u78BA\u4FDD\u4EA4\u6613\u7684\u539F\u5B50\u6027\u3001\u4E00\u81F4\u6027\u8207\u6301\u4E45\u6027 (\u4E0B\u4E00\u7BC0)"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"failure-classification",children:"Failure Classification"}),"\n",(0,s.jsx)(i.p,{children:"\u4E16\u754C\u4E0A\u4E26\u4E0D\u5B58\u5728\u5B8C\u5168\u53EF\u9760\u7684\u7CFB\u7D71\uFF0C\u56E0\u6B64\u6211\u5011\u9700\u8981\u8003\u616E\u5404\u7A2E\u53EF\u80FD\u7684\u6545\u969C\u60C5\u6CC1\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"transaction-failures",children:"Transaction Failures"}),"\n",(0,s.jsx)(i.p,{children:"\u9019\u7A2E\u985E\u578B\u7684\u6545\u969C\u767C\u751F\u5728\u4EA4\u6613\u904E\u7A0B\u4E2D\uFF0C\u7531\u65BC\u67D0\u4E9B\u932F\u8AA4\u5C0E\u81F4\u4EA4\u6613\u88AB\u4E2D\u6B62"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Logical Errors : \u4EA4\u6613\u4E2D\u7684\u67D0\u4E9B\u64CD\u4F5C\u5C0E\u81F4\u4E86\u932F\u8AA4\uFF0C\u4F8B\u5982\u9918\u984D\u4E0D\u8DB3"}),"\n",(0,s.jsx)(i.li,{children:"Internal State Errors : \u4EA4\u6613\u4E2D\u7684\u67D0\u4E9B\u64CD\u4F5C\u5C0E\u81F4\u4E86\u7CFB\u7D71\u932F\u8AA4\uFF0C\u4F8B\u5982 deadlock"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"system-failures",children:"System Failures"}),"\n",(0,s.jsx)(i.p,{children:"\u9019\u7A2E\u6545\u969C\u767C\u751F\u5728\u627F\u8F09 DBMS \u7684\u5E95\u5C64\u8EDF\u786C\u9AD4\u51FA\u73FE\u975E\u9810\u671F\u7684\u554F\u984C\u6642"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Software Failure : DBMS \u8EDF\u9AD4\u7684\u5BE6\u73FE\u51FA\u73FE\u554F\u984C\uFF0C\u5982\u9664\u4EE5\u96F6"}),"\n",(0,s.jsx)(i.li,{children:"Hardware Failure : DBMS \u6240\u5728\u7684\u786C\u9AD4\u51FA\u73FE\u932F\u8AA4\uFF0C\u5982\u65B7\u96FB"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"storage-media-failure",children:"Storage Media Failure"}),"\n",(0,s.jsx)(i.p,{children:"\u9019\u7A2E\u6545\u969C\u767C\u751F\u5728\u7269\u7406\u5B58\u5132\u8A2D\u5099\u53D7\u5230\u640D\u58DE\u4E26\u4E14\u7121\u6CD5\u4FEE\u5FA9\u6642\uFF0C\u901A\u5E38\u7121\u6CD5\u4FEE\u5FA9\uFF0C\u53EA\u80FD\u5F9E\u5099\u7528\u7684\u786C\u789F\u6062\u5FA9\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"buffer-pool-management-policies",children:"Buffer Pool Management Policies"}),"\n",(0,s.jsx)(i.p,{children:"\u5728\u6211\u5011\u4FEE\u6539\u8CC7\u6599\u6642\uFF0CDBMS \u9700\u8981\u5148\u628A\u8CC7\u6599\u8B80\u5230\u8A18\u61B6\u9AD4\u4E2D\uFF0C\u7136\u5F8C\u6839\u64DA\u8ACB\u6C42\u9032\u884C\u4FEE\u6539\uFF0C\u6700\u5F8C\u518D\u5C07\u4FEE\u6539\u5F8C\u7684\u8CC7\u6599\u5BEB\u56DE\u786C\u789F\uFF0C\u5728\u9019\u500B\u904E\u7A0B\u4E2D\uFF0CDBMS \u9700\u8981\u4FDD\u8B49\u4EE5\u4E0B\u5169\u9EDE :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u4E00\u65E6\u63D0\u4EA4\u5F8C\uFF0C\u4EA4\u6613\u7684\u4FEE\u6539\u5C31\u61C9\u8A72\u662F\u6C38\u4E45\u7684"}),"\n",(0,s.jsx)(i.li,{children:"\u5982\u679C\u4E2D\u6B62\uFF0C\u4EA4\u6613\u7684\u4FEE\u6539\u4E0D\u61C9\u8A72\u88AB\u6301\u4E45\u5316"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u679C\u771F\u7684\u9047\u5230\u4E86\u6545\u969C\uFF0CDBMS \u53EF\u4EE5\u63A1\u7528\u4EE5\u4E0B\u7684\u65B9\u6CD5\u4F86\u6062\u5FA9\u8CC7\u6599 :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Undo : \u56DE\u6EFE\u5230\u4EA4\u6613\u958B\u59CB\u524D\u7684\u72C0\u614B"}),"\n",(0,s.jsx)(i.li,{children:"Redo : \u91CD\u505A\u4EA4\u6613\u4E2D\u7684\u4FEE\u6539"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"DBMS \u5982\u4F55\u8655\u7406 undo / redo \u4E3B\u8981\u53D6\u6C7A\u65BC Buffer Pool Management Policies\uFF0C\u6709\u5169\u500B\u7B56\u7565 Steal Policy \u8DDF Force Policy\u3002"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Steal Policy : DBMS \u662F\u5426\u5141\u8A31\u5C07\u672A\u63D0\u4EA4\u7684\u66F4\u6539\u5BEB\u5165\u786C\u789F"}),"\n",(0,s.jsx)(i.li,{children:"Force Policy : DBMS \u662F\u5426\u8981\u6C42\u5C07\u63D0\u4EA4\u7684\u66F4\u6539\u5BEB\u5165\u786C\u789F"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"\u4EE5\u4E0B\u5716\u70BA\u4F8B\uFF0CT1 \u8981\u4FEE\u6539 A \u800C T2 \u8981\u4FEE\u6539 B\uFF0C\u4E14 A \u548C B \u90FD\u4F4D\u5728\u540C\u4E00\u500B page \u4E2D\uFF0C\u7576 T2 \u63D0\u4EA4\u6642\uFF0CT1 \u5C1A\u672A\u63D0\u4EA4\u4F46\u5DF2\u7D93\u4FEE\u6539\u4E86 A\uFF0C\u9019\u6642\u5019\u5C31\u9700\u8981\u6839\u64DA Steal Policy \u548C Force Policy \u4F86\u6C7A\u5B9A\u5982\u4F55\u8655\u7406\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Buffer Pool Management Policies",src:n(86305).Z+"",width:"1662",height:"824"})}),"\n",(0,s.jsx)(i.h3,{id:"steal-policy",children:"Steal Policy"}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u679C\u9078\u64C7 steal\uFF0C\u82E5 T1 rollback\uFF0C\u5247\u9700\u8981\u628A\u5DF2\u7D93\u9032\u884C\u6301\u4E45\u5316\u7684\u8CC7\u6599\u91CD\u65B0\u4FEE\u6539\u56DE\u539F\u672C\u7684\u72C0\u614B\u518D\u5B58\u56DE\u786C\u789F\uFF0C\u9019\u7A2E\u65B9\u6CD5\u5728\u4E0D\u767C\u751F\u6545\u969C\u7684\u60C5\u6CC1\u4E0B\u53EF\u4EE5\u63D0\u9AD8\u6548\u7387\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u679C\u9078\u64C7 no-steal\uFF0C\u82E5 T1 rollback\uFF0CDBMS \u4E0D\u9700\u8981\u9032\u884C\u4EFB\u4F55\u64CD\u4F5C\uFF0C\u9019\u7A2E\u65B9\u6CD5\u5728\u767C\u751F\u6545\u969C\u6642\u6548\u7387\u8F03\u9AD8\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"force-policy",children:"Force Policy"}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u679C\u9078\u64C7 force\uFF0C\u7576\u4EA4\u6613\u63D0\u4EA4\u6642\uFF0CDBMS \u9700\u8981\u7ACB\u5373\u5C07\u4FEE\u6539\u5BEB\u56DE\u786C\u789F\uFF0C\u4E00\u81F4\u6027\u8F03\u9AD8\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u679C\u9078\u64C7 no-force\uFF0C\u7576\u4EA4\u6613\u63D0\u4EA4\u6642\uFF0CDBMS \u53EF\u4EE5\u9078\u64C7\u5EF6\u9072\u5C07\u8CC7\u6599\u6279\u91CF\u5BEB\u56DE\u786C\u789F\uFF0C\u6548\u7387\u8F03\u9AD8\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u5728\u5BE6\u52D9\u4E0A\uFF0C\u6211\u5011\u901A\u5E38\u6703\u9078\u64C7 Steal / No-Force \u6216\u8005 No-Steal / Force \u4F86\u9032\u884C\u7BA1\u7406\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"shadow-paging",children:"Shadow Paging"}),"\n",(0,s.jsx)(i.p,{children:"\u5728 buffer pool \u7684\u7B56\u7565\u4E0A\uFF0C\u6700\u5BB9\u6613\u9078\u64C7\u7684\u5C31\u662F No-Steal / Force \u7684\u7D44\u5408\uFF0C\u5728\u4EA4\u6613\u88AB\u4E2D\u6B62\u6642\u4E0D\u9700\u8981\u56DE\u6EFE\u8CC7\u6599\uFF0C\u63D0\u4EA4\u5F8C\u4E5F\u4E0D\u9700\u8981 redo \u8CC7\u6599\uFF0C\u552F\u4E00\u7684\u554F\u984C\u662F\u7121\u6CD5\u8655\u7406\u8D85\u904E buffer pool \u5927\u5C0F\u7684\u8CC7\u6599\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u800C shadow paging \u5C31\u662F\u4E00\u7A2E\u4F7F\u7528 no-steal / force \u7684\u4EE3\u8868\uFF0C\u5B83\u6703\u7DAD\u8B77\u5169\u4EFD\u7368\u7ACB\u7684\u8CC7\u6599\u7248\u672C"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Master : \u5305\u542B\u4E86\u6240\u6709\u5DF2\u63D0\u4EA4\u7684\u4EA4\u6613\u8B8A\u66F4\uFF0C\u662F\u76EE\u524D\u88AB\u6240\u6709\u8B80\u53D6\u64CD\u4F5C\u4F7F\u7528\u7684\u8CC7\u6599\u5EAB\u7248\u672C"}),"\n",(0,s.jsx)(i.li,{children:"Shadow : \u5305\u542B\u4E86\u672A\u63D0\u4EA4\u7684\u4EA4\u6613\u8B8A\u66F4\u7684\u81E8\u6642\u8CC7\u6599\u5EAB\u7248\u672C\uFF0C\u6240\u6709\u7684\u66F4\u65B0\u64CD\u4F5C\u90FD\u6703\u5728\u9019\u500B\u9670\u5F71\u7248\u672C\u4E2D\u9032\u884C"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"\u5DE6\u908A\u662F\u8A18\u61B6\u9AD4\u4E2D\u7684\u4F4D\u7F6E\uFF0C\u53F3\u908A\u662F\u786C\u789F\u4E2D\u7684\u4F4D\u7F6E"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Shadow Paging",src:n(2743).Z+"",width:"958",height:"538"})}),"\n",(0,s.jsx)(i.p,{children:"\u7576\u5BEB\u5165\u7684\u4EA4\u6613\u767C\u751F\u6642\uFF0CDBMS \u6703\u751F\u6210\u4E00\u4EFD shadow page\uFF0C\u4E26\u5728 shadow page \u4E0A\u9032\u884C\u4FEE\u6539\uFF0C\u4E26\u5C07 DB root \u7684\u6307\u91DD\u6307\u5411 shadow page\uFF0C\u540C\u6642\u5C07\u8CC7\u6599\u90FD\u5B58\u5728\u786C\u789F\u4E0A\u3002"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.img,{alt:"Shadow Paging",src:n(60824).Z+"",width:"958",height:"537"}),"\n",(0,s.jsx)(i.img,{alt:"Shadow Paging",src:n(12950).Z+"",width:"958",height:"539"})]}),"\n",(0,s.jsx)(i.p,{children:"\u5728 commit \u4E4B\u5F8C\uFF0CDBMS \u6703\u522A\u9664\u820A\u7684 master page\u3002"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.img,{alt:"Shadow Paging",src:n(54162).Z+"",width:"958",height:"537"}),"\n",(0,s.jsx)(i.img,{alt:"Shadow Paging",src:n(27493).Z+"",width:"959",height:"539"})]}),"\n",(0,s.jsx)(i.p,{children:"\u5728 shadow page \u7684\u5BE6\u73FE\u4E2D\uFF0C\u4E0D\u7BA1\u662F undo \u9084\u662F redo \u90FD\u975E\u5E38\u7C21\u55AE\uFF0Cundo \u53EA\u9700\u8981\u522A\u9664 shadow page\uFF0C\u800C\u56E0\u70BA\u6BCF\u6B21\u90FD\u6703\u5C07\u8CC7\u6599\u5BEB\u5165\u786C\u789F\uFF0C redo \u4E5F\u4E0D\u9700\u8981\u9032\u884C\u4EFB\u4F55\u64CD\u4F5C\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u4F46 shadow page \u7684\u7F3A\u9EDE\u4E5F\u5F88\u660E\u986F :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u8907\u88FD page table \u7684 overhead \u8F03\u5927\uFF0C\u53EF\u4EE5\u4F7F\u7528 copy-on-write \u4F86\u6E1B\u5C11 overhead"}),"\n",(0,s.jsx)(i.li,{children:"\u6BCF\u6B21\u63D0\u4EA4\u9700\u8981\u5C07\u9801\u8868\u3001\u6839\u9801\u9762\u548C\u6240\u6709\u66F4\u65B0\u7684\u9801\u9762\u540C\u6B65\u5230\u786C\u789F\u4E2D\uFF0C\u5C0E\u81F4\u5927\u91CF\u7684\u96A8\u6A5F\u5BEB\u5165"}),"\n",(0,s.jsx)(i.li,{children:"\u7531\u65BC\u76F8\u95DC\u8CC7\u6599\u53EF\u80FD\u88AB\u5206\u5272\u5230\u4E0D\u540C\u7684\u9801\u9762\u4E2D\uFF0C\u53EF\u80FD\u6703\u5C0E\u81F4\u8CC7\u6599\u788E\u7247\u5316"}),"\n",(0,s.jsx)(i.li,{children:"\u96A8\u8457\u8CC7\u6599\u7684\u66F4\u65B0\uFF0C\u5C0D\u61C9\u9801\u9762\u7684\u5F15\u7528\u5C07\u6703\u5931\u6548\uFF0C\u6240\u4EE5\u9700\u8981\u9032\u884C garbage collection"}),"\n",(0,s.jsx)(i.li,{children:"shadow page \u901A\u5E38\u53EA\u652F\u6301\u55AE\u4E00\u5BEB\u5165\uFF0C\u6216\u8005\u9700\u8981\u5C07\u591A\u500B\u4EA4\u6613\u4EE5\u6279\u6B21\u5F62\u5F0F\u63D0\u4EA4\u9019\u9650\u5236\u4E86\u4F75\u767C\u6027"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"\u5728 2010 \u5E74\u4EE5\u524D\u7684 SQLite \u4E5F\u66FE\u63A1\u7528\u904E\u985E\u4F3C\u7684 shadow paging \u7684\u65B9\u6CD5\uFF0C\u5B83\u6703\u5C07\u539F\u59CB\u7684 page \u5148\u4FDD\u5B58\u5230\u4E00\u500B journal file \u4E2D\uFF0C\u7136\u5F8C\u518D\u9032\u884C\u4FEE\u6539\u4E26\u5B58\u5165\u786C\u789F\uFF0C\u5982\u679C\u4E2D\u9014\u767C\u751F\u6545\u969C\uFF0C\u53EF\u4EE5\u6839\u64DA journal file \u4F86\u9032\u884C\u6062\u5FA9\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"write-ahead-logging-wal",children:"Write-Ahead Logging (WAL)"}),"\n",(0,s.jsx)(i.p,{children:"\u5C0D\u65BC shadow paging \u4F86\u8AAA\uFF0C\u6700\u5927\u7684\u554F\u984C\u5C31\u662F\u9700\u8981\u5C07\u8A31\u591A\u4E0D\u9023\u7E8C\u7684\u9801\u9762\u5BEB\u5165\u786C\u789F\uFF0C\u800C WAL \u5C31\u662F\u4E00\u7A2E\u80FD\u5920\u89E3\u6C7A\u9019\u500B\u554F\u984C\u7684\u65B9\u6CD5\u3002"}),"\n",(0,s.jsx)(i.p,{children:"WAL \u7684\u6838\u5FC3\u6982\u5FF5\u662F\u5728\u8CC7\u6599\u5EAB\u9032\u884C\u8B8A\u66F4\u4E4B\u524D\uFF0C\u5148\u5C07\u8B8A\u66F4\u5BEB\u5165\u4E00\u500B log file \u4E26\u5BEB\u5165\u786C\u789F\uFF0C\u7136\u5F8C\u518D\u4FEE\u6539\u771F\u6B63\u7684\u6578\u64DA\u9801\u9762\uFF0C\u9019\u6A23\u53EF\u4EE5\u4FDD\u8B49\u5373\u4F7F\u767C\u751F\u6545\u969C\uFF0C\u4E5F\u53EF\u4EE5\u6839\u64DA log file \u4F86\u9032\u884C\u6062\u5FA9\uFF0C\u901A\u5E38 WAL \u63A1\u7528\u7684 buffer pool \u7B56\u7565\u901A\u5E38\u662F Steal / No-Force\u3002"}),"\n",(0,s.jsxs)(i.p,{children:["\u5728 transaction \u958B\u59CB\u6642\uFF0CDBMS \u6703\u5728 log file \u4E2D\u5BEB\u5165\u4E00\u689D ",(0,s.jsx)(i.code,{children:"BEGIN"})," \u8A18\u9304\uFF0C\u7D50\u675F\u6642\u9700\u8981\u5BEB\u5165\u4E00\u689D ",(0,s.jsx)(i.code,{children:"COMMIT"})," \u8A18\u9304\uFF0C\u5728\u57F7\u884C\u904E\u7A0B\u4E2D\u6703\u8A18\u9304\u5B8C\u6574\u7684\u8CC7\u8A0A\uFF0C\u5305\u542B\u4E86 transaction id\u3001object id\u3001\u820A\u503C\u3001\u65B0\u503C\u7B49\u3002"]}),"\n",(0,s.jsx)(i.p,{children:"\u5982\u4E0B\u9762\u7684\u7BC4\u4F8B\u6240\u793A\uFF0C\u6211\u5011\u6703\u5148\u5BEB\u5165 WAL buffer \u4E2D\uFF0C\u518D\u4FEE\u6539\u503C\uFF0Ccoomit \u4E4B\u5F8C\u518D\u6E05\u7A7A\u3002"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.img,{alt:"Write-Ahead Logging",src:n(20478).Z+"",width:"958",height:"539"}),"\n",(0,s.jsx)(i.img,{alt:"Write-Ahead Logging",src:n(33924).Z+"",width:"959",height:"540"}),"\n",(0,s.jsx)(i.img,{alt:"Write-Ahead Logging",src:n(83706).Z+"",width:"958",height:"539"}),"\n",(0,s.jsx)(i.img,{alt:"Write-Ahead Logging",src:n(66048).Z+"",width:"959",height:"539"})]}),"\n",(0,s.jsx)(i.h3,{id:"wal-group-commit",children:"WAL Group Commit"}),"\n",(0,s.jsx)(i.p,{children:"\u6BCF\u6B21\u90FD\u5C07 log flush \u5230\u786C\u789F\u53EF\u80FD\u6703\u6210\u70BA\u6548\u80FD\u74F6\u9838\uFF0C\u56E0\u6B64\u6211\u5011\u53EF\u4EE5\u900F\u904E group commit \u4F86\u63D0\u9AD8\u6548\u80FD\uFF0C\u53EA\u5728\u9054\u5230\u4E00\u5B9A\u6578\u91CF\u6216\u8005\u4E00\u5B9A\u6642\u9593\u5F8C\u624D\u9032\u884C flush\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"log-structured-system",children:"Log-Structured System"}),"\n",(0,s.jsx)(i.p,{children:"\u5728 log-structured \u7684 DBMS \u4E2D\uFF0C\u4EA4\u6613\u7684 log \u9996\u5148\u5BEB\u5165\u4E00\u500B\u7A31\u70BA MemTable \u7684\u8A18\u61B6\u9AD4\u7DE9\u885D\u5340\uFF0C\u7576 MemTable \u6EFF\u4E86\u4E4B\u5F8C\uFF0C\u6703\u5C07\u5176\u5237\u65B0\u5230\u786C\u789F\u3002\n\u4F46\u9019\u500B\u65B9\u6CD5\u4F9D\u7136\u9700\u8981 WAL\uFF0C\u56E0\u70BA WAL \u901A\u5E38\u6BD4 MemTable \u5237\u65B0\u983B\u7E41\uFF0C\u4E26\u4E14\u5305\u542B\u672A\u63D0\u4EA4\u7684\u4EA4\u6613\uFF0C\u53EF\u4EE5\u5728\u5D29\u6F70\u6642\u80FD\u5920\u6062\u5FA9 MemTable \u7684\u5167\u5BB9\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"logging-schemes",children:"Logging Schemes"}),"\n",(0,s.jsx)(i.p,{children:"log \u7D00\u9304\u7684\u5167\u5BB9\u53EF\u80FD\u4F9D\u64DA\u4E0D\u540C\u7684\u7B56\u7565\u800C\u6709\u6240\u4E0D\u540C\uFF0C\u4E3B\u8981\u6709\u4EE5\u4E0B\u5E7E\u7A2E :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Physical Logging"}),"\n",(0,s.jsx)(i.li,{children:"Logical Logging"}),"\n",(0,s.jsx)(i.li,{children:"Physiological Logging"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Logging Schemes",src:n(64680).Z+"",width:"958",height:"539"})}),"\n",(0,s.jsx)(i.h3,{id:"physical-logging",children:"Physical Logging"}),"\n",(0,s.jsxs)(i.p,{children:["\u7269\u7406\u65E5\u8A8C\u8A18\u9304\u662F\u5C0D\u8CC7\u6599\u5EAB\u4E2D\u7279\u5B9A\u4F4D\u7F6E\u7684\u4F4D\u5143\u7D1A\u5225\u8B8A\u66F4\u9032\u884C\u8A18\u9304\u3002\u6BCF\u689D\u65E5\u8A8C\u8A18\u9304\u90FD\u8A73\u7D30\u8A18\u9304\u4E86\u5728\u8CC7\u6599\u5EAB\u9801\u9762\u4E0A\u7684\u5177\u9AD4\u8B8A\u66F4\u4F4D\u7F6E\u548C\u8B8A\u66F4\u5167\u5BB9\uFF0C\u985E\u4F3C\u65BC ",(0,s.jsx)(i.code,{children:"git diff"})," \u7684\u65B9\u5F0F\u3002"]}),"\n",(0,s.jsx)(i.h3,{id:"logical-logging",children:"Logical Logging"}),"\n",(0,s.jsx)(i.p,{children:"\u908F\u8F2F\u65E5\u8A8C\u8A18\u9304\u8A18\u9304\u7684\u662F\u4EA4\u6613\u57F7\u884C\u7684\u9AD8\u968E\u64CD\u4F5C\uFF0C\u800C\u4E0D\u662F\u5177\u9AD4\u7684\u4F4D\u5143\u8B8A\u66F4\u3002\n\u4F8B\u5982\uFF0C\u5B83\u6703\u8A18\u9304 UPDATE\u3001DELETE \u6216 INSERT \u64CD\u4F5C\u7684\u57F7\u884C\uFF0C\u800C\u4E0D\u662F\u6BCF\u500B\u64CD\u4F5C\u6539\u8B8A\u4E86\u54EA\u500B\u4F4D\u5143\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"physiological-logging",children:"Physiological Logging"}),"\n",(0,s.jsx)(i.p,{children:"\u7269\u7406\u908F\u8F2F\u6DF7\u5408\u65E5\u8A8C\u8A18\u9304\u662F\u4E00\u7A2E\u6DF7\u5408\u65B9\u6CD5\uFF0C\u5C07\u7269\u7406\u548C\u908F\u8F2F\u65E5\u8A8C\u8A18\u9304\u7D50\u5408\u5728\u4E00\u8D77\u3002\n\u5177\u9AD4\u4F86\u8AAA\uFF0C\u5B83\u91DD\u5C0D\u55AE\u500B\u9801\u9762\u9032\u884C\u65E5\u8A8C\u8A18\u9304\uFF0C\u4F46\u4E0D\u5177\u9AD4\u8A18\u9304\u9801\u9762\u4E2D\u6578\u64DA\u7684\u7D44\u7E54\u65B9\u5F0F\u3002\n\u9019\u7A2E\u65B9\u6CD5\u6703\u57FA\u65BC\u9801\u9762\u7684 slot number \u4F86\u8B58\u5225\u8CC7\u6599\u5217\uFF0C\u4F46\u4E0D\u6307\u5B9A\u8B8A\u66F4\u5728\u9801\u9762\u4E2D\u7684\u78BA\u5207\u4F4D\u7F6E\u3002"}),"\n",(0,s.jsx)(i.p,{children:"\u9019\u7A2E\u65B9\u6CD5\u4E5F\u662F\u7576\u4E0B\u6700\u6D41\u884C\u7684\u65B9\u6CD5\u3002"}),"\n",(0,s.jsx)(i.h2,{id:"checkpoint",children:"Checkpoint"}),"\n",(0,s.jsx)(i.p,{children:"\u5728\u4F7F\u7528 WAL \u6642\uFF0Clog \u6703\u96A8\u8457\u6642\u9593\u4E0D\u6BB5\u589E\u9577\uFF0C\u9019\u6A23\u6703\u5C0E\u81F4 log file \u904E\u5927\uFF0C\u4E26\u4E14\u5728\u6062\u5FA9\u6642\u9700\u8981\u4E0D\u65B7\u5730\u56DE\u653E log\uFF0C\u70BA\u4E86\u907F\u514D\u9019\u7A2E\u60C5\u6CC1\uFF0CDBMS \u6703\u5B9A\u6642\u5C07\u6240\u6709 buffer \u4E2D\u7684\u8CC7\u6599\u5BEB\u5230\u786C\u789F\u4E0A\uFF0C\u7E2E\u77ED\u6545\u969C\u6062\u5FA9\u7684\u6642\u9593\u3002"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"Checkpoints",src:n(35536).Z+"",width:"958",height:"537"})}),"\n",(0,s.jsx)(i.p,{children:"\u7576\u8CC7\u6599\u5EAB\u6545\u969C\u6642\uFF0CDBMS \u53EF\u4EE5\u6839\u64DA checkpoint \u4F86\u9032\u884C\u6062\u5FA9\uFF0C\u6240\u6709\u5728 checkpoint \u4E4B\u524D commit \u7684\u4EA4\u6613\u90FD\u53EF\u4EE5\u88AB\u8996\u70BA\u5DF2\u7D93\u6301\u4E45\u5316\uFF0C\u5982 T1\u3002\n\u800C\u5728 checkpoint \u4E4B\u5F8C commit \u7684\u4EA4\u6613\uFF0C\u5247\u9700\u8981\u6839\u64DA log file \u4F86\u9032\u884C redo\uFF0C\u5982 T2\u3001T3\u3002"}),"\n",(0,s.jsx)(i.p,{children:"chekcpoint \u6700\u4E3B\u8981\u8981\u8003\u616E\u7684\u554F\u984C\u662F\u591A\u4E45\u57F7\u884C\u4E00\u6B21 checkpoint\uFF0C\u5982\u679C checkpoint \u904E\u65BC\u983B\u7E41\uFF0C\u6703\u5C0E\u81F4\u6548\u80FD\u4E0B\u964D\uFF0C\u5982\u679C checkpoint \u904E\u65BC\u7A00\u758F\uFF0C\u5247\u5728\u6545\u969C\u6062\u5FA9\u6642\u9700\u8981\u56DE\u653E\u7684 log \u904E\u591A\uFF0C\u5C0E\u81F4\u6062\u5FA9\u6642\u9593\u904E\u9577\u3002"}),"\n",(0,s.jsx)(i.h3,{id:"blocking-checkpoint",children:"Blocking Checkpoint"}),"\n",(0,s.jsx)(i.p,{children:"blocking checkpoint \u662F\u4E00\u7A2E\u6700\u7C21\u55AE\u7684 checkpoint \u5BE6\u4F5C\u65B9\u6CD5\uFF0C\u6B65\u9A5F\u5982\u4E0B :"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"\u66AB\u505C\u65B0\u4EA4\u6613 : \u66AB\u505C\u63A5\u53D7\u65B0\u7684\u4EA4\u6613\uFF0C\u4E26\u7B49\u5F85\u6240\u6709\u7576\u524D\u6D3B\u8E8D\u7684\u4EA4\u6613\u5B8C\u6210"}),"\n",(0,s.jsx)(i.li,{children:"\u5237\u65B0\u7DE9\u885D\u5340 : \u5C07\u7576\u524D\u8A18\u61B6\u9AD4\u4E2D\u7684\u6240\u6709\u65E5\u8A8C\u8A18\u9304\u548C\u4FEE\u6539\u904E\u7684\u7DE9\u885D\u5340\u5BEB\u5230\u786C\u789F\u4E2D"}),"\n",(0,s.jsxs)(i.li,{children:["\u8A18\u9304 checkpoint : \u5BEB\u5165\u4E00\u500B ",(0,s.jsx)(i.code,{children:"<CHECKPOINT>"})," \u8A18\u9304\u5230\u65E5\u8A8C\u6A94\u6848\u4E2D\uFF0C\u4E26\u5C07\u5176\u5BEB\u5165\u786C\u789F"]}),"\n"]})]})}function g(e={}){let{wrapper:i}={...(0,c.a)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},86305:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-1-66cd3f8006737b7e882a2f67792e427e.png"},66048:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-10-890899ab8ec24ce313b6dd72153f30e1.png"},64680:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-11-233fbe36b7b4973eadf99ca37bac8e76.png"},35536:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-12-fef1b657f09b6f6fb677470fa29be421.png"},2743:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-2-84cc07b2cbfc6a188f6470a37aaa1ff2.png"},60824:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-3-d41f7bd930243706a8338d5b00f74040.png"},12950:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-4-fdcdc556feb89fc6c6784e3239b3adb4.png"},54162:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-5-dc661b9cc21e93c9fab027cafe0410df.png"},27493:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-6-d68d7b1d86fa6ff5852b52be307e250e.png"},20478:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-7-7cfb77637d8988033c29b9c6be5038b0.png"},33924:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-8-018a9d5642e39856095247d850df41df.png"},83706:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-9-69587e1620148f1d48957f04445355db.png"},10918:function(e,i,n){n.d(i,{Z:()=>l});let l=n.p+"assets/images/image-66982052cb056746c8512a1a24c53465.png"},50065:function(e,i,n){n.d(i,{Z:()=>o,a:()=>a});var l=n(67294);let s={},c=l.createContext(s);function a(e){let i=l.useContext(c);return l.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),l.createElement(c.Provider,{value:i},e.children)}}}]);