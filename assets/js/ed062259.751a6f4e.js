"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4043],{3496:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var i=d(5893),t=d(1151);const o={title:"[K8s] Kubernetes Pod",sidebar_position:"15",description:"Kubernetes Pod",keywords:["kubernetes","pod"]},s=void 0,r={id:"Kubernetes/Pod",title:"[K8s] Kubernetes Pod",description:"Kubernetes Pod",source:"@site/docs/Kubernetes/Pod.mdx",sourceDirName:"Kubernetes",slug:"/Kubernetes/Pod",permalink:"/RulerChen-Website/docs/Kubernetes/Pod",draft:!1,unlisted:!1,editUrl:"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/Kubernetes/Pod.mdx",tags:[],version:"current",lastUpdatedAt:1706183872e3,sidebarPosition:15,frontMatter:{title:"[K8s] Kubernetes Pod",sidebar_position:15,description:"Kubernetes Pod",keywords:["kubernetes","pod"]},sidebar:"tutorialSidebar",previous:{title:"[K8s] Kubernetes Introduction",permalink:"/RulerChen-Website/docs/Kubernetes/Introduction"},next:{title:"[K8s] Kubernetes Controllers",permalink:"/RulerChen-Website/docs/Kubernetes/Controllers"}},c={},l=[{value:"Pod Overview",id:"pod-overview",level:2},{value:"Create Pod",id:"create-pod",level:2},{value:"\u5e38\u7528\u6307\u4ee4",id:"\u5e38\u7528\u6307\u4ee4",level:2},{value:"Static Pod",id:"static-pod",level:2},{value:"Init Container",id:"init-container",level:2},{value:"Pod Lifecycle",id:"pod-lifecycle",level:2},{value:"Pod Termination",id:"pod-termination",level:2}];function a(e){const n={code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"pod-overview",children:"Pod Overview"}),"\n",(0,i.jsx)(n.p,{children:"pod \u662f\u53ef\u4ee5\u5728 kubernetes pod \u53ef\u4ee5\u5305\u542b\u4e00\u500b\u6216\u591a\u500b\u5bb9\u5668\uff0c\u9019\u4e9b\u5bb9\u5668\u5171\u4eab\u5b58\u5132\u3001\u7db2\u8def\u548c\u5176\u4ed6\u8cc7\u6e90\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u5927\u90e8\u5206\u60c5\u6cc1\u4e0b\uff0c\u4e00\u500b Pod \u90fd\u53ea\u5305\u542b\u4e00\u500b\u5bb9\u5668\uff0c\u4f46\u662f\u4e5f\u6709\u4e00\u7a2e\u908a\u8eca\u6a21\u5f0f(sidecar)\u662f\u4f8b\u5916\uff0c\n\u5373\u4e00\u500b\u4e3b\u5bb9\u5668\u548c\u4e00\u500b\u6216\u591a\u500b\u908a\u8eca\u5bb9\u5668\uff0c\u908a\u8eca\u5bb9\u5668\u53ef\u4ee5\u70ba\u4e3b\u5bb9\u5668\u63d0\u4f9b\u8f14\u52a9\u670d\u52d9\uff0c\u4f8b\u5982\u65e5\u8a8c\u6536\u96c6\u3001\u8cc7\u6599\u5eab\u540c\u6b65\u7b49\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Pod",src:d(5486).Z+"",width:"1234",height:"1008"})}),"\n",(0,i.jsx)(n.h2,{id:"create-pod",children:"Create Pod"}),"\n",(0,i.jsxs)(n.p,{children:["\u4e3b\u8981\u6709\u5169\u7a2e\u65b9\u5f0f\uff0c\u4e00\u7a2e\u662f\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"kubectl run"})," \u547d\u4ee4\uff0c\u53e6\u4e00\u7a2e\u662f\u4f7f\u7528 pod \u7684\u914d\u7f6e\u6587\u4ef6\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'kubectl run client --image=busybox --command -- bin/sh -c "sleep 100000"\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="pod.yaml"',children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: client\nspec:\n  containers:\n    - name: client\n      image: busybox\n      command:\n        - sh\n        - -c\n        - 'sleep 1000000'\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f pod.yaml\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u5e38\u7528\u6307\u4ee4",children:"\u5e38\u7528\u6307\u4ee4"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl run web --image=nginx --dry-run=<pod-name> -o yaml > nginx.yml # \u751f\u6210 Pod \u914d\u7f6e\u6587\u4ef6\n\nkubectl diff -f <.yaml> # \u6bd4\u8f03 Pod \u914d\u7f6e\u6587\u4ef6\u7684\u5dee\u7570\n\nkubectl get pods -o wide # \u67e5\u770b Pod \u7684\u8a73\u7d30\u4fe1\u606f\n\nkubectl get pods <pod-name> -o yaml # \u67e5\u770b Pod \u7684\u914d\u7f6e\u6587\u4ef6\n\nkubectl describe pod <pod-name> # \u67e5\u770b <pod-name> \u7684\u8a73\u7d30\u4fe1\u606f\n\nkubectl delete pod <pod-name> # \u522a\u9664 <pod-name>\n\nkubectl exec <pod-name> -it -- sh # \u9032\u5165 <pod-name> Pod \u7684\u5bb9\u5668\uff0c\u5982\u679c Pod \u4e2d\u6709\u591a\u500b\u5bb9\u5668\uff0c\u53ef\u4ee5\u4f7f\u7528 -c \u6307\u5b9a\u5bb9\u5668\u540d\u7a31\n\nkubectl get pod <pod-name> -v 6 # \u67e5\u770b Pod \u7684\u8a73\u7d30\u65e5\u8a8c\uff0cv \u7684\u503c\u8d8a\u5927\uff0c\u65e5\u8a8c\u8d8a\u8a73\u7d30\uff0c\u52a0\u4e0a -w \u53ef\u4ee5\u5be6\u6642\u67e5\u770b\u65e5\u8a8c\n"})}),"\n",(0,i.jsx)(n.h2,{id:"static-pod",children:"Static Pod"}),"\n",(0,i.jsxs)(n.p,{children:["static pod \u662f\u4e00\u7a2e\u7279\u6b8a\u7684 Pod\uff0c\u5b83\u4e0d\u7531 kubernetes API Server \u7ba1\u7406\uff0c\n\u800c\u662f\u7531 kubelet \u9032\u7a0b\u7ba1\u7406\u7684\uff0ckubelet \u6703\u5b9a\u671f\u76e3\u807d\u672c\u5730\u6587\u4ef6\u593e\uff0c\u5982\u679c\u767c\u73fe\u6709\u65b0\u7684 pod \u914d\u7f6e\u6587\u4ef6\uff0c\u5c31\u6703\u5275\u5efa\u5c0d\u61c9\u7684 pod\u3002\nstatic pod \u7684\u914d\u7f6e\u6587\u4ef6\u5fc5\u9808\u653e\u5728 ",(0,i.jsx)(n.code,{children:"/etc/kubernetes/manifests"})," \u76ee\u9304\u4e0b\uff0c\u4e26\u4e14\u6587\u4ef6\u540d\u5fc5\u9808\u4ee5 ",(0,i.jsx)(n.code,{children:".yaml"})," \u6216 ",(0,i.jsx)(n.code,{children:".yml"})," \u7d50\u5c3e\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"static pod \u7684\u7528\u9014\u662f\u5728 Kubernetes \u96c6\u7fa4\u4e2d\u90e8\u7f72\u4e00\u4e9b\u57fa\u790e\u7d44\u4ef6\uff0c\u4f8b\u5982 kube-proxy\u3001kube-scheduler \u7b49\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"init-container",children:"Init Container"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Init Container",src:d(3593).Z+"",width:"952",height:"204"})}),"\n",(0,i.jsx)(n.p,{children:"init container \u662f pod \u4e2d\u7684\u4e00\u7a2e\u7279\u6b8a\u5bb9\u5668\uff0c\u5b83\u6703\u5728 pod \u4e2d\u7684\u5176\u4ed6\u5bb9\u5668\u555f\u52d5\u4e4b\u524d\u555f\u52d5\uff0c\n\u4e26\u4e14\u5b83\u5011\u90fd\u662f\u4e32\u884c\u555f\u52d5\u7684\uff0c\u5373\u4e00\u500b init container \u555f\u52d5\u6210\u529f\u4e4b\u5f8c\uff0c\u624d\u6703\u555f\u52d5\u4e0b\u4e00\u500b init container\uff0c\n\u76f4\u5230\u6240\u6709\u7684 init container \u555f\u52d5\u6210\u529f\u4e4b\u5f8c\uff0cpod \u4e2d\u7684\u5176\u4ed6\u5bb9\u5668\u624d\u6703\u555f\u52d5\uff0c\u53ef\u4ee5\u7528\u65bc\u521d\u59cb\u5316 pod \u4e2d\u7684\u4e00\u4e9b\u8cc7\u6e90\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"pod-lifecycle",children:"Pod Lifecycle"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Pod \u7684\u751f\u547d\u9031\u671f",src:d(1889).Z+"",width:"960",height:"288"})}),"\n",(0,i.jsx)(n.p,{children:"pod \u7684\u751f\u547d\u9031\u671f\u5206\u70ba Pending\u3001Running\u3001Succeeded\u3001Failed\u3001Unknown \u4e94\u500b\u968e\u6bb5\u3002"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Pending\uff1apod \u5df2\u7d93\u88ab kubernetes \u63a5\u53d7\uff0c\u4f46\u662f\u5bb9\u5668\u5c1a\u672a\u5275\u5efa\uff0c\u50cf\u662f\u5728\u7b49\u5f85\u5bb9\u5668\u7684 image \u4e0b\u8f09\u3002"}),"\n",(0,i.jsx)(n.li,{children:"Running\uff1apod \u4e2d\u7684\u5bb9\u5668\u5df2\u7d93\u88ab\u5275\u5efa\uff0c\u4e26\u4e14\u81f3\u5c11\u6709\u4e00\u500b\u5bb9\u5668\u8655\u65bc\u57f7\u884c\u4e2d\u3002"}),"\n",(0,i.jsx)(n.li,{children:"Succeeded\uff1apod \u4e2d\u7684\u6240\u6709\u5bb9\u5668\u90fd\u5df2\u7d93\u6210\u529f\u7d42\u6b62\uff0c\u4e26\u4e14\u4e0d\u6703\u518d\u555f\u52d5\u3002"}),"\n",(0,i.jsx)(n.li,{children:"Failed\uff1apod \u4e2d\u7684\u6240\u6709\u5bb9\u5668\u90fd\u5df2\u7d93\u7d42\u6b62\uff0c\u4e26\u4e14\u81f3\u5c11\u6709\u4e00\u500b\u5bb9\u5668\u56e0\u70ba\u5931\u6557\u800c\u7d42\u6b62\u3002"}),"\n",(0,i.jsx)(n.li,{children:"Unknown\uff1apod \u7684\u72c0\u614b\u7121\u6cd5\u78ba\u5b9a\uff0c\u901a\u5e38\u662f\u7531\u65bc\u8207 pod \u901a\u4fe1\u6642\u51fa\u73fe\u7570\u5e38\u5c0e\u81f4\u7684\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"pod-termination",children:"Pod Termination"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u7576\u57f7\u884c\u522a\u9664 pod \u7684\u547d\u4ee4\u6642\uff0cAPI Server \u6703\u8a2d\u5b9a\u4e00\u500b\u7d42\u6b62\u6642\u9593\uff0c\u9ed8\u8a8d\u662f 30 \u79d2\uff0c\u540c\u6642\u5c07\u72c0\u614b\u8a2d\u5b9a\u70ba terminating\u3002"}),"\n",(0,i.jsx)(n.li,{children:"pod \u6240\u5728\u7684 node \u4e0a\u7684 kubelet \u6536\u5230\u7d42\u6b62 pod \u7684\u8acb\u6c42\u4e4b\u5f8c\uff0c\u6703\u5411 pod \u4e2d\u7684\u5bb9\u5668\u767c\u9001 SIGTERM \u4fe1\u865f\uff0c\u7136\u5f8c\u7b49 container \u9000\u51fa\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u5728\u7d42\u6b62\u6642\u9593\u5230\u671f\u4e4b\u524d\uff0cpod \u4e2d\u7684\u5bb9\u5668\u90fd\u6c92\u6709\u9000\u51fa\uff0ckubelet \u6703\u5411 pod \u4e2d\u7684\u5bb9\u5668\u767c\u9001 SIGKILL \u4fe1\u865f\uff0c\u5f37\u5236\u7d42\u6b62\u5bb9\u5668\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u5728\u5230\u671f\u4e4b\u524d\u5c31\u5168\u90e8\u9000\u51fa\uff0cpod \u7684\u8cc7\u8a0a\u5c31\u6703\u6b63\u5e38\u7684\u88ab API Server \u522a\u9664\u3002"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},5486:(e,n,d)=>{d.d(n,{Z:()=>i});const i=d.p+"assets/images/2-9c384d87e9a5bc30fdb16ec58c7ad09d.webp"},3593:(e,n,d)=>{d.d(n,{Z:()=>i});const i=d.p+"assets/images/3-dbe5f649acd20f218630b10a19358b4b.webp"},1889:(e,n,d)=>{d.d(n,{Z:()=>i});const i=d.p+"assets/images/4-0d417b9bc971f3e8a5c65cfffc69c0b7.webp"},1151:(e,n,d)=>{d.d(n,{Z:()=>r,a:()=>s});var i=d(7294);const t={},o=i.createContext(t);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);