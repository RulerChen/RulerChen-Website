"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6684],{2631:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>o});var s=r(5893),i=r(1151);const c={title:"P0 - C++ Primer",sidebar_position:"30",description:"C++ Primer",keywords:["CMU15-445/645","C++ Primer","CMU15-445/645 \u7b46\u8a18"]},l=void 0,t={id:"CMU15-445/p0",title:"P0 - C++ Primer",description:"C++ Primer",source:"@site/docs/CMU15-445/p0.mdx",sourceDirName:"CMU15-445",slug:"/CMU15-445/p0",permalink:"/RulerChen-Website/docs/CMU15-445/p0",draft:!1,unlisted:!1,editUrl:"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/CMU15-445/p0.mdx",tags:[],version:"current",lastUpdatedAt:1726242102e3,sidebarPosition:30,frontMatter:{title:"P0 - C++ Primer",sidebar_position:30,description:"C++ Primer",keywords:["CMU15-445/645","C++ Primer","CMU15-445/645 \u7b46\u8a18"]},sidebar:"tutorialSidebar",previous:{title:"Distributed OLAP Database Systems",permalink:"/RulerChen-Website/docs/CMU15-445/c23"},next:{title:"P1 - Buffer Pool Manager",permalink:"/RulerChen-Website/docs/CMU15-445/p1"}},d={},o=[{value:"Problem Description",id:"problem-description",level:2},{value:"Learning Resource",id:"learning-resource",level:2},{value:"Environment Setup",id:"environment-setup",level:2},{value:"Solution",id:"solution",level:2},{value:"Copy-On-Write Trie",id:"copy-on-write-trie",level:3},{value:"Concurrent Key-Value Store",id:"concurrent-key-value-store",level:3},{value:"Debugging",id:"debugging",level:3},{value:"SQL String Functions",id:"sql-string-functions",level:3},{value:"Submit",id:"submit",level:2}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components},{Head:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r,{children:(0,s.jsx)("title",{children:"CMU 15-445/645 Project#0 \u7b46\u8a18"})}),"\n",(0,s.jsx)(n.h2,{id:"problem-description",children:"Problem Description"}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u9019\u500b project \u4e2d\uff0c\u6211\u5011\u9700\u8981\u5be6\u73fe\u4e00\u500b key-value store \u7684 copy-on-write \u7684 trie\uff0c\u7e3d\u5171\u6709 4 \u500b Task :"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Copy-On-Write Trie : \u4fee\u6539 ",(0,s.jsx)(n.code,{children:"/src/primer/trie.cpp"})," \u4f86\u5be6\u73fe\u4e00\u500b copy-on-write trie\uff0c\u6709 ",(0,s.jsx)(n.code,{children:"GET"}),"\u3001",(0,s.jsx)(n.code,{children:"PUT"}),"\u3001",(0,s.jsx)(n.code,{children:"DELETE"})," \u4e09\u500b\u64cd\u4f5c\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["Concurrent Key-Value Store : \u4fee\u6539 ",(0,s.jsx)(n.code,{children:"/src/primer/trie_store.cpp"})," \u4f86\u5c07\u539f\u672c single-thread \u7684 trie \u6539\u6210 concurrent \u7684\u7248\u672c\uff0c\u4e00\u6a23\u6709 ",(0,s.jsx)(n.code,{children:"GET"}),"\u3001",(0,s.jsx)(n.code,{children:"PUT"}),"\u3001",(0,s.jsx)(n.code,{children:"DELETE"})," \u4e09\u500b\u64cd\u4f5c\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["Debugging : \u5728 ",(0,s.jsx)(n.code,{children:"/test/primer/trie_debug_test.cpp"})," \u4e2d\u7df4\u7fd2\u4f7f\u7528 debugger \u4f86 debug\uff0c\u4e26\u5728 ",(0,s.jsx)(n.code,{children:"/src/include/primer/trie_answer.h"})," \u4e2d\u586b\u5165\u7b54\u6848\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["SQL String Functions : \u5728 ",(0,s.jsx)(n.code,{children:" src/execution/expressions/string_expression.h"})," \u548c ",(0,s.jsx)(n.code,{children:"src/planner/plan_func_call"})," \u4e2d\u5be6\u73fe ",(0,s.jsx)(n.code,{children:"lower"})," \u548c ",(0,s.jsx)(n.code,{children:"upper"})," \u5169\u500b SQL function\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"learning-resource",children:"Learning Resource"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/cmu-db/15445-bootcamp",children:"15-445 Bootcamp"})," : \u8ab2\u7a0b\u63d0\u4f9b\u7684\u4e00\u500b\u7c21\u55ae bootcamp\uff0c\u88e1\u9762\u6709\u4e00\u4e9b\u7bc4\u4f8b\u7a0b\u5f0f\u78bc"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://www.youtube.com/watch?v=G9gnSGKYIg4",children:"Debug a C++ project in VS Code"})," : \u5728 VSCode \u4e2d debug \u7684\u6559\u5b78"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://blog.csdn.net/hengyuwuhui/article/details/138494068",children:"Visual Studio Code (VSCode) \u4e2d\u914d\u7f6e C++ \u8c03\u8bd5\u73af\u5883"})," : \u5728 VSCode \u4e2d\u914d\u7f6e lldb \u7684\u6559\u5b78"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://www.youtube.com/watch?v=dIs7TFBDbIw",children:"CMake"})," : CMake \u7684\u7c21\u6613\u6559\u5b78"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"environment-setup",children:"Environment Setup"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u6211\u4f7f\u7528\u7684\u74b0\u5883\u662f WSL (Ubuntu 22.04) \u548c VSCode"}),"\n",(0,s.jsxs)(n.li,{children:["\u5b89\u88dd VSCode \u5957\u4ef6 ",(0,s.jsx)(n.code,{children:"C/C++ Extension Pack"})," \u8ddf ",(0,s.jsx)(n.code,{children:"clangd"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u5c07 bustub clone \u4e0b\u4f86\uff0c\u4e26\u4e14\u56de\u9000\u5230 2023 Fall \u7684 commit\uff0c\u5efa\u8b70\u81f3\u5c11\u56de\u9000\u5230 2023 12/27 \u7684 ",(0,s.jsx)(n.code,{children:"add request signature script (#674)"})]}),"\n",(0,s.jsx)(n.li,{children:"\u5b89\u88dd package \u4e26\u7de8\u8b6f :"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo build_support/packages.sh\n\nmkdir build\ncd build\ncmake -DCMAKE_BUILD_TYPE=Debug ..\nmake -j`nproc`\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u51fa\u73fe compiler \u7684\u7248\u672c\u8b66\u544a\uff0c\u53ef\u4ee5\u5c07 cmake \u6539\u6210\u4ee5\u4e0b\u6307\u4ee4 :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_C_COMPILER=/usr/bin/clang-14 -DCMAKE_CXX_COMPILER=/usr/bin/clang++-14 ..\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"5",children:["\n",(0,s.jsx)(n.li,{children:"\u5b89\u88dd clangd (\u901a\u5e38 VSCode \u6703\u63d0\u793a\u5b89\u88dd)"}),"\n",(0,s.jsx)(n.li,{children:"\u8a2d\u5b9a formatter\uff0c\u9019\u6a23\u5c31\u53ef\u4ee5\u5728 save \u7684\u6642\u5019\u81ea\u52d5\u683c\u5f0f\u5316 :"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title=".vscode/settings.json"',children:'{\n  "C_Cpp.clang_format_path": "/usr/bin/clang-format-14",\n  "C_Cpp.formatting": "clangFormat",\n  "C_Cpp.clang_format_style": "file",\n  "editor.formatOnSave": true\n}\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"7",children:["\n",(0,s.jsx)(n.li,{children:"\u63a5\u8457\u8a2d\u5b9a debugger\uff0c\u9700\u8981\u5148\u5b89\u88dd lldb\uff0c\u4e26\u5728 VSCode \u4e2d\u8a2d\u5b9a debugger"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install lldb-14\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title=".vscode/launch.json"',children:'{\n  "version": "0.2.0",\n  "configurations": [\n    {\n      "name": "C/C++: clang++ build and debug active file",\n      "type": "lldb",\n      "request": "launch",\n      "program": "${workspaceFolder}/build/test/${fileBasenameNoExtension}",\n      "args": [],\n      "cwd": "${fileDirname}"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"solution",children:"Solution"}),"\n",(0,s.jsx)(n.h3,{id:"copy-on-write-trie",children:"Copy-On-Write Trie"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"GET"})," : \u9700\u8981\u8655\u7406 root \u662f nullptr \u7684\u60c5\u6cc1\uff0c\u5176\u9918\u7684\u60c5\u6cc1\u5c31\u662f\u5f9e root \u958b\u59cb\u5f80\u4e0b\u627e\uff0c\u6700\u5f8c\u7528 ",(0,s.jsx)(n.code,{children:"dynamic_cast"})," \u4f86\u8f49\u578b\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"PUT"})," : \u9700\u8981\u8655\u7406 key \u662f\u7a7a\u7684\u60c5\u6cc1 (\u5728 root \u4e0a\u76f4\u63a5\u63d2\u5165)\uff0c\u5176\u9918\u7684\u60c5\u6cc1\u5c31\u662f\u5f9e root \u958b\u59cb\u5f80\u4e0b\u627e\uff0c\u4e26\u65b0\u589e\u4e00\u500b ",(0,s.jsx)(n.code,{children:"TrieNodeWithValue"}),"\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"DELETE"})," : \u9700\u8981\u5148\u904d\u6b77\u5230\u8981\u522a\u9664\u7684 node\uff0c\u4e26\u8a18\u9304\u4e2d\u9014\u7d93\u904e\u7684 node\uff0c\u6700\u5f8c\u518d\u6cbf\u9014\u522a\u9664\u6c92\u6709 value \u7684 node\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u63a5\u8457\u5728\u672c\u5730\u9032\u884c ",(0,s.jsx)(n.code,{children:"trie_test"})," \u7684\u55ae\u5143\u6e2c\u8a66 :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd build\nmake trie_test trie_noncopy_test -j$(nproc)\n\n./test/trie_test\n./test/trie_noncopy_test\n"})}),"\n",(0,s.jsx)(n.h3,{id:"concurrent-key-value-store",children:"Concurrent Key-Value Store"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"GET"})," : \u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"lock_guard"})," \u4f86\u8b80\u53d6 root\uff0c\u4e26\u4f9d\u64da\u662f\u5426\u6709\u9019\u500b key \u4f86\u6c7a\u5b9a\u8981\u56de\u50b3 ",(0,s.jsx)(n.code,{children:"nullopt"})," \u6216\u662f ",(0,s.jsx)(n.code,{children:"ValueGuard"}),"\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"PUT"})," : \u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"unique_lock"})," \u4f86\u7372\u53d6\u5168\u5c40\u7684 ",(0,s.jsx)(n.code,{children:"write_lock"}),"\uff0c\u4e26\u7372\u53d6 ",(0,s.jsx)(n.code,{children:"root_lock"})," \u4f86\u8b80\u53d6 root \u548c\u5beb\u5165\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"DELETE"})," : \u8207 ",(0,s.jsx)(n.code,{children:"PUT"})," \u985e\u4f3c\uff0c\u4e5f\u662f\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"unique_lock"})," \u4f86\u7372\u53d6\u5168\u5c40\u7684 ",(0,s.jsx)(n.code,{children:"write_lock"}),"\uff0c\u4e26\u7372\u53d6 ",(0,s.jsx)(n.code,{children:"root_lock"})," \u4f86\u8b80\u53d6 root \u548c\u522a\u9664\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u63a5\u8457\u5728\u672c\u5730\u9032\u884c ",(0,s.jsx)(n.code,{children:"trie_store_test"})," \u7684\u55ae\u5143\u6e2c\u8a66 :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd build\nmake trie_store_test trie_store_noncopy_test -j$(nproc)\n\n./test/trie_store_test\n./test/trie_store_noncopy_test\n"})}),"\n",(0,s.jsx)(n.h3,{id:"debugging",children:"Debugging"}),"\n",(0,s.jsxs)(n.p,{children:["\u524d\u9762\u5169\u984c\u7684\u7b54\u6848\u53ef\u4ee5\u5728 VSCode \u7684 debugger \u5167\u770b\u51fa\uff0c\u7b2c\u4e09\u984c\u53ef\u4ee5\u76f4\u63a5 cout \u5f97\u51fa\u7b54\u6848\uff0c\u4e26\u5728 ",(0,s.jsx)(n.code,{children:"/src/include/primer/trie_answer.h"})," \u4e2d\u586b\u5165\u7b54\u6848\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u7b54\u6848\u5982\u4e0b :"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"10"}),"\n",(0,s.jsx)(n.li,{children:"1"}),"\n",(0,s.jsx)(n.li,{children:"25"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"sql-string-functions",children:"SQL String Functions"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 ",(0,s.jsx)(n.code,{children:"string_expression.h"})," \u4e2d\u4f9d\u64da ",(0,s.jsx)(n.code,{children:"expr_type"})," \u4f86\u5224\u65b7\u8981\u57f7\u884c\u54ea\u500b function\uff0c\u4e26\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"std::transform"})," \u4f86\u5c07\u5b57\u4e32\u8f49\u63db\u6210\u5927\u5beb\u6216\u5c0f\u5beb\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 ",(0,s.jsx)(n.code,{children:"plan_func_call.cpp"})," \u4e2d\u4f9d\u64da ",(0,s.jsx)(n.code,{children:"func_name"})," \u548c\u53c3\u6578\u6578\u91cf\u4f86\u5224\u65b7\u8981\u57f7\u884c\u54ea\u500b function\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 shell \u4f86\u6e2c\u8a66\uff0c\u6703\u986f\u793a\u932f\u8aa4\u662f\u6b63\u5e38\u7684 :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd build\nmake -j`nproc` shell\n\n./bin/bustub-shell\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"select upper('AbCd'), lower('AbCd');\n+-------------+-------------+\n| __unnamed#0 | __unnamed#1 |\n+-------------+-------------+\n| ABCD        | abcd        |\n+-------------+-------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u540c\u6a23\u53ef\u4ee5\u9032\u884c\u55ae\u5143\u6e2c\u8a66 :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"make -j`nproc` sqllogictest\n\n./bin/bustub-sqllogictest ../test/sql/p0.01-lower-upper.slt --verbose\n./bin/bustub-sqllogictest ../test/sql/p0.02-function-error.slt --verbose\n./bin/bustub-sqllogictest ../test/sql/p0.03-string-scan.slt --verbose\n"})}),"\n",(0,s.jsx)(n.h2,{id:"submit",children:"Submit"}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u8981\u8a3b\u518a GradeScope\uff0c\u53ef\u4ee5\u53c3\u8003 ",(0,s.jsx)(n.a,{href:"https://blog.csdn.net/qq_40878302/article/details/136005292",children:"\u9019\u500b\u7db2\u7ad9"})]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u9996\u5148\u4fee\u6539 ",(0,s.jsx)(n.code,{children:"CMakeLists.txt"}),"\uff0c\u5c07 ",(0,s.jsx)(n.code,{children:"P0_FILES"})," \u8a2d\u5b9a\u70ba\u4ee5\u4e0b ( \u9700\u8981\u91cd\u65b0\u57f7\u884c ",(0,s.jsx)(n.code,{children:"cmake"})," \u6307\u4ee4\u4f86\u66f4\u65b0 makefile ):"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-CMake",metastring:'title="CMakeLists.txt"',children:'set(P0_FILES\n        "src/include/primer/trie_answer.h"\n        "src/include/primer/trie_store.h"\n        "src/include/primer/trie.h"\n        "src/primer/trie_store.cpp"\n        "src/primer/trie.cpp"\n        "src/planner/plan_func_call.cpp"\n        "src/include/execution/expressions/string_expression.h"\n        "GRADESCOPE.md"\n)\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsx)(n.li,{children:"\u9032\u884c\u6392\u7248\uff0c\u78ba\u5b9a\u6d88\u9664\u6240\u6709 error \u548c warning ( \u7279\u5225\u662f check-clang-tidy-p0 ):"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"make format\nmake check-lint\nmake check-clang-tidy-p0\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsxs)(n.li,{children:["\u7c3d\u540d\uff0c\u6703\u7522\u751f\u4e00\u500b ",(0,s.jsx)(n.code,{children:"GRADESCOPE.md"})," :"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python3 gradescope_sign.py\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsxs)(n.li,{children:["\u7e73\u4ea4\u4f5c\u696d\uff0c\u53ef\u80fd\u9700\u8981\u5148\u57f7\u884c ",(0,s.jsx)(n.code,{children:"sudo apt-get install zip"})," \u4f86\u5b89\u88dd ",(0,s.jsx)(n.code,{children:"zip"}),"\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4 :"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"make submit-p0\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"5",children:["\n",(0,s.jsxs)(n.li,{children:["\u4e0a\u50b3 ",(0,s.jsx)(n.code,{children:".zip"})," \u6a94\u5230 GradeScope"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>t,a:()=>l});var s=r(7294);const i={},c=s.createContext(i);function l(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);