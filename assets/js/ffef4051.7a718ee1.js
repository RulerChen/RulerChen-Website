"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["2366"],{40748:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>l,default:()=>h,toc:()=>a,metadata:()=>i,assets:()=>d,contentTitle:()=>c});var i=JSON.parse('{"id":"PostgreSQL/pg-tuning","title":"[PG] PostgreSQL Performance Tuning","description":"Postgres \u6027\u80FD\u8ABF\u6821","source":"@site/docs/PostgreSQL/pg-tuning.mdx","sourceDirName":"PostgreSQL","slug":"/PostgreSQL/pg-tuning","permalink":"/RulerChen-Website/docs/PostgreSQL/pg-tuning","draft":false,"unlisted":false,"editUrl":"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/PostgreSQL/pg-tuning.mdx","tags":[],"version":"current","lastUpdatedAt":1735389509000,"sidebarPosition":10,"frontMatter":{"title":"[PG] PostgreSQL Performance Tuning","sidebar_position":10,"description":"Postgres \u6027\u80FD\u8ABF\u6821","keywords":["Postgres","\u8ABF\u6821"]},"sidebar":"tutorialSidebar","previous":{"title":"[Next.js] ESlint in Next.js 13.4","permalink":"/RulerChen-Website/docs/Next.js/EslintPrettier"},"next":{"title":"[PG] PostgreSQL High Availability","permalink":"/RulerChen-Website/docs/PostgreSQL/pg-ha"}}'),t=s(85893),r=s(50065);let l={title:"[PG] PostgreSQL Performance Tuning",sidebar_position:"10",description:"Postgres \u6027\u80FD\u8ABF\u6821",keywords:["Postgres","\u8ABF\u6821"]},c=void 0,d={},a=[{value:"Environment Setup",id:"environment-setup",level:2},{value:"Postgres Architecture",id:"postgres-architecture",level:2},{value:"Process manager",id:"process-manager",level:3},{value:"Shared Memory",id:"shared-memory",level:3},{value:"Query processor",id:"query-processor",level:3},{value:"Checkpoint",id:"checkpoint",level:3},{value:"WAL writer",id:"wal-writer",level:3},{value:"Utility process",id:"utility-process",level:3},{value:"Vacuum",id:"vacuum",level:2},{value:"Index",id:"index",level:2},{value:"Index introduction",id:"index-introduction",level:3},{value:"Index use case",id:"index-use-case",level:3},{value:"Index cluster",id:"index-cluster",level:3},{value:"Statistics",id:"statistics",level:2},{value:"Query Plan",id:"query-plan",level:2},{value:"SQL Optimization",id:"sql-optimization",level:2},{value:"Join Order",id:"join-order",level:3},{value:"Avoid SELECT *",id:"avoid-select-",level:3},{value:"Avoid Order By",id:"avoid-order-by",level:3},{value:"Avoid Distinct",id:"avoid-distinct",level:3},{value:"Parallel Query",id:"parallel-query",level:3},{value:"Shared Buffer",id:"shared-buffer",level:2},{value:"Reference",id:"reference",level:2}];function o(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["\u9019\u7BC7\u6587\u7AE0\u662F\u6211\u770B\u4E86 ",(0,t.jsx)(n.a,{href:"https://www.udemy.com/course/postgresql-high-performance-tuning-guide",children:"PostgreSQL High Performance Tuning Guide"})," \u7684\u7B46\u8A18"]}),"\n",(0,t.jsx)(n.h2,{id:"environment-setup",children:"Environment Setup"}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u9019\u7BC7\u6587\u7AE0\u4E2D\uFF0C\u6211\u6703\u5728 GCP \u4E0A\u9762\u5EFA\u7ACB\u4E00\u500B VM (Debian) \u4F86\u5B89\u88DD PostgreSQL (15.10) \u4F86\u505A demo"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt install postgresql\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5B89\u88DD\u5B8C\u4E4B\u5F8C\u61C9\u8A72\u6703\u81EA\u884C\u555F\u52D5\uFF0C\u6211\u5011\u53EF\u4EE5\u900F\u904E\u4EE5\u4E0B\u6307\u4EE4\u4F86\u78BA\u8A8D\u662F\u5426\u6709\u555F\u52D5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status postgresql\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u63A5\u8457\u6211\u5011\u53EF\u4EE5\u5207\u63DB\u4F7F\u7528\u8005\u4E26\u4E14\u9032\u5165 psql \u4F86\u9032\u884C\u64CD\u4F5C"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo -i -u postgres\npsql\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u8F38\u5165 ",(0,t.jsx)(n.code,{children:"\\q"})," \u5373\u53EF\u96E2\u958B psql"]}),"\n",(0,t.jsx)(n.h2,{id:"postgres-architecture",children:"Postgres Architecture"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Postgres Architecture",src:s(57985).Z+"",width:"1173",height:"581"})}),"\n",(0,t.jsx)(n.h3,{id:"process-manager",children:"Process manager"}),"\n",(0,t.jsx)(n.p,{children:"PostgreSQL \u662F client-server \u7684\u67B6\u69CB\uFF0Cclient \u7AEF\u53EF\u4EE5\u900F\u904E TCP \u9023\u7DDA\u5230 server \u7AEF"}),"\n",(0,t.jsx)(n.p,{children:"\u5C0D\u65BC\u6BCF\u4E00\u500B\u9023\u7DDA\uFF0CPostgreSQL \u90FD\u6703 fork \u4E00\u500B process \u4F86\u8655\u7406"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Postgres Architecture",src:s(64415).Z+"",width:"1108",height:"461"})}),"\n",(0,t.jsx)(n.h3,{id:"shared-memory",children:"Shared Memory"}),"\n",(0,t.jsx)(n.p,{children:"PostgreSQL \u4E26\u4E0D\u6703\u76F4\u63A5\u8B80\u53D6\u786C\u789F\u4E0A\u7684\u8CC7\u6599\uFF0C\u800C\u662F\u5148\u5617\u8A66\u5F9E shared buffer \u4E2D\u8B80\u53D6\u4F86\u6E1B\u5C11\u78C1\u789F I/O \u7684\u6B21\u6578"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Postgres Shared Buffer",src:s(58777).Z+"",width:"1117",height:"523"})}),"\n",(0,t.jsx)(n.h3,{id:"query-processor",children:"Query processor"}),"\n",(0,t.jsx)(n.p,{children:"Query processor \u5206\u70BA\u4E94\u500B\u6B65\u9A5F :"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Connection manager : \u7BA1\u7406 client \u7AEF\u7684\u9023\u7DDA"}),"\n",(0,t.jsx)(n.li,{children:"Query parser : \u89E3\u6790 client \u7AEF\u767C\u9001\u7684\u6307\u4EE4"}),"\n",(0,t.jsx)(n.li,{children:"Query rewriter : \u5C07 view \u4E4B\u985E\u7684\u7269\u4EF6\u8F49\u63DB\u6210\u57FA\u672C\u7684 SQL \u8A9E\u6CD5"}),"\n",(0,t.jsx)(n.li,{children:"Query planner : \u4F9D\u64DA\u7D71\u8A08\u8CC7\u6599\uFF0C\u9078\u64C7\u6700\u4F73\u7684\u57F7\u884C\u8A08\u756B"}),"\n",(0,t.jsx)(n.li,{children:"Query executor : \u57F7\u884C\u6307\u4EE4"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Postgres Query processor",src:s(85273).Z+"",width:"1153",height:"582"})}),"\n","\n",(0,t.jsx)(n.h3,{id:"checkpoint",children:"Checkpoint"}),"\n",(0,t.jsx)(n.p,{children:"\u7576\u8981\u57F7\u884C checkpoint \u6642\uFF0C\u6703\u5C07 shared buffer \u4E2D\u7684\u8CC7\u6599\u5BEB\u5165\u5230\u78C1\u789F\u4E0A\uFF0C\u4E26\u4E14\u5C07 shared buffer \u548C WAL \u4E2D\u7684\u8CC7\u6599\u6A19\u8A18\u70BA\u4E7E\u6DE8"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Postgres Checkpoint",src:s(49745).Z+"",width:"1139",height:"525"})}),"\n",(0,t.jsx)(n.p,{children:"\u9019\u6A23\u7576\u8CC7\u6599\u5EAB\u51FA\u73FE\u554F\u984C\u9700\u8981 recovery \u6642\uFF0C\u53EF\u4EE5\u5F9E checkpoint \u7684\u4F4D\u7F6E\u958B\u59CB\u9032\u884C recovery"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Postgres Checkpoint",src:s(15674).Z+"",width:"986",height:"544"})}),"\n",(0,t.jsx)(n.p,{children:"\u5E38\u898B\u7684\u53C3\u6578\u5305\u542B\u4EE5\u4E0B\u5E7E\u500B\uFF0C\u53EF\u4EE5\u4F9D\u64DA\u5BE6\u969B\u7684\u72C0\u6CC1\u9032\u884C\u8ABF\u6574 :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"checkpoint_flush_after"})," : \u6BCF\u5BEB\u5165\u591A\u5C11\u8CC7\u6599\u5F8C\u5C31\u9032\u884C flush"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"checkpoint_timeout"})," : \u8A2D\u5B9A checkpoint \u7684\u6642\u9593\u9593\u9694"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"checkpoint_completion_target"})," : \u8A2D\u5B9A\u5BEB\u5165\u5FC5\u9808\u5728 checkpoint \u7684\u5E7E\u8DB4\u5167\u5B8C\u6210\uFF0C\u9810\u8A2D\u70BA 0.5"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"wal-writer",children:"WAL writer"}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u8CC7\u6599\u88AB\u4FEE\u6539\u6642\uFF0C\u6703\u5148\u5BEB\u5165\u5230 WAL \u7684 buffer \u4E2D\uFF0C\u76F4\u5230\u88AB commit \u5F8C\u624D\u6703\u5BEB\u5165\u5230\u78C1\u789F\u4E0A"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Postgres WAL writer",src:s(58114).Z+"",width:"1098",height:"555"})}),"\n",(0,t.jsx)(n.p,{children:"\u540C\u6642\uFF0CWAL \u4E5F\u6703\u88AB\u7528\u4F86\u9032\u884C crash recovery \u548C replication"}),"\n",(0,t.jsx)(n.h3,{id:"utility-process",children:"Utility process"}),"\n",(0,t.jsx)(n.p,{children:"\u5728 Postgres \u4E2D\u6709\u5F88\u591A utility process \u6703\u5728\u80CC\u666F\u57F7\u884C\uFF0C\u4F8B\u5982 :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Vacuum"})," : \u6E05\u7406 dead tuples"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Checkpointer"})," : \u57F7\u884C checkpoint"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"WAL Writer"})," : \u7D00\u9304 WAL \u7684\u8CC7\u6599"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Archiver"})," : \u5C07 WAL \u4E2D\u7684\u8CC7\u6599\u5BEB\u5165\u5230\u78C1\u789F"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Stats Collector"})," : \u6536\u96C6\u7D71\u8A08\u8CC7\u6599"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"vacuum",children:"Vacuum"}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 PostgreSQL \u4E2D\uFF0C\u5982\u679C\u6211\u5011\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"DELETE"})," \u6216 ",(0,t.jsx)(n.code,{children:"UPDATE"})," \u6307\u4EE4\u4F86\u522A\u9664\u6216\u4FEE\u6539\u8CC7\u6599\uFF0C\u5BE6\u969B\u4E0A\u4E26\u4E0D\u6703\u7ACB\u5373\u5C07\u8CC7\u6599\u5F9E\u78C1\u789F\u4E0A\u522A\u9664\uFF0C\u800C\u662F\u5C07\u8CC7\u6599\u6A19\u8A18\u70BA dead tuples (\u56E0\u70BA\u9700\u8981\u5728\u5931\u6557\u6642\u9032\u884C rollback)\uFF0C\u9019\u6A23\u7684\u8CC7\u6599\u6703\u4F54\u7528\u78C1\u789F\u7A7A\u9593\uFF0C\u4E26\u4E14\u5F71\u97FF\u67E5\u8A62\u6548\u80FD\u3002\n\u800C ",(0,t.jsx)(n.code,{children:"VACUUM"})," \u6307\u4EE4\u53EF\u4EE5\u5C07\u88AB\u6A19\u8A18\u70BA\u5DF2\u522A\u9664\u6216\u662F\u904E\u671F\u7684 tuple \u6A19\u8A18\u70BA\u53EF\u91CD\u7528\uFF0C\u9019\u6A23\u7576\u4E0B\u4E00\u6B21\u6709\u8CC7\u6599\u9700\u8981\u5BEB\u5165\u6642\uFF0C\u6703\u8986\u84CB\u6389\u539F\u672C\u7684 dead tuples\uFF0C\u56E0\u6B64\u5982\u679C\u6211\u5011\u518D\u6B21\u57F7\u884C ",(0,t.jsx)(n.code,{children:"UPDATE"}),"\uFF0C\u8CC7\u6599\u8868\u7684\u5927\u5C0F\u4E5F\u4E0D\u6703\u589E\u52A0"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679C\u6211\u5011\u60F3\u8981\u522A\u9664\u6240\u6709 dead tuples\uFF0C\u53EF\u4EE5\u57F7\u884C ",(0,t.jsx)(n.code,{children:"VACUUM FULL"})," \u6307\u4EE4\uFF0C\n\u9019\u6A23\u6703\u5C07\u6574\u5F35\u8868\u7684\u8CC7\u6599\u91CD\u65B0\u5BEB\u5165\u5230\u786C\u789F\u4E0A\u4E26\u4E14\u91CB\u653E\u786C\u789F\u7A7A\u9593\uFF0C\u4F46\u662F\u6703\u963B\u585E\u5176\u4ED6\u6307\u4EE4\u7684\u57F7\u884C"]}),"\n",(0,t.jsxs)(n.p,{children:["\u6211\u5011\u53EF\u4EE5\u900F\u904E\u4EE5\u4E0B\u7684\u7BC4\u4F8B\u4F86\u89C0\u5BDF ",(0,t.jsx)(n.code,{children:"VACUUM"})," \u7684\u5F71\u97FF :"]}),"\n",(0,t.jsx)(n.p,{children:"\u9996\u5148\u5275\u5EFA 10 \u842C\u7B46\u8CC7\u6599\u4E26\u95DC\u9589 autovacuum"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE TABLE test (id int) with (autovacuum_enabled = off);\nINSERT INTO test SELECT * FROM generate_series(1, 100000);\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u63A5\u8457\u67E5\u8A62\u8CC7\u6599\u8868\u7684\u5927\u5C0F"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT pg_size_pretty(pg_relation_size('test'));\n-- result\n pg_size_pretty\n----------------\n 3544 kB\n(1 row)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u66F4\u65B0\u4E4B\u5F8C\u518D\u89C0\u5BDF\u8CC7\u6599\u8868\u7684\u5927\u5C0F\uFF0C\u767C\u73FE\u5927\u5C0F\u5927\u7D04\u589E\u52A0\u4E86\u5169\u500D"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"UPDATE test SET id = id + 1;\n\nSELECT pg_size_pretty(pg_relation_size('test'));\n-- result\n pg_size_pretty\n----------------\n 7080 kB\n(1 row)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u63A5\u8457\u57F7\u884C ",(0,t.jsx)(n.code,{children:"VACUUM"})," \u6307\u4EE4\uFF0C\u5927\u5C0F\u4E26\u4E0D\u6703\u6E1B\u5C11\uFF0C\u800C\u662F\u5C07 tuple \u6A19\u8A18\u70BA\u53EF\u91CD\u7528"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"VACUUM test;\n\nSELECT pg_size_pretty(pg_relation_size('test'));\n-- result\n pg_size_pretty\n----------------\n 7080 kB\n(1 row)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u518D\u57F7\u884C\u4E00\u6B21 ",(0,t.jsx)(n.code,{children:"UPDATE"})," \u6307\u4EE4\uFF0C\u5927\u5C0F\u4E26\u4E0D\u6703\u589E\u52A0\uFF0C\u56E0\u70BA\u8986\u84CB\u6389\u4E86\u539F\u672C\u7684 dead tuples"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"UPDATE test SET id = id + 1;\n\nSELECT pg_size_pretty(pg_relation_size('test'));\n-- result\n pg_size_pretty\n----------------\n 7080 kB\n(1 row)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u6700\u5F8C\u57F7\u884C ",(0,t.jsx)(n.code,{children:"VACUUM FULL"})," \u6307\u4EE4\uFF0C\u5927\u5C0F\u6703\u7E2E\u5C0F\u5230\u539F\u672C\u7684\u5927\u5C0F"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"VACUUM FULL test;\n\nSELECT pg_size_pretty(pg_relation_size('test'));\n-- result\n pg_size_pretty\n----------------\n 3544 kB\n(1 row)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5982\u679C\u60F3\u8981\u6AA2\u67E5 table \u4E2D\u6709\u591A\u5C11 dead tuples \u53EF\u4EE5\u57F7\u884C\u4EE5\u4E0B\u6307\u4EE4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT relname, n_live_tup, n_dead_tup FROM pg_stat_user_tables WHERE relname = 'test';\n-- result\nrelname | n_live_tup | n_dead_tup\n---------+------------+------------\n test    |     100000 |     100000\n(1 row)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4E5F\u53EF\u4EE5\u900F\u904E\u4EE5\u4E0B\u6307\u4EE4\u4F86\u6AA2\u67E5 VACUUM \u7684\u53C3\u6578"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"select name,setting\nfrom pg_settings\nwhere name in ('autovacuum_max_workers','autovacuum_naptime','autovacuum_vacuum_scale_factor','autovacuum_vacuum_threshold');\n-- result\n              name              | setting\n--------------------------------+---------\n autovacuum_max_workers         | 3\n autovacuum_naptime             | 60\n autovacuum_vacuum_scale_factor | 0.2\n autovacuum_vacuum_threshold    | 50\n(4 rows)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4E5F\u53EF\u4EE5\u900F\u904E\u8ABF\u6574\u53C3\u6578\u4F86\u63A7\u5236 VACUUM \u7684\u884C\u70BA\uFF0C\u4F8B\u5982 :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"autovacuum_max_workers"})," : \u6700\u5927\u53EF\u4EE5\u540C\u6642\u904B\u884C vacuum \u7684 process \u6578\u91CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"autovacuum_naptime"})," : \u6BCF\u591A\u5C11\u79D2\u9700\u8981\u6AA2\u67E5\u662F\u5426\u9700\u8981\u57F7\u884C vacuum"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"autovacuum_vacuum_scale_factor"})," : \u6C7A\u5B9A\u89F8\u767C vacuum \u7684\u689D\u4EF6"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"autovacuum_vacuum_threshold"})," : \u6C7A\u5B9A\u89F8\u767C vacuum \u7684\u689D\u4EF6"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u800C\u89F8\u767C vacuum \u7684\u516C\u5F0F\u662F : dead tuples > autovacuum_vacuum_scale_factor * tuple count + autovacuum_vacuum_threshold"}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679C\u8CC7\u6599\u91CF\u904E\u5927\uFF0C",(0,t.jsx)(n.code,{children:"VACUUM"})," \u5728\u57F7\u884C\u4E00\u6BB5\u6642\u9593\u5F8C\u5C31\u6703\u9032\u5165\u5230 delay \u7684\u6642\u9593\uFF0C\u8B93\u5176\u4ED6\u64CD\u4F5C\u53EF\u4EE5\u57F7\u884C\uFF0C\u5047\u5982\u4E00\u76F4\u7121\u6CD5\u5B8C\u6210\uFF0C\u5C31\u9700\u8981\u53BB\u8ABF\u6574 ",(0,t.jsx)(n.code,{children:"vacuum_cost_delay"})]}),"\n",(0,t.jsx)(n.h2,{id:"index",children:"Index"}),"\n",(0,t.jsx)(n.h3,{id:"index-introduction",children:"Index introduction"}),"\n",(0,t.jsx)(n.p,{children:"\u7D22\u5F15\u901A\u5E38\u662F\u8CC7\u6599\u5EAB\u6548\u80FD\u7684\u74F6\u9838\uFF0C\u56E0\u6B64\u6211\u5011\u9700\u8981\u9069\u7576\u7684\u5EFA\u7ACB\u7D22\u5F15\u4F86\u63D0\u9AD8\u67E5\u8A62\u6548\u80FD"}),"\n",(0,t.jsx)(n.p,{children:"\u5148\u5EFA\u7ACB\u7BC4\u4F8B\u8CC7\u6599\u8868"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE TABLE test_index (id serial, name text);\nINSERT INTO test_index (name) SELECT 'alice' FROM generate_series(1, 2500000);\nINSERT INTO test_index (name) SELECT 'bob' FROM generate_series(1, 2500000);\n\n-- \u958B\u555F\u8A08\u6642\n\\timing\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u63A5\u8457\u5617\u8A66\u5728\u6C92\u6709\u7D22\u5F15\u7684\u60C5\u6CC1\u4E0B\u9032\u884C\u67E5\u8A62"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"EXPLAIN ANALYZE SELECT * FROM test_index WHERE id = 1000000;\n-- result\n                                                         QUERY PLAN\n-----------------------------------------------------------------------------------------------------------------------------\n Gather  (cost=1000.00..43392.60 rows=15606 width=36) (actual time=100.488..103.282 rows=1 loops=1)\n   Workers Planned: 2\n   Workers Launched: 2\n   ->  Parallel Seq Scan on test_index  (cost=0.00..40832.00 rows=6502 width=36) (actual time=72.973..97.820 rows=0 loops=3)\n         Filter: (id = 1000000)\n         Rows Removed by Filter: 1666666\n Planning Time: 0.286 ms\n Execution Time: 103.303 ms\n(8 rows)\n\nTime: 104.655 ms\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u7D93\u7531\u4E0A\u9762\u7684\u67E5\u8A62\u8A08\u756B\u53EF\u4EE5\u770B\u5230\uFF0CPostgreSQL \u4F7F\u7528\u5169\u500B Workers \u548C Parallel Seq Scan \u4F86\u9032\u884C\u67E5\u8A62"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE INDEX idx_id ON test_index (id);\n\nEXPLAIN ANALYZE SELECT * FROM test_index WHERE id = 1000000;\n-- result\n                                                     QUERY PLAN\n---------------------------------------------------------------------------------------------------------------------\n Index Scan using idx_id on test_index  (cost=0.43..8.45 rows=1 width=9) (actual time=0.653..0.671 rows=1 loops=1)\n   Index Cond: (id = 1000000)\n Planning Time: 1.190 ms\n Execution Time: 0.739 ms\n(4 rows)\n\nTime: 3.408 ms\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230\u4F7F\u7528 index \u4E4B\u5F8C\u901F\u5EA6\u52A0\u5FEB\u4E86\u8A31\u591A\uFF0C\n\u4F46\u662F\u8981\u6CE8\u610F\u7684\u662F index \u6703\u4F54\u7528\u786C\u789F\u7A7A\u9593\uFF0C\u4E26\u4E14\u5728\u5BEB\u5165\u6642\u6703\u589E\u52A0\u984D\u5916\u7684\u958B\u92B7\uFF0C\n\u56E0\u6B64\u9700\u8981\u89C0\u5BDF index \u548C table \u7684\u5927\u5C0F\uFF0C\u4E26\u4E14\u5728\u9069\u7576\u7684\u6642\u6A5F\u4F7F\u7528\u7D22\u5F15"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"\\di+\n-- result\n                                           List of relations\n Schema |   Name   | Type  |  Owner   |   Table    | Persistence | Access method |  Size  | Description\n--------+----------+-------+----------+------------+-------------+---------------+--------+-------------\n public |  idx_id  | index | postgres | test_index | permanent   | btree         | 107 MB |\n(1 row)\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"\\dt+\n-- result\n                                      List of relations\n Schema |    Name    | Type  |  Owner   | Persistence | Access method |  Size  | Description\n--------+------------+-------+----------+-------------+---------------+--------+-------------\n public | test_index | table | postgres | permanent   | heap          | 192 MB |\n(1 row)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"index-use-case",children:"Index use case"}),"\n",(0,t.jsx)(n.p,{children:"\u9664\u4E86\u5728\u67E5\u8A62\u7684\u6642\u5019\u53EF\u4EE5\u4F7F\u7528 index \u4F86\u63D0\u9AD8\u67E5\u8A62\u6027\u80FD\uFF0C\u5728\u505A join \u7684\u6642\u5019\u4E5F\u53EF\u4EE5\u4F7F\u7528 index \u4F86\u63D0\u9AD8\u6027\u80FD\uFF0C\n\u6211\u5011\u53EF\u4EE5\u5728 foreign key \u4E0A\u5EFA\u7ACB index \uFF0C\n\u9019\u6A23\u9664\u4E86\u53EF\u4EE5\u63D0\u9AD8 join \u7684\u6548\u7387\u5916\uFF0C\n\u5728 parent table \u8B8A\u52D5\u6642\uFF0C\u4E5F\u53EF\u4EE5\u63D0\u9AD8\u6548\u80FD"}),"\n",(0,t.jsx)(n.p,{children:"\u81F3\u65BC index \u7684\u4E0B\u6CD5\uFF0C\u6211\u5011\u9664\u4E86\u91DD\u5C0D\u5168\u8868\u5EFA\u7ACB index \u5916\uFF0C\u4E5F\u53EF\u4EE5\u91DD\u5C0D\u67D0\u4E9B\u7279\u5B9A\u7684\u503C\u4F86\u5EFA\u7ACB index (partial index)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE INDEX idx_name_res ON test_index(name) WHERE name not in ('alice', 'bob');\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u9084\u6709\u4E00\u7A2E index \u7684\u6A21\u5F0F\u53EB\u505A combination index\uFF0C\u9019\u7A2E index \u53EF\u4EE5\u5C07\u591A\u500B\u6B04\u4F4D\u7D44\u5408\u8D77\u4F86\u5EFA\u7ACB index"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE INDEX idx_name_res2 ON test_index(name, id);\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u4E0A\u65B9\u7684\u7BC4\u4F8B\u4E2D\uFF0C\u5982\u679C\u6211\u5011\u540C\u6642\u5C0D name \u8DDF id \u67E5\u8A62\u6216\u55AE\u7368\u5C0D name \u67E5\u8A62\uFF0C\u90FD\u53EF\u4EE5\u4F7F\u7528\u5230\u9019\u500B index\uFF0C\u4F46\u5982\u679C\u53EA\u5C0D id \u67E5\u8A62\uFF0C\u5C31\u7121\u6CD5\u4F7F\u7528\u9019\u500B index"}),"\n",(0,t.jsx)(n.h3,{id:"index-cluster",children:"Index cluster"}),"\n",(0,t.jsx)(n.p,{children:"\u9664\u6B64\u4E4B\u5916 correlation \u4E5F\u53EF\u4EE5\u7528\u4F86\u63D0\u9AD8\u67E5\u8A62\u6548\u80FD\uFF0C\u7531\u65BC\u8CC7\u6599\u7684\u7269\u7406\u4F4D\u7F6E\u63A5\u8FD1\uFF0C\u53EF\u4EE5\u6E1B\u5C11 I/O \u7684\u6B21\u6578\uFF0C\u9032\u800C\u63D0\u9AD8\u67E5\u8A62\u6548\u80FD"}),"\n",(0,t.jsx)(n.p,{children:"\u63A5\u4E0B\u4F86\u6211\u5011\u900F\u904E\u5169\u500B\u7BC4\u4F8B\u4F86\u8AAA\u660E correlation \u7684\u5F71\u97FF :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE TABLE t_test (id serial, name text);\nINSERT INTO t_test (name) SELECT 'alice' FROM generate_series(1, 500000);\nCREATE INDEX t_test_idx ON t_test (id);\nVACUUM ANALYZE t_test;\nEXPLAIN (ANALYZE true, BUFFERS true, TIMING true) SELECT * FROM t_test WHERE id < 10000;\n-- result\nQUERY PLAN\n----------------------------------------------------------------------------------------------------------------------------\n Index Scan using t_test_idx on t_test  (cost=0.42..321.59 rows=9324 width=10) (actual time=0.054..1.826 rows=9999 loops=1)\n   Index Cond: (id < 10000)\n   Buffers: shared hit=55 read=30\n Planning:\n   Buffers: shared hit=17 read=1\n Planning Time: 0.321 ms\n Execution Time: 2.325 ms\n(7 rows)\n\nTime: 3.179 ms\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE TABLE t_random as SELECT * FROM t_test ORDER BY random();\nCREATE INDEX t_random_idx ON t_random (id);\nVACUUM ANALYZE t_random;\nEXPLAIN (ANALYZE true, BUFFERS true, TIMING true) SELECT * FROM t_random WHERE id < 10000;\n-- result\nQUERY PLAN\n------------------------------------------------------------------------------------------------------------------------------\n Bitmap Heap Scan on t_random  (cost=191.22..3070.30 rows=10167 width=10) (actual time=1.065..3.621 rows=9999 loops=1)\n   Recheck Cond: (id < 10000)\n   Heap Blocks: exact=2636\n   Buffers: shared hit=2636 read=30\n   ->  Bitmap Index Scan on t_random_idx  (cost=0.00..188.68 rows=10167 width=0) (actual time=0.789..0.789 rows=9999 loops=1)\n         Index Cond: (id < 10000)\n         Buffers: shared read=30\n Planning:\n   Buffers: shared hit=9\n Planning Time: 0.095 ms\n Execution Time: 4.446 ms\n(11 rows)\n\nTime: 4.959 ms\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230 Buffer \u7684 shared hit \u76F8\u5DEE\u5F88\u591A\uFF0C\u9032\u800C\u5F71\u97FF\u4E86\u6548\u80FD"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53EF\u4EE5\u900F\u904E\u4EE5\u4E0B\u7684\u7BC4\u4F8B\u4F86\u67E5\u770B correlation \u7684\u6578\u503C"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT tablename, attname, correlation FROM pg_stats WHERE tablename IN ('t_test', 't_random') ORDER BY 1, 2;\n-- result\ntablename | attname | correlation\n-----------+---------+-------------\n t_random  | id      | 0.012932359\n t_random  | name    |           1\n t_test    | id      |           1\n t_test    | name    |           1\n(4 rows)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679C\u8981\u89E3\u6C7A\u9019\u500B\u554F\u984C\uFF0C\u6211\u5011\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"CLUSTER"})," \u6307\u4EE4\u4F86\u5C07\u8CC7\u6599\u6309\u7167 index \u7684\u9806\u5E8F\u91CD\u65B0\u6392\u5217\uFF0C\u4F86\u63D0\u9AD8\u67E5\u8A62\u6548\u80FD\uFF0C\n\u4F46\u9019\u500B\u65B9\u5F0F\u6703\u9020\u6210\u9396\u8868\uFF0C\u4E14\u53EA\u80FD\u4F9D\u64DA\u4E00\u500B index \u4F86\u9032\u884C\u6392\u5E8F\uFF0C\u4E26\u4E14\u7576\u65B0\u7684\u8CC7\u6599\u9032\u5165\u6642\uFF0C\u4E5F\u4E0D\u6703\u81EA\u52D5\u91CD\u65B0\u6392\u5E8F"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CLUSTER t_random USING t_random_idx;\nANALYZE;\nSELECT tablename, attname, correlation FROM pg_stats WHERE tablename IN ('t_test', 't_random') ORDER BY 1, 2;\n-- result\ntablename | attname | correlation\n-----------+---------+-------------\n t_random  | id      |           1\n t_random  | name    |           1\n t_test    | id      |           1\n t_test    | name    |           1\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5728 PostgreSQL \u4E2D\uFF0C\u6709\u4E00\u500B\u53C3\u6578\u53EB\u505A fill factor \uFF0C\u9810\u8A2D\u662F 100%\uFF0C\n\u9019\u500B\u53C3\u6578\u6703\u6C7A\u5B9A page \u88AB\u586B\u6EFF\u7684\u7A0B\u5EA6\uFF0C\u5982\u679C\u6211\u5011\u5C07 fill factor \u8A2D\u5B9A\u70BA 90%\uFF0C\u90A3\u9EBC\u7576 page \u88AB\u586B\u6EFF 90% \u6642\uFF0C\n\u5C31\u4E0D\u6703\u518D\u5BEB\u5165\u65B0\u7684\u8CC7\u6599\uFF0C\u800C\u662F\u628A\u7A7A\u9593\u9810\u7559\u7D66\u66F4\u65B0\u548C\u522A\u9664\u7684\u8CC7\u6599\uFF0C\u4F7F\u4E4B\u8B8A\u6210 HOT update"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53EF\u4EE5\u900F\u904E\u4EE5\u4E0B\u7BC4\u4F8B\u4F86\u5BA3\u544A fill factor \u7684\u503C :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE TABLE test_fillfactor (id serial, name text) WITH (fillfactor = 90);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"statistics",children:"Statistics"}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 PostgreSQL \u4E2D\uFF0C\u7D71\u8A08\u8CC7\u6599\u662F\u975E\u5E38\u91CD\u8981\u7684\uFF0C\u5B83\u53EF\u4EE5\u5E6B\u52A9\u6211\u5011\u4E86\u89E3\u8CC7\u6599\u5EAB\u7684\u72C0\u6CC1\uFF0C\u4E26\u4E14\u63D0\u4F9B\u6700\u4F73\u5316\u7684\u5EFA\u8B70\u3002\n\u6211\u5011\u53EF\u4EE5\u900F\u904E ",(0,t.jsx)(n.code,{children:"pg_stat_statements"})," \u4F86\u67E5\u770B\u7D71\u8A08\u8CC7\u6599\uFF0C\u9019\u500B view \u6703\u8A18\u9304\u6240\u6709\u57F7\u884C\u7684 SQL \u8A9E\u53E5\uFF0C\u4E26\u4E14\u63D0\u4F9B\u57F7\u884C\u6642\u9593\u3001\u57F7\u884C\u6B21\u6578\u3001\u8B80\u53D6\u7684\u8CC7\u6599\u91CF\u7B49\u8CC7\u8A0A\u3002"]}),"\n",(0,t.jsx)(n.p,{children:"\u9996\u5148\u6211\u5011\u9700\u8981\u555F\u52D5\u9019\u500B extension\uFF0C\u6211\u5011\u9700\u8981\u5148\u96E2\u958B psql \u4E26\u5275\u5EFA\u4E00\u500B\u65B0\u7684\u8CC7\u6599\u5EAB\u4E26\u4F7F\u7528 pgbench \u751F\u6210\u4E00\u4E9B\u5047\u8CC7\u6599 :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"\\q\n\ncreatedb benchdb\n\npgbench -i benchdb\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u63A5\u8457\u9700\u8981\u8ABF\u6574 postgresql.conf \u4F86\u555F\u52D5\u9019\u500B extension"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd /etc/postgresql/15/main\nnano postgresql.conf\n# change shared_preload_libraries = 'pg_stat_statements'\n\nexit\nsudo systemctl restart postgresql\n\nsudo -i -u postgres\npsql benchdb\nCREATE EXTENSION pg_stat_statements;\n\\q\n\npgbench -c 10 -t 10000 benchdb\npsql benchdb\n\\x\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u63A5\u8457\u6211\u5011\u53EF\u80FD\u9700\u8981\u8ABF\u6574\u4E00\u4E0B\u986F\u793A\u65B9\u5F0F\uFF0C\u8F38\u5165 ",(0,t.jsx)(n.code,{children:"\\x"})," \u4F86\u986F\u793A\u55AE\u884C\uFF0C\u4E26\u67E5\u770B ",(0,t.jsx)(n.code,{children:"pg_stat_statements"})," \u7684\u8CC7\u6599"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT * FROM pg_stat_statements;\n-- result\n-[ RECORD 1 ]----------+------------------------------------\nuserid                 | 10\ndbid                   | 16411\ntoplevel               | t\nqueryid                | -8553890797533947962\nquery                  | CREATE EXTENSION pg_stat_statements\nplans                  | 0\ntotal_plan_time        | 0\nmin_plan_time          | 0\nmax_plan_time          | 0\nmean_plan_time         | 0\nstddev_plan_time       | 0\ncalls                  | 1\ntotal_exec_time        | 36.871701\nmin_exec_time          | 36.871701\nmax_exec_time          | 36.871701\nmean_exec_time         | 36.871701\nstddev_exec_time       | 0\nrows                   | 0\nshared_blks_hit        | 2653\nshared_blks_read       | 131\nshared_blks_dirtied    | 60\nshared_blks_written    | 7\nlocal_blks_hit         | 0\nlocal_blks_read        | 0\nlocal_blks_dirtied     | 0\nlocal_blks_written     | 0\ntemp_blks_read         | 0\ntemp_blks_written      | 0\n--More--\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u9019\u500B view \u6703\u8A18\u9304\u76F8\u540C\u7684 SQL \u8A9E\u53E5\u4E26\u751F\u6210\u7D71\u8A08\u8CC7\u6599 (\u4E0D\u540C\u53C3\u6578\u7B97\u540C\u4E00\u8A9E\u53E5)\uFF0C\u6211\u5011\u53EF\u4EE5\u91CD\u9EDE\u6CE8\u610F\u5E7E\u500B\u6B04\u4F4D :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"mean_exec_time"})," : \u5E73\u5747\u57F7\u884C\u6642\u9593"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"stddev_exec_time"})," : \u57F7\u884C\u6642\u9593\u7684\u6A19\u6E96\u5DEE\uFF0C\u53EF\u4EE5\u5224\u65B7\u67E5\u8A62\u662F\u5426\u7A69\u5B9A"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"shared_blks_hit"})," : \u5F9E shared buffer \u4E2D\u8B80\u53D6\u7684\u8CC7\u6599\u91CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"shared_blks_read"})," : \u5F9E disk \u4E2D\u8B80\u53D6\u7684\u8CC7\u6599\u91CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"temp_blks_read"})," : \u5F9E temp disk \u4E2D\u8B80\u53D6\u7684\u8CC7\u6599\u91CF\uFF0C\u5982\u679C\u9019\u500B\u6578\u503C\u5F88\u5927\uFF0C\u8868\u793A\u9019\u500B\u67E5\u8A62\u53EF\u80FD\u6709 IO \u554F\u984C"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"temp_blks_written"})," : \u5BEB\u5165 temp disk \u7684\u8CC7\u6599\u91CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"blk_read_time"})," : \u8B80\u53D6 disk \u7684\u6642\u9593"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"blk_write_time"})," : \u5BEB\u5165 disk \u7684\u6642\u9593"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u7684\u6307\u4EE4\u4F86\u67E5\u8A62\u524D 10 \u500B\u57F7\u884C\u6642\u9593\u6700\u9577\u7684 SQL \u8A9E\u53E5 :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT\n    round((100 * total_exec_time / sum(total_exec_time) OVER ())::numeric, 2) AS percent,\n    round(total_exec_time::numeric, 2) AS total,\n    calls,\n    round(mean_exec_time::numeric, 2) AS mean,\n    substring(query, 1, 200) AS query\nFROM pg_stat_statements\nORDER BY total_exec_time DESC\nLIMIT 10;\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u9664\u4E86\u5B89\u88DD\u9019\u500B extension \u4E4B\u5916\uFF0C\u6211\u5011\u4E5F\u53EF\u4EE5\u900F\u904E\u7CFB\u7D71\u5167\u5EFA\u7684 ",(0,t.jsx)(n.code,{children:"pg_stat_sys_table"})," \u548C ",(0,t.jsx)(n.code,{children:"pg_stat_user_table"})," \u4F86\u67E5\u770B\u7CFB\u7D71\u548C\u4F7F\u7528\u8005\u8868\u7684\u7D71\u8A08\u8CC7\u6599"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"psql -d benchdb\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT * FROM pg_stat_user_tables;\n-- result\n-[ RECORD 1 ]-------+------------------------------\nrelid               | 24650\nschemaname          | public\nrelname             | pgbench_branches\nseq_scan            | 5296\nlast_seq_scan       | 2024-07-31 03:16:49.550047+00\nseq_tup_read        | 5296\nidx_scan            | 59414\nlast_idx_scan       | 2024-07-31 03:16:49.729185+00\nidx_tup_fetch       | 59414\nn_tup_ins           | 1\nn_tup_upd           | 64707\nn_tup_del           | 0\nn_tup_hot_upd       | 64424\nn_tup_newpage_upd   | 283\nn_live_tup          | 1\nn_dead_tup          | 19\nn_mod_since_analyze | 0\nn_ins_since_vacuum  | 0\nlast_vacuum         | 2024-07-31 03:16:49.548988+00\nlast_autovacuum     |\nlast_analyze        | 2024-07-31 03:15:09.69068+00\nlast_autoanalyze    | 2024-07-31 03:16:56.637775+00\nvacuum_count        | 3\nautovacuum_count    | 0\nanalyze_count       | 1\nautoanalyze_count   | 1\n--More--\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53EF\u4EE5\u6CE8\u610F\u4E00\u4E9B\u53C3\u6578\uFF0C\u4F8B\u5982 :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"seq_scan"})," : \u4F7F\u7528 sequential scan \u7684\u6B21\u6578"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"idx_scan"})," : \u4F7F\u7528 index scan \u7684\u6B21\u6578"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"n_live_tup"})," : \u8868\u4E2D\u5B58\u6D3B\u7684 tuple \u6578\u91CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"n_dead_tup"})," : \u88AB\u522A\u9664\u7684 tuple \u6578\u91CF"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u63D0\u4F9B\u7684 SQL \u4F86\u5E6B\u52A9\u6211\u5011\u7372\u5F97\u4E00\u4E9B\u6709\u7528\u7684\u8CC7\u8A0A :"}),"\n",(0,t.jsx)(n.p,{children:"\u90A3\u4E9B table \u4F7F\u7528 index scan \u7684\u6BD4\u4F8B\u6700\u591A"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT  schemaname,\n        relname,\n        seq_scan,\n        idx_scan,\n        cast(idx_scan AS numeric) / (idx_scan + seq_scan) AS idx_scan_pct\nFROM pg_stat_user_tables\nWHERE (idx_scan + seq_scan) > 0\nORDER BY idx_scan_pct;\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5BE6\u969B\u8B80\u53D6\u7684\u8CC7\u6599\u91CF\u6709\u591A\u5C11\u662F\u5F9E\u7D22\u5F15\u7372\u53D6\u7684"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT  relname, seq_tup_read,\n        idx_tup_fetch,\n        cast(idx_tup_fetch AS numeric) / (idx_tup_fetch + seq_tup_read) AS idx_tup_pct\nFROM pg_stat_user_tables\nWHERE (idx_tup_fetch + seq_tup_read) > 0\nORDER BY idx_tup_pct;\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53EF\u4EE5\u544A\u8A34\u6211\u5011\u90A3\u4E9B\u8868\u7D93\u5E38\u9032\u884C\u5168\u8868\u6383\u63CF\uFF0C\u53EF\u80FD\u9700\u8981\u5EFA\u7ACB index"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT schemaname,\n       relname,\n       seq_scan,\n       seq_tup_read,\n       seq_tup_read / seq_scan AS avg,\n       idx_scan\nFROM   pg_stat_user_tables\nWHERE  seq_scan > 0\nORDER BY seq_tup_read DESC\nLIMIT  25;\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u90A3\u4E9B\u8868\u5E38\u5E38\u9032\u884C\u5BEB\u5165\uFF0C\u90A3\u4E9B\u8868\u5E38\u5E38\u9032\u884C\u66F4\u65B0\u6216\u522A\u9664"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT  relname,\n        cast(n_tup_ins AS numeric) / (n_tup_ins + n_tup_upd + n_tup_del) AS ins_pct,\n        cast(n_tup_upd AS numeric) / (n_tup_ins + n_tup_upd + n_tup_del) AS upd_pct,\n        cast(n_tup_del AS numeric) / (n_tup_ins + n_tup_upd + n_tup_del) AS del_pct\nFROM pg_stat_user_tables\nORDER BY relname;\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53EF\u4EE5\u544A\u8A34\u6211\u5011\u90A3\u4E9B\u8868\u5E38\u5E38\u9032\u884C HOT \u66F4\u65B0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT  relname,\n        n_tup_upd,\n        n_tup_hot_upd,\n        cast(n_tup_hot_upd AS numeric) / n_tup_upd AS hot_pct\nFROM pg_stat_user_tables\nWHERE n_tup_upd > 0\nORDER BY hot_pct;\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53EF\u4EE5\u544A\u8A34\u6211\u5011 index \u4F7F\u7528\u7387\u548C\u5927\u5C0F"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT  schemaname,\n        relname,\n        indexrelname,\n        idx_scan,\n        pg_size_pretty(pg_relation_size(indexrelid)) AS idx_size\nFROM pg_stat_user_indexes;\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53EF\u4EE5\u8A55\u4F30\u7D22\u5F15\u7684\u6548\u7387\uFF0C\u9AD8 avg_tuples \u503C\u8868\u793A\u8A72\u7D22\u5F15\u5728\u6BCF\u6B21\u6383\u63CF\u6642\u80FD\u5920\u7372\u53D6\u8F03\u591A\u7684\u76F8\u95DC\u6578\u64DA"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT  indexrelname,\n        cast(idx_tup_read AS numeric) / idx_scan AS avg_tuples,\n        idx_scan,\n        idx_tup_read\nFROM pg_stat_user_indexes\nWHERE idx_scan > 0;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"query-plan",children:"Query Plan"}),"\n",(0,t.jsx)(n.p,{children:"PostgreSQL \u63D0\u4F9B\u4E86\u56DB\u7A2E scan \u7684\u65B9\u5F0F\uFF0C\u5206\u5225\u662F :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Seq Scan : \u5168\u8868\u6383\u63CF"}),"\n",(0,t.jsx)(n.li,{children:"Index Scan : \u7D22\u5F15\u6383\u63CF"}),"\n",(0,t.jsx)(n.li,{children:"Index Only Scan : \u53EA\u8B80\u53D6\u7D22\u5F15\u7684\u8CC7\u6599"}),"\n",(0,t.jsx)(n.li,{children:"Bitmap Scan : \u4F4D\u5716\u6383\u63CF"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u8A73\u7D30\u7684\u8AAA\u660E\u53EF\u4EE5\u53C3\u8003 ",(0,t.jsx)(n.a,{href:"https://oldmo860617.medium.com/%E4%BB%A5-postgressql-%E7%82%BA%E4%BE%8B%E4%BA%86%E8%A7%A3%E8%B3%87%E6%96%99%E5%BA%AB%E7%9A%84-query-plans-abd8b5f54c66",children:"\u4EE5 PostgreSQL \u70BA\u4F8B\u4E86\u89E3\u8CC7\u6599\u5EAB\u7684 Query Plans"})]}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 PostgreSQL \u4E2D\uFF0C\u6211\u5011\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"EXPLAIN ANALYZE"})," \u6307\u4EE4\u4F86\u67E5\u770B\u67E5\u8A62\u7684\u57F7\u884C\u8A08\u5283\uFF0C\u9019\u500B\u6307\u4EE4\u6703\u544A\u8A34\u6211\u5011\u67E5\u8A62\u7684\u57F7\u884C\u6D41\u7A0B\uFF0C\u4EE5\u53CA\u6BCF\u500B\u6B65\u9A5F\u7684\u57F7\u884C\u6642\u9593\u548C\u8CC7\u6599\u91CF"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"EXPLAIN (analyze, verbose, costs, timing, buffers) SELECT * FROM pgbench_tellers;\n-- result\n                                                     QUERY PLAN\n---------------------------------------------------------------------------------------------------------------------\n Seq Scan on public.pgbench_tellers  (cost=0.00..12.10 rows=10 width=352) (actual time=0.009..0.016 rows=10 loops=1)\n   Output: tid, bid, tbalance, filler\n   Buffers: shared hit=12\n Query Identifier: 8245021215169886143\n Planning Time: 0.038 ms\n Execution Time: 0.027 ms\n(6 rows)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53EF\u4EE5\u6CE8\u610F\u4EE5\u4E0B\u91CD\u9EDE :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Seq Scan on public.pgbench_tellers"})," : \u9019\u6B21\u4F7F\u7528\u7684\u662F\u5168\u8868\u6383\u63CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"cost=0.00..12.10"})," : \u7B2C\u4E00\u500B\u6578\u5B57\u4EE3\u8868\u7BC0\u9EDE\u524D\u7F6E\u4F5C\u696D\u6240\u9700\u7684\u6642\u9593 (\u5982\u679C\u662F index scan\uFF0C\u5247\u53EF\u80FD\u4EE3\u8868\u5B9A\u4F4D\u5230\u7B2C\u4E00\u500B\u7D22\u5F15\u7684\u6642\u9593)\uFF0C\u7B2C\u4E8C\u500B\u6578\u5B57\u4EE3\u8868\u57F7\u884C\u5B8C\u6210\u6240\u9810\u4F30\u7684\u6642\u9593"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"rows=10"})," : \u9810\u4F30\u56DE\u50B3\u7684 row \u6578\u91CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"width=352"})," : \u6BCF\u884C\u8CC7\u6599\u7684\u5E73\u5747\u5927\u5C0F"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"actual time=0.009..0.016"})," : \u7B2C\u4E00\u500B\u6578\u5B57\u4EE3\u8868\u7BC0\u9EDE\u958B\u59CB\u8655\u7406\u7684\u6642\u9593\uFF0C\u7B2C\u4E8C\u500B\u6578\u5B57\u4EE3\u8868\u7BC0\u9EDE\u8655\u7406\u5B8C\u6210\u7684\u6642\u9593"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"rows=10"})," : \u5BE6\u969B\u56DE\u50B3\u7684 row \u6578\u91CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"loops=1"})," : \u57F7\u884C\u6B21\u6578\uFF0C\u5982\u679C\u6709 join \u7684\u8A71\u53EF\u80FD\u6703\u6709\u591A\u6B21\u57F7\u884C"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Buffers: shared hit=12"})," : \u5F9E shared buffer \u4E2D\u8B80\u53D6\u7684 page \u6578\u91CF"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Planning Time: 0.038 ms"})," : \u8A08\u5283\u6642\u9593"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Execution Time: 0.027 ms"})," : \u57F7\u884C\u6642\u9593"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"cost estimate",src:s(88101).Z+"",width:"541",height:"410"})}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u53EF\u4EE5\u4F9D\u64DA\u4E0A\u9762\u9019\u5F35\u5716\u4F86\u8A08\u7B97 query \u7684 cost\uFF0C\u9032\u800C\u7522\u751F\u6700\u597D\u7684\u57F7\u884C\u8A08\u5283"}),"\n",(0,t.jsxs)(n.p,{children:["\u6211\u5011\u4E5F\u53EF\u4EE5\u5728 PostgreSQL \u4E2D\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"pg_class"})," \u4F86\u67E5\u770B table \u7684\u76F8\u95DC\u8CC7\u8A0A"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT  relpages,\n        current_setting('seq_page_cost') AS seq_page_cost,\n        relpages * current_setting('seq_page_cost')::decimal AS page_cost,\n        reltuples,\n        current_setting('cpu_tuple_cost') AS cpu_tuple_cost,\n        relpages * current_setting('cpu_tuple_cost')::decimal AS tuple_cost\nFROM pg_class\nWHERE relname = 'pgbench_tellers';\n-- result\nrelpages | seq_page_cost | page_cost | reltuples | cpu_tuple_cost | tuple_cost\n----------+---------------+-----------+-----------+----------------+------------\n        7 | 1             |         7 |        10 | 0.01           |       0.07\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u5011\u4E5F\u6709\u53EF\u80FD\u9047\u5230 query plan \u4F30\u8A08\u7684\u503C\u8207\u5BE6\u969B\u76F8\u5DEE\u5F88\u5927\u7684\u60C5\u6CC1\uFF0C\u4F8B\u5982 :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE TABLE test_estimate as SELECT * FROM generate_series(1, 10000) as id;\nEXPLAIN ANALYZE SELECT * FROM test_estimate WHERE cos(id) < 4;\n-- result\n                                                   QUERY PLAN\n----------------------------------------------------------------------------------------------------------------\n Seq Scan on test_estimate  (cost=0.00..220.00 rows=3333 width=4) (actual time=0.070..0.924 rows=10000 loops=1)\n   Filter: (cos((id)::double precision) < '4'::double precision)\n Planning Time: 0.792 ms\n Execution Time: 1.224 ms\n(4 rows)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230\u4F30\u8A08\u7684 row \u8DDF\u5BE6\u969B\u7684 row \u76F8\u5DEE\u5F88\u5927\uFF0C\u9019\u6642\u5019\u6211\u5011\u53EF\u80FD\u5C31\u9700\u8981\u4F7F\u7528 index \u6216\u662F\u5176\u4ED6\u7684\u624B\u6BB5\u4F86\u89E3\u6C7A\u9019\u500B\u554F\u984C"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE INDEX idx_test_estimate ON test_estimate (cos(id));\nANALYZE test_estimate;\nEXPLAIN ANALYZE SELECT * FROM test_estimate WHERE cos(id) > 4;\n-- result\n                                                   QUERY PLAN\n-----------------------------------------------------------------------------------------------------------------\n Seq Scan on test_estimate  (cost=0.00..220.00 rows=10000 width=4) (actual time=0.015..1.638 rows=10000 loops=1)\n   Filter: (cos((id)::double precision) < '4'::double precision)\n Planning Time: 0.325 ms\n Execution Time: 2.052 ms\n(4 rows)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"sql-optimization",children:"SQL Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"join-order",children:"Join Order"}),"\n",(0,t.jsx)(n.p,{children:"PostgreSQL \u6703\u5728 join \u7684\u6642\u5019\u5617\u8A66\u4E0D\u540C\u7684 join order \u4F86\u627E\u5230\u6700\u512A\u7684\u57F7\u884C\u8A08\u5283\uFF0C\u9810\u8A2D\u662F 8 \u6B21\uFF0C\u6211\u5011\u53EF\u4EE5\u5C07\u5176\u8A2D\u7F6E\u70BA 1 \u4F86\u5F37\u5236\u4F7F\u7528\u624B\u52D5\u7684 join order"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SELECT * FROM pg_settings WHERE name = 'join_collapse_limit';\nSET join_collapse_limit = 1;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"avoid-select-",children:"Avoid SELECT *"}),"\n",(0,t.jsxs)(n.p,{children:["\u6E1B\u5C11\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"SELECT *"}),"\uFF0C\u6709\u6A5F\u6703\u53EF\u4EE5\u8B93 index scan \u8B8A\u6210 index only scan"]}),"\n",(0,t.jsx)(n.h3,{id:"avoid-order-by",children:"Avoid Order By"}),"\n",(0,t.jsx)(n.p,{children:"\u7531\u65BC PostgreSQL \u5728\u57F7\u884C order by \u7684\u6642\u5019\uFF0C\u6703\u9700\u8981\u984D\u5916\u958B\u555F\u4E00\u500B\u6392\u5E8F\u7684 buffer\uFF0C\n\u9019\u6A23\u6703\u5C0E\u81F4\u8A18\u61B6\u9AD4\u4F7F\u7528\u91CF\u589E\u52A0\uFF0C\u9032\u800C\u5F71\u97FF\u6548\u80FD\uFF0C\u56E0\u6B64\u6211\u5011\u61C9\u8A72\u76E1\u91CF\u907F\u514D\u4F7F\u7528 order by\uFF0C\u4F46\u5982\u679C\u6709 index \u5247\u53EF\u4EE5\u5927\u5E45\u6E1B\u5C11\u9019\u500B\u554F\u984C"}),"\n",(0,t.jsx)(n.h3,{id:"avoid-distinct",children:"Avoid Distinct"}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u4F7F\u7528 distinct \u6642\uFF0C PostgreSQL \u9700\u8981\u7522\u751F\u4E00\u500B\u984D\u5916\u7684 Unique node \u4F86\u8655\u7406\uFF0C\u56E0\u6B64\u6211\u5011\u61C9\u8A72\u76E1\u91CF\u907F\u514D\u4F7F\u7528 distinct"}),"\n",(0,t.jsx)(n.h3,{id:"parallel-query",children:"Parallel Query"}),"\n",(0,t.jsx)(n.p,{children:"PostgreSQL \u53EF\u4EE5\u4F7F\u7528\u5E73\u884C\u7684\u65B9\u5F0F\u4F86\u57F7\u884C query\uFF0C\u9019\u6A23\u53EF\u4EE5\u5927\u5E45\u6E1B\u5C11\u57F7\u884C\u6642\u9593\uFF0C\u53EF\u4EE5\u900F\u904E\u4EE5\u4E0B\u6307\u4EE4\u4F86\u67E5\u770B\u76F8\u95DC\u7684\u8A2D\u5B9A :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SHOW max_worker_processes;\nSHOW max_parallel_workers_per_gather;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"shared-buffer",children:"Shared Buffer"}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u4E0D\u7279\u5225\u91DD\u5C0D\u67D0\u500B table \u7684\u60C5\u6CC1\u4E0B\uFF0C\u6211\u5011\u53EF\u4EE5\u5C07 shared buffer \u8A2D\u7F6E\u70BA RAM \u6578\u91CF\u7684 25% \u5DE6\u53F3\uFF0C\u9019\u662F\u56E0\u70BA PostgreSQL \u4F7F\u7528\u4E86 OS \u7684 cache\uFF0C\u56E0\u6B64\u4E0D\u9700\u8981\u5C07 shared buffer \u8A2D\u7F6E\u7684\u592A\u5927"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"shared buffer",src:s(85054).Z+"",width:"698",height:"550"})}),"\n","\n",(0,t.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.udemy.com/course/postgresql-high-performance-tuning-guide",children:"PostgreSQL High Performance Tuning Guide"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.interdb.jp/pg/index.html",children:"The Internals of PostgreSQL"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://oldmo860617.medium.com/%E4%BB%A5-postgressql-%E7%82%BA%E4%BE%8B%E4%BA%86%E8%A7%A3%E8%B3%87%E6%96%99%E5%BA%AB%E7%9A%84-query-plans-abd8b5f54c66",children:"\u4EE5 PostgreSQL \u70BA\u4F8B\u4E86\u89E3\u8CC7\u6599\u5EAB\u7684 Query Plans"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},64415:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-1-4bdcf0170b7e0dca0d7d064608e95fde.png"},88101:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-10-0a69563c3c7b822098c3ff6769883c4b.png"},85054:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-11-412204ea9bd5a0a1a7ac5d508fd76959.png"},58777:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-2-1106f184584dfb51593154d604765950.png"},85273:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-3-b4a13be1b1cacf60064e19d7737306db.png"},15674:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-6-aee1e560f4c7a049695159320e420747.png"},49745:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-7-e5d2cd289ef5513eff554deff75dee31.png"},58114:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-8-c403fed56482ad32d569e3d31601f818.png"},57985:function(e,n,s){s.d(n,{Z:()=>i});let i=s.p+"assets/images/image-61acbff2d42b7c1d4d512924cd7512a1.png"},50065:function(e,n,s){s.d(n,{Z:()=>c,a:()=>l});var i=s(67294);let t={},r=i.createContext(t);function l(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);