"use strict";(self.webpackChunkrulerchen_website=self.webpackChunkrulerchen_website||[]).push([["8333"],{5825:function(e,s,n){n.r(s),n.d(s,{frontMatter:()=>t,toc:()=>m,default:()=>h,metadata:()=>i,assets:()=>c,contentTitle:()=>r});var i=JSON.parse('{"id":"CMU15-445/c15","title":"Query Planning & Optimization","description":"CMU15-445/645 Query Planning & Optimization","source":"@site/docs/CMU15-445/c15.mdx","sourceDirName":"CMU15-445","slug":"/CMU15-445/c15","permalink":"/RulerChen-Website/en/docs/CMU15-445/c15","draft":false,"unlisted":false,"editUrl":"https://github.com/RulerChen/RulerChen-Website/tree/main/docs/CMU15-445/c15.mdx","tags":[{"inline":true,"label":"CMU15-445","permalink":"/RulerChen-Website/en/docs/tags/cmu-15-445"}],"version":"current","lastUpdatedAt":1757601758000,"sidebarPosition":15,"frontMatter":{"title":"Query Planning & Optimization","sidebar_position":15,"description":"CMU15-445/645 Query Planning & Optimization","keywords":["CMU15-445/645","Query Planning & Optimization","CMU15-445/645 \u7B46\u8A18"],"tags":["CMU15-445"]},"sidebar":"tutorialSidebar","previous":{"title":"Query Execution","permalink":"/RulerChen-Website/en/docs/CMU15-445/c13"},"next":{"title":"Concurrency Control Theory","permalink":"/RulerChen-Website/en/docs/CMU15-445/c16"}}'),l=n(4848),a=n(4429);let t={title:"Query Planning & Optimization",sidebar_position:"15",description:"CMU15-445/645 Query Planning & Optimization",keywords:["CMU15-445/645","Query Planning & Optimization","CMU15-445/645 \u7B46\u8A18"],tags:["CMU15-445"]},r,c={},m=[{value:"Logical Query Optimization",id:"logical-query-optimization",level:2},{value:"Selection Optimization",id:"selection-optimization",level:3},{value:"Projection Optimization",id:"projection-optimization",level:3},{value:"Query Rewrite Optimization",id:"query-rewrite-optimization",level:3},{value:"Join Optimization",id:"join-optimization",level:3},{value:"Cost Estimation",id:"cost-estimation",level:2},{value:"Statistics",id:"statistics",level:3},{value:"Histograms",id:"histograms",level:3},{value:"Sketches",id:"sketches",level:3},{value:"Sampling",id:"sampling",level:3},{value:"Query Plan",id:"query-plan",level:2},{value:"Single-Relation Query Plans",id:"single-relation-query-plans",level:3},{value:"Multi-Relation Query Plans",id:"multi-relation-query-plans",level:3},{value:"Generative / Bottom-up",id:"generative--bottom-up",level:4},{value:"Transformation / Top-down",id:"transformation--top-down",level:4}];function o(e){let s={annotation:"annotation",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",math:"math",mi:"mi",mo:"mo",mrow:"mrow",msub:"msub",p:"p",semantics:"semantics",span:"span",ul:"ul",...(0,a.R)(),...e.components},{Head:n,ImageModal:i}=s;return n||d("Head",!0),i||d("ImageModal",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n,{children:(0,l.jsx)("title",{children:"CMU 15-445 Query Planning & Optimization"})}),"\n",(0,l.jsx)(s.p,{children:"\u7531\u65BC SQL \u662F\u4E00\u7A2E\u5BA3\u544A\u5F0F\u7684\u8A9E\u8A00\uFF0C\u6240\u4EE5 DBMS \u4E0D\u6703\u5177\u9AD4\u77E5\u9053\u81EA\u5DF1\u61C9\u8A72\u8981\u600E\u9EBC\u57F7\u884C\uFF0C\u800C\u662F\u9700\u8981\u5C07 SQL \u8A9E\u53E5\u8F49\u63DB\u6210\u53EF\u57F7\u884C\u7684 query plan\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u4F46\u627E\u5230\u6700\u4F73\u7684 query plan \u662F\u4E00\u500B NP-hard \u7684\u554F\u984C\uFF0C\u56E0\u6B64\u672C\u7BC0\u7684\u4E3B\u8981\u5167\u5BB9\u5C31\u662F\u5982\u4F55\u900F\u904E\u6F14\u7B97\u6CD5\u5728\u6709\u9650\u7684\u6642\u9593\u5167\u627E\u5230\u4E00\u500B\u597D\u7684 query plan\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u6211\u5011\u4F7F\u7528\u7684\u7B56\u7565\u4E3B\u8981\u6709\u5169\u500B :"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Heuristic-based : \u4F7F\u7528\u65E2\u5B9A\u7684\u898F\u5247\u4F86\u8ABF\u6574\u9806\u5E8F"}),"\n",(0,l.jsx)(s.li,{children:"Cost-based : \u4F9D\u64DA\u7D71\u8A08\u8CC7\u6599\u4F86\u4F30\u7B97\u6210\u672C\uFF0C\u9078\u64C7 cost \u6700\u4F4E\u7684 query plan"}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"\u800C query plan \u4E3B\u8981\u4E5F\u6709\u5169\u7A2E\u985E\u578B :"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Logical Plan : \u67E5\u8A62\u4E2D\u7684\u95DC\u4FC2\u4EE3\u6578\u8868\u9054\u5F0F"}),"\n",(0,l.jsx)(s.li,{children:"Physical Plan : \u5177\u9AD4\u7684\u57F7\u884C\u7B56\u7565\uFF0C\u5982\u6392\u5E8F\u7684\u65B9\u6CD5\u3001join \u7684\u65B9\u5F0F\u7B49"}),"\n"]}),"\n",(0,l.jsx)(i,{src:"/img/cmu15-445/c15/image.webp",caption:"Query Process"}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u9019\u500B SQL \u8A9E\u53E5\u57F7\u884C\u7684\u6D41\u7A0B\u5716\u4E2D\uFF0Cbinder \u8DDF tree rewriter \u6703\u8CA0\u8CAC\u5C07 SQL \u8A9E\u53E5\u8F49\u63DB\u6210 logical plan\uFF0C\u800C optimizer \u5247\u6703\u900F\u904E system catalog \u6240\u63D0\u4F9B\u7684\u8CC7\u8A0A\u4F86\u5C07 logical plan \u8F49\u63DB\u6210 physical plan\u3002"}),"\n",(0,l.jsx)(s.h2,{id:"logical-query-optimization",children:"Logical Query Optimization"}),"\n",(0,l.jsx)(s.p,{children:"\u6211\u5011\u53EF\u4EE5\u5148\u900F\u904E\u4E00\u4E9B\u7C21\u55AE\u7684\u898F\u5247\u5C07 logical plan \u9032\u884C\u512A\u5316\uFF0C\u9019\u4E9B\u898F\u5247\u901A\u5E38\u662F\u57FA\u65BC\u95DC\u4FC2\u4EE3\u6578\u7684\u7B49\u50F9\u8F49\u63DB\u3002"}),"\n",(0,l.jsx)(s.h3,{id:"selection-optimization",children:"Selection Optimization"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"\u76E1\u65E9\u57F7\u884C\u7BE9\u9078\u689D\u4EF6 : \u900F\u904E\u7BE9\u9078\u689D\u4EF6\u6E1B\u5C11 tuple \u6578\u91CF\uFF0C\u7279\u5225\u662F\u5728 join \u4E4B\u524D"}),"\n",(0,l.jsx)(s.li,{children:"\u91CD\u65B0\u6392\u5E8F\u7BE9\u9078\u689D\u4EF6 : \u5C07\u9078\u64C7\u6027\u6700\u9AD8\u7684\u689D\u4EF6\u653E\u5728\u524D\u9762\u57F7\u884C\uFF0C\u4F7F\u5F8C\u9762\u6240\u9700\u904E\u6FFE\u7684 tuple \u6578\u91CF\u66F4\u5C11"}),"\n",(0,l.jsxs)(s.li,{children:["\u5C07\u8907\u96DC\u7684\u7BE9\u9078\u689D\u4EF6\u62C6\u5206 : \u62C6\u5206\u7BE9\u9078\u689D\u4EF6\uFF0C\u5982 ",(0,l.jsx)(s.code,{children:"X = Y AND Y = 3"})," \u53EF\u4EE5\u62C6\u5206\u6210 ",(0,l.jsx)(s.code,{children:"X = 3 AND Y = 3"})]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"projection-optimization",children:"Projection Optimization"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\u522A\u9664\u4E0D\u5FC5\u8981\u7684 column : \u6E1B\u5C11 I/O\uFF0C\u8209\u4F8B\u4F86\u8AAA\uFF0C\u5982\u679C SQL \u4E2D\u53EA\u6709 ",(0,l.jsx)(s.code,{children:"SELECT name FROM table"}),"\uFF0C\u90A3\u9EBC\u6211\u5011\u5C31\u61C9\u8A72\u5728\u4E00\u958B\u59CB\u53EA\u7559 name \u6B04\u4F4D\u518D\u505A\u5F8C\u7E8C\u64CD\u4F5C"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"query-rewrite-optimization",children:"Query Rewrite Optimization"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\u79FB\u9664\u4E0D\u53EF\u80FD\u6216\u4E0D\u5FC5\u8981\u7684\u7BE9\u9078\u689D\u4EF6 : \u5982 ",(0,l.jsx)(s.code,{children:"WHERE 1 = 0"})]}),"\n",(0,l.jsxs)(s.li,{children:["\u5408\u4F75\u7BE9\u9078\u689D\u4EF6 : \u5982 ",(0,l.jsx)(s.code,{children:"VAL BETWEEN 1 AND 10 OR VAL BETWEEN 5 AND 15"})," \u53EF\u4EE5\u5408\u4F75\u6210 ",(0,l.jsx)(s.code,{children:"VAL BETWEEN 1 AND 15"})]}),"\n",(0,l.jsx)(s.li,{children:"\u6D88\u9664\u5B50\u67E5\u8A62 : \u5C07\u5B50\u67E5\u8A62\u6524\u5E73 (flatten) \u6216\u53D6\u6D88\u95DC\u806F (de-correlate)"}),"\n",(0,l.jsx)(s.li,{children:"\u62C6\u89E3\u548C\u5132\u5B58\u7D50\u679C\u81F3\u81E8\u6642\u8868 : \u5982\u679C\u6709\u8907\u96DC\u7684\u5B50\u67E5\u8A62\uFF0C\u53EF\u4EE5\u5C07\u7D50\u679C\u5132\u5B58\u81F3\u81E8\u6642\u8868\u4E26\u9010\u4E00\u512A\u5316"}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"join-optimization",children:"Join Optimization"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Join Reordering : \u91CD\u65B0\u6392\u5E8F join \u7684\u9806\u5E8F\uFF0C\u5982\u5C07\u8CC7\u6599\u91CF\u8F03\u5C11\u7684 table \u7576\u6210 outer table"}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"cost-estimation",children:"Cost Estimation"}),"\n",(0,l.jsx)(s.p,{children:"\u9664\u4E86\u4E00\u4E9B\u57FA\u672C\u7684 heuristic \u5916\uFF0C\u6709\u8A31\u591A\u64CD\u4F5C\u5728 DBMS \u4E2D\u6C92\u6709\u4E00\u5B9A\u7684\u512A\u52A3\uFF0C\u6240\u4EE5\u6211\u5011\u9700\u8981\u900F\u904E cost estimation \u4F86\u4F30\u7B97\u6210\u672C\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u67E5\u8A62\u6210\u672C\u901A\u5E38\u53D6\u6C7A\u65BC\u5F88\u591A\u56E0\u7D20\uFF0C\u5982 CPU\u3001\u786C\u789F I/O\u3001\u8A18\u61B6\u9AD4\u3001\u7DB2\u7D61\u7B49\u3002\n\u4EE5 PostgreSQL \u4F86\u8AAA\uFF0C\u4ED6\u6703\u70BA\u6BCF\u500B\u64CD\u4F5C\u6307\u5B9A\u4E00\u500B\u56FA\u5B9A\u7684 CPU \u6210\u672C (\u5982 seq_page_cost = 1.0, random_page_cost = 4.0)\uFF0C\u6216\u662F\u4E00\u500B\u56FA\u5B9A\u7684 I/O \u6210\u672C (\u5982 cpu_tuple_cost = 0.01, cpu_index_tuple_cost = 0.005)\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u4F46\u5927\u90E8\u5206\u7684\u6210\u672C\u4F9D\u820A\u53D6\u6C7A\u65BC\u5728\u6574\u500B query plan \u4E2D\u6211\u5011\u8981\u8B80\u5BEB\u591A\u5C11 tuple\uFF0C\u56E0\u6B64 DBMS \u9700\u8981\u7DAD\u8B77\u4E00\u4E9B\u7D71\u8A08\u8CC7\u6599\uFF0C\u5982 tuple \u6578\u91CF\u6216\u6700\u5927\u6700\u5C0F\u503C\u4F86\u5E6B\u52A9\u4F30\u7B97\u6210\u672C\u3002"}),"\n",(0,l.jsx)(s.h3,{id:"statistics",children:"Statistics"}),"\n",(0,l.jsx)(s.p,{children:"\u901A\u5E38\u5C0D\u65BC\u4E00\u500B\u4EFB\u610F\u7684 table R\uFF0CDBMS \u90FD\u6703\u7DAD\u8B77\u4EE5\u4E0B\u7D71\u8A08\u8CC7\u6599 :"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsx)(s.mrow,{children:(0,l.jsxs)(s.msub,{children:[(0,l.jsx)(s.mi,{children:"N"}),(0,l.jsx)(s.mi,{children:"R"})]})}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"N_R"})]})})}),(0,l.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"}),(0,l.jsx)(s.span,{className:"msupsub",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,l.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.00773em"},children:"R"})})]})}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(s.span,{})})})]})})]})]})})]})," : R \u4E2D\u7684 tuple \u6578\u91CF"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"V"}),(0,l.jsx)(s.mo,{stretchy:"false",children:"("}),(0,l.jsx)(s.mi,{children:"A"}),(0,l.jsx)(s.mo,{separator:"true",children:","}),(0,l.jsx)(s.mi,{children:"R"}),(0,l.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"V(A,R)"})]})})}),(0,l.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,l.jsx)(s.span,{className:"mopen",children:"("}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,l.jsx)(s.span,{className:"mpunct",children:","}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,l.jsx)(s.span,{className:"mclose",children:")"})]})})]})," : R \u4E2D\u5C6C\u6027 A \u7684\u4E0D\u540C\u503C\u6578\u91CF"]}),"\n"]}),"\n",(0,l.jsxs)(s.p,{children:["\u900F\u904E\u9019\u5169\u500B\u8CC7\u8A0A\uFF0C\u6211\u5011\u53EF\u4EE5\u5F97\u5230 selection cardinality ",(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"S"}),(0,l.jsx)(s.mi,{children:"C"}),(0,l.jsx)(s.mo,{stretchy:"false",children:"("}),(0,l.jsx)(s.mi,{children:"A"}),(0,l.jsx)(s.mo,{separator:"true",children:","}),(0,l.jsx)(s.mi,{children:"R"}),(0,l.jsx)(s.mo,{stretchy:"false",children:")"}),(0,l.jsx)(s.mo,{children:"="}),(0,l.jsxs)(s.msub,{children:[(0,l.jsx)(s.mi,{children:"N"}),(0,l.jsx)(s.mi,{children:"R"})]}),(0,l.jsx)(s.mi,{mathvariant:"normal",children:"/"}),(0,l.jsx)(s.mi,{children:"V"}),(0,l.jsx)(s.mo,{stretchy:"false",children:"("}),(0,l.jsx)(s.mi,{children:"A"}),(0,l.jsx)(s.mo,{separator:"true",children:","}),(0,l.jsx)(s.mi,{children:"R"}),(0,l.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"SC(A,R) = N_R / V(A,R)"})]})})}),(0,l.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"SC"}),(0,l.jsx)(s.span,{className:"mopen",children:"("}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,l.jsx)(s.span,{className:"mpunct",children:","}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,l.jsx)(s.span,{className:"mclose",children:")"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(s.span,{className:"mrel",children:"="}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"}),(0,l.jsx)(s.span,{className:"msupsub",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,l.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.00773em"},children:"R"})})]})}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(s.span,{})})})]})})]}),(0,l.jsx)(s.span,{className:"mord",children:"/"}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,l.jsx)(s.span,{className:"mopen",children:"("}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,l.jsx)(s.span,{className:"mpunct",children:","}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,l.jsx)(s.span,{className:"mclose",children:")"})]})]})]}),"\u3002"]}),"\n",(0,l.jsx)(s.p,{children:"\u9664\u6B64\u4E4B\u5916\uFF0C\u4EE5 PostgreSQL \u70BA\u4F8B\uFF0C\u5B83\u9084\u6703\u7DAD\u8B77\u4EE5\u4E0B\u7D71\u8A08\u8CC7\u6599 :"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"n_distinct : \u6BCF\u500B\u6B04\u4F4D\u7684\u552F\u4E00\u503C\u6578\u91CF"}),"\n",(0,l.jsx)(s.li,{children:"most_common_vals : \u6BCF\u500B\u6B04\u4F4D\u4E2D\u6700\u5E38\u51FA\u73FE\u7684\u503C"}),"\n",(0,l.jsx)(s.li,{children:"histogram_bounds : \u6BCF\u500B\u6B04\u4F4D\u7684 histogram \u7BC4\u570D"}),"\n",(0,l.jsx)(s.li,{children:"correlation : \u6BCF\u500B\u6B04\u4F4D\u7684\u503C\u8207\u7269\u7406\u5132\u5B58\u9806\u5E8F\u7684\u76F8\u95DC\u6027"}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"histograms",children:"Histograms"}),"\n",(0,l.jsx)(s.p,{children:"\u771F\u5BE6\u7684\u8CC7\u6599\u4E2D\u5E7E\u4E4E\u4E0D\u53EF\u80FD\u662F uniform \u7684\uFF0C\u56E0\u6B64\u6211\u5011\u53EF\u4EE5\u4F7F\u7528 histogram \u4F86\u66F4\u597D\u7684\u4F30\u7B97\u6210\u672C\uFF0Chistogram \u6703\u5C07\u5C6C\u6027\u7684\u503C\u57DF (range) \u5206\u6210\u591A\u500B\u5340\u9593 (bucket)\uFF0C\u4E26\u8A18\u9304\u6BCF\u500B\u5340\u9593\u7684 tuple \u6578\u91CF\u3002"}),"\n",(0,l.jsx)(s.h3,{id:"sketches",children:"Sketches"}),"\n",(0,l.jsx)(s.p,{children:"\u6211\u5011\u53EF\u4EE5\u4F7F\u7528 probabilistic data structures \u4F86\u7522\u751F\u8FD1\u4F3C\u65BC dataset \u7684\u8CC7\u6599\uFF0C\u5982 HyperLogLog\u3001Count-Min Sketch \u7B49\u7B49\u3002"}),"\n",(0,l.jsx)(s.h3,{id:"sampling",children:"Sampling"}),"\n",(0,l.jsxs)(s.p,{children:["DBMS \u53EF\u4EE5\u91DD\u5C0D table \u7684\u90E8\u5206\u8CC7\u6599\u9032\u884C sampling \u4F86\u4F30\u7B97\u6210\u672C\uFF0C\u4E26\u5728 table \u8B8A\u52D5\u8D85\u904E\u4E00\u5B9A\u6BD4\u4F8B\u6642\u91CD\u65B0\u9032\u884C sampling\uFF0C\u5982 PostgreSQL \u7684 ",(0,l.jsx)(s.code,{children:"ANALYZE"})," \u6307\u4EE4\u3002"]}),"\n",(0,l.jsx)(s.h2,{id:"query-plan",children:"Query Plan"}),"\n",(0,l.jsx)(s.p,{children:"\u5728\u6709\u4E86 cost estimation \u5F8C\uFF0Coptimizer \u5C31\u53EF\u4EE5\u958B\u59CB\u5728\u5DE8\u5927\u7684 search space \u4E2D\u5C0B\u627E\u6700\u4F73\u7684 query plan\u3002"}),"\n",(0,l.jsx)(s.h3,{id:"single-relation-query-plans",children:"Single-Relation Query Plans"}),"\n",(0,l.jsx)(s.p,{children:"\u5C0D\u65BC\u55AE\u8868\u67E5\u8A62\u4F86\u8AAA\uFF0C\u53EA\u9700\u8981\u4F7F\u7528\u7C21\u55AE\u7684\u555F\u767C\u5F0F\u898F\u5247\u5373\u53EF\uFF0C\u76EE\u6A19\u662F\u627E\u5230\u6700\u4F73\u7684 access method\u3002"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"sequential scan"}),"\n",(0,l.jsx)(s.li,{children:"binary search (with clustered indexes)"}),"\n",(0,l.jsx)(s.li,{children:"index scan"}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"multi-relation-query-plans",children:"Multi-Relation Query Plans"}),"\n",(0,l.jsx)(s.p,{children:"\u96A8\u8457\u9023\u7D50\u6578\u91CF\u7684\u589E\u52A0\uFF0C\u53EF\u4EE5\u9078\u64C7\u7684\u8A08\u5283\u6578\u91CF\u6703\u6025\u5287\u589E\u52A0\uFF0C\u56E0\u6B64\u6211\u5011\u9700\u8981\u9650\u5236\u641C\u7D22\u7A7A\u9593\u4EE5\u4FBF\u5728\u6709\u9650\u6642\u9593\u5167\u627E\u5230\u6700\u4F73\u8A08\u5283\uFF0C\u901A\u5E38\u6709 bottom-up \u548C top-down \u5169\u7A2E\u65B9\u6CD5\u3002"}),"\n",(0,l.jsx)(s.h4,{id:"generative--bottom-up",children:"Generative / Bottom-up"}),"\n",(0,l.jsx)(s.p,{children:"\u5F9E\u55AE\u8868\u958B\u59CB\u9010\u6B65\u5EFA\u7ACB\u66F4\u5927\u7684\u8A08\u756B\uFF0C\u5C31\u50CF\u662F\u52D5\u614B\u898F\u5283 (Dynamic Programming) \u4E00\u6A23\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u8209\u4F8B\u4F86\u8AAA\uFF0C\u5047\u8A2D\u6211\u5011\u8981\u627E\u5230\u4E09\u500B table A\u3001B\u3001C \u7684\u6700\u4F73 join order\uFF0C\u6B65\u9A5F\u6703\u5927\u81F4\u5982\u4E0B :"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"\u5148\u91DD\u5C0D\u55AE\u8868\u627E\u5230\u6700\u4F73\u7684 access method\uFF0C\u5982 sequential scan\u3001index scan"}),"\n",(0,l.jsx)(s.li,{children:"\u5169\u5169\u4E00\u7D44\uFF0C\u627E\u51FA\u6700\u4F73\u7684 join order\uFF0C\u5982 (A hash join B)\u3001(B merge sort join C)\u3001(A hash join C)"}),"\n",(0,l.jsx)(s.li,{children:"\u63A5\u8457\u5728\u5F9E\u4E0A\u4E00\u8F2A\u7684\u7D50\u679C\u4E2D\u627E\u51FA\u6700\u4F73\u7684 join order\uFF0C\u5982 ((A hash join B) merge sort join C)\u3001((B merge sort join C) hash join A)"}),"\n"]}),"\n",(0,l.jsx)(i,{src:"/img/cmu15-445/c15/image-6.webp",caption:"Bottom-Up"}),"\n",(0,l.jsx)(s.h4,{id:"transformation--top-down",children:"Transformation / Top-down"}),"\n",(0,l.jsx)(s.p,{children:"Optimizer \u6703\u5F9E logical plan \u958B\u59CB\uFF0C\u4F7F\u7528 branch and bound \u7684\u65B9\u6CD5\u4F86\u904D\u6B77\u6A39\u72C0\u7D50\u69CB\uFF0C\u4E26\u5C07 logical operator \u8F49\u63DB\u6210 physical operator\u3002"}),"\n",(0,l.jsx)(i,{src:"/img/cmu15-445/c15/image-5.webp",caption:"Top-Down"})]})}function h(e={}){let{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}function d(e,s){throw Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},4429:function(e,s,n){n.d(s,{R:()=>t,x:()=>r});var i=n(6540);let l={},a=i.createContext(l);function t(e){let s=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(a.Provider,{value:s},e.children)}}}]);