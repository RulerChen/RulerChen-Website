<!doctype html><html lang=zh-Hant dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-CMU15-445/p0" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.1"><title data-rh=true>CMU 15-445 2024Fall P0 C++ Primer</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://RulerChen.github.io/RulerChen-Website/img/profile/profile.webp /><meta data-rh=true name=twitter:image content=https://RulerChen.github.io/RulerChen-Website/img/profile/profile.webp /><meta data-rh=true property=og:url content=https://RulerChen.github.io/RulerChen-Website/docs/CMU15-445/p0/ /><meta data-rh=true property=og:locale content=zh_Hant /><meta data-rh=true property=og:locale:alternate content=en /><meta data-rh=true name=docusaurus_locale content=zh-Hant /><meta data-rh=true name=docsearch:language content=zh-Hant /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="P0 - C++ Primer | RulerChen"/><meta data-rh=true name=description content="C++ Primer"/><meta data-rh=true property=og:description content="C++ Primer"/><meta data-rh=true name=keywords content="CMU15-445/645,C++ Primer,CMU15-445/645 筆記"/><link data-rh=true rel=icon href=/RulerChen-Website/img/profile/profile.webp /><link data-rh=true rel=canonical href=https://RulerChen.github.io/RulerChen-Website/docs/CMU15-445/p0/ /><link data-rh=true rel=alternate href=https://RulerChen.github.io/RulerChen-Website/docs/CMU15-445/p0/ hreflang=zh-Hant /><link data-rh=true rel=alternate href=https://RulerChen.github.io/RulerChen-Website/en/docs/CMU15-445/p0/ hreflang=en /><link data-rh=true rel=alternate href=https://RulerChen.github.io/RulerChen-Website/docs/CMU15-445/p0/ hreflang=x-default /><link data-rh=true rel=preconnect href=https://GSV9DQB5UM-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://RulerChen.github.io/RulerChen-Website/docs/CMU15-445/","name":"CMU 15-445","position":1},{"@type":"ListItem","item":"https://RulerChen.github.io/RulerChen-Website/docs/CMU15-445/p0","name":"P0 - C++ Primer","position":2}]}</script><link rel=alternate type=application/rss+xml href=/RulerChen-Website/blog/rss.xml title="RulerChen RSS Feed"><link rel=alternate type=application/atom+xml href=/RulerChen-Website/blog/atom.xml title="RulerChen Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-8BEHDPLQMG"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8BEHDPLQMG",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=RulerChen href=/RulerChen-Website/opensearch.xml><meta name=google-site-verification content=QrdRbPEcOsJJ_kfRVewqfwR6GjPcRf0UVgRb85I-5fc><link rel=preconnect href=https://cdn.jsdelivr.net crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css type=text/css integrity=sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM crossorigin=anonymous><link rel=stylesheet href=/RulerChen-Website/assets/css/styles.815dbb1c.css /><script src=/RulerChen-Website/assets/js/runtime~main.cbecc07d.js defer></script><script src=/RulerChen-Website/assets/js/main.5bf69a90.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t;document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/RulerChen-Website/img/profile/profile.webp /><div role=region aria-label=跳至主要内容><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>跳至主要内容</a></div><nav aria-label=主導航 class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label=切換導覽列 aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/RulerChen-Website/><div class=navbar__logo><img src=/RulerChen-Website/img/profile/profile.webp alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/RulerChen-Website/img/profile/profile.webp alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">RulerChen</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/RulerChen-Website/docs/intro/>Notes</a><a class="navbar__item navbar__link" href=/RulerChen-Website/blog/>Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>繁體中文</a><ul class=dropdown__menu><li><a href=/RulerChen-Website/docs/CMU15-445/p0/ target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=zh-Hant>繁體中文</a><li><a href=/RulerChen-Website/en/docs/CMU15-445/p0/ target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a></ul></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="搜尋 (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>搜尋</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=回到頂部 class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label=文件側邊欄 class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/RulerChen-Website/docs/intro/><span title=Introduction class=linkLabel_WmDU>Introduction</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/RulerChen-Website/docs/CMU15-213/><span title="CMU 15-213" class=categoryLinkLabel_W154>CMU 15-213</span></a><button aria-label="展開側邊欄分類 'CMU 15-213'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/RulerChen-Website/docs/CMU15-445/><span title="CMU 15-445" class=categoryLinkLabel_W154>CMU 15-445</span></a><button aria-label="收起側邊欄分類 'CMU 15-445'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c01/><span title="Relational Model & Algebra" class=linkLabel_WmDU>Relational Model & Algebra</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c02/><span title="Modern SQL" class=linkLabel_WmDU>Modern SQL</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c03/><span title="Database Storage" class=linkLabel_WmDU>Database Storage</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c05/><span title="Storage Models & Compression" class=linkLabel_WmDU>Storage Models & Compression</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c06/><span title="Memory & Disk I/O Management" class=linkLabel_WmDU>Memory & Disk I/O Management</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c07/><span title="Hash Tables" class=linkLabel_WmDU>Hash Tables</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c08/><span title="Indexes & Filters" class=linkLabel_WmDU>Indexes & Filters</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c09/><span title="Index Concurrency Control" class=linkLabel_WmDU>Index Concurrency Control</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c11/><span title="Sorting & Aggregations Algorithms" class=linkLabel_WmDU>Sorting & Aggregations Algorithms</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c12/><span title="Joins Algorithms" class=linkLabel_WmDU>Joins Algorithms</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c13/><span title="Query Execution" class=linkLabel_WmDU>Query Execution</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c15/><span title="Query Planning & Optimization" class=linkLabel_WmDU>Query Planning & Optimization</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c16/><span title="Concurrency Control Theory" class=linkLabel_WmDU>Concurrency Control Theory</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c17/><span title="Two-Phase Locking Concurrency Control" class=linkLabel_WmDU>Two-Phase Locking Concurrency Control</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c18/><span title="Timestamp Ordering Concurrency Control" class=linkLabel_WmDU>Timestamp Ordering Concurrency Control</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c19/><span title="Multi-Version Concurrency Control" class=linkLabel_WmDU>Multi-Version Concurrency Control</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c20/><span title="Database Logging" class=linkLabel_WmDU>Database Logging</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c21/><span title="Database Recovery" class=linkLabel_WmDU>Database Recovery</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c22/><span title="Introduction to Distributed Databases" class=linkLabel_WmDU>Introduction to Distributed Databases</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c23/><span title="Distributed OLTP Database Systems" class=linkLabel_WmDU>Distributed OLTP Database Systems</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/c24/><span title="Distributed OLAP Database Systems" class=linkLabel_WmDU>Distributed OLAP Database Systems</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/RulerChen-Website/docs/CMU15-445/p0/><span title="P0 - C++ Primer" class=linkLabel_WmDU>P0 - C++ Primer</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/p1/><span title="P1 - Buffer Pool Manager" class=linkLabel_WmDU>P1 - Buffer Pool Manager</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/p2/><span title="P2 - B+ Tree" class=linkLabel_WmDU>P2 - B+ Tree</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/p3/><span title="P3 - Query Execution" class=linkLabel_WmDU>P3 - Query Execution</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/RulerChen-Website/docs/CMU15-445/p4/><span title="P4 - Concurrency Control" class=linkLabel_WmDU>P4 - Concurrency Control</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/RulerChen-Website/docs/Security/><span title=Security class=categoryLinkLabel_W154>Security</span></a><button aria-label="展開側邊欄分類 'Security'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_z5aJ"><div class=docItemContainer_c0TR><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=頁面路徑><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label=主頁面 class=breadcrumbs__link href=/RulerChen-Website/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/RulerChen-Website/docs/CMU15-445/><span>CMU 15-445</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>P0 - C++ Primer</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">本頁導覽</button></div><div class="theme-doc-markdown markdown"><header><h1>P0 - C++ Primer</h1></header>
<p>在這個 project 中，我們需要實現一種常見的資料結構以及它的變體 :</p>
<ul>
<li>HyperLogLog</li>
<li>Presto HyperLogLog</li>
</ul>
<p>這個作業主要是幫助大家熟悉 C++，對於已經熟悉的人來說，我認為可以直接跳過這個作業，因為這個作業不會影響後續的作業內容。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=learning-resource>Learning Resource<a href=#learning-resource class=hash-link aria-label="Learning Resource的直接連結" title="Learning Resource的直接連結" translate=no>​</a></h2>
<p>下面列出一些我覺得不錯的資源，可以幫助更快上手 C++ 和相關工具 :</p>
<ul>
<li><a href=https://github.com/cmu-db/15445-bootcamp target=_blank rel="noopener noreferrer">15-445 C++ Bootcamp</a></li>
<li><a href="https://www.youtube.com/watch?v=G9gnSGKYIg4" target=_blank rel="noopener noreferrer">Debug a C++ project in VS Code</a></li>
<li><a href=https://seisman.github.io/how-to-write-makefile/overview.html target=_blank rel="noopener noreferrer">Makefile</a> (Optional)</li>
<li><a href="https://www.bilibili.com/video/BV14h41187FZ/?vd_source=0b8d45cc2260b9a7a9d948d819ac16f3" target=_blank rel="noopener noreferrer">CMake</a> (Optional)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=environment-setup>Environment Setup<a href=#environment-setup class=hash-link aria-label="Environment Setup的直接連結" title="Environment Setup的直接連結" translate=no>​</a></h2>
<p>這個作業最重要的是要能夠順利編譯和執行 C++ 的程式碼，並且能夠使用 debugger 來除錯。</p>
<p>我的環境設定如下 :</p>
<ol>
<li>環境是 WSL2 (Ubuntu 24.04) 和 VSCode</li>
<li>安裝 VSCode 套件 <code>C/C++ Extension Pack</code>、<code>clangd</code>、<code>CMake Tools</code>、<code>Clang-Format</code></li>
<li>將 bustub clone 下來，並且回退到 2024 Fall 的 commit，或是直接從 <a href=https://github.com/cmu-db/bustub/releases/tag/v20241207-2024fall target=_blank rel="noopener noreferrer">release</a> 下載 zip 檔解壓縮</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">git clone https://github.com/cmu-db/bustub.git</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">cd bustub</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">git checkout f97256b88b20468c01023928b63f5693d697674c</span><br/></span></code></pre></div></div>
<ol start=4>
<li>把 <code>.git</code> 移除並接上自己的 git repo (這堂課有要求不能公開解答，不然有機會被寫在 WALL OF SHAME 裡面)</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">rm -rf .git</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">git init</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">git add .</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">git commit -m "init"</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">git remote add origin &lt;your-git-repo></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">git push -u origin main</span><br/></span></code></pre></div></div>
<ol start=5>
<li>由於我使用的是 Ubuntu 24.04，所以需要修改一下 <code>packages.sh</code> 的內容，並順便安裝 <code>clangd</code> 的套件</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockTitle_OeMC>build_support/packages.sh</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">install_linux() {</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">  # Update apt-get.</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">  apt-get -y update</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">  # Install packages.</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">  apt-get -y install \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      build-essential \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      clang-14 \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      clang-format-14 \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      clang-tidy-14 \</span></span><br/></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      clangd-14 \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      cmake \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      doxygen \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      git \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      pkg-config \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      zlib1g-dev \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      libelf-dev \</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      libdwarf-dev</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">}</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain" style=display:inline-block></span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">install() {</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">  set -x</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">  UNAME=$(uname | tr "[:lower:]" "[:upper:]" )</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain" style=display:inline-block></span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">  case $UNAME in</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">    DARWIN) install_mac ;;</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain" style=display:inline-block></span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">    LINUX)</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      version=$(cat /etc/os-release | grep VERSION_ID | cut -d '"' -f 2)</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      case $version in</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        18.04) install_linux ;;</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        20.04) install_linux ;;</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        22.04) install_linux ;;</span></span><br/></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        # add this line</span></span><br/></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        24.04) install_linux ;;</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        *) give_up ;;</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      esac</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">      ;;</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain" style=display:inline-block></span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">    *) give_up ;;</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">  esac</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">}</span></span><br/></span></code></pre></div></div>
<ol start=6>
<li>安裝套件</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">sudo build_support/packages.sh</span><br/></span></code></pre></div></div>
<ol start=7>
<li>嘗試編譯一下，看看有沒有問題</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_C_COMPILER=/usr/bin/clang-14 -DCMAKE_CXX_COMPILER=/usr/bin/clang++-14 -B build</span><br/></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">cd build && make -j`nproc`</span><br/></span></code></pre></div></div>
<ol start=8>
<li>設定 formatter 以及 cmake、clangd 等等</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockTitle_OeMC>.vscode/settings.json</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">{</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "[cpp]": {</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    "editor.defaultFormatter": "xaver.clang-format"</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  },</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "[c]": {</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    "editor.defaultFormatter": "xaver.clang-format"</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  },</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "C_Cpp.clang_format_path": "/usr/bin/clang-format-14",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "C_Cpp.formatting": "clangFormat",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "C_Cpp.clang_format_style": "file",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "clang-format.executable": "/usr/bin/clang-format-14",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "clangd.path": "/usr/bin/clangd-14",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "cmake.configureSettings": {</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    "CMAKE_C_COMPILER": "/usr/bin/clang-14",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    "CMAKE_CXX_COMPILER": "/usr/bin/clang++-14"</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  },</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "editor.formatOnSave": true</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">}</span><br/></span></code></pre></div></div>
<ol start=9>
<li>安裝 debugger，我使用的 debugger 是 <code>GDB</code></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">sudo apt install gdb</span><br/></span></code></pre></div></div>
<ol start=10>
<li>這個設定可以幫助我們顯示 STL 容器的內容</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockTitle_OeMC>.vscode/launch.json</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">{</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "version": "0.2.0",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  "configurations": [</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    {</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "name": "C/C++: g++ build and debug active file",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "type": "cppdbg",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "request": "launch",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "program": "${workspaceFolder}/build/test/${fileBasenameNoExtension}",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "args": [],</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "cwd": "${workspaceFolder}",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "stopAtEntry": false,</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "MIMode": "gdb",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "miDebuggerPath": "/usr/bin/gdb",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      "setupCommands": [</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        {</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          "description": "Test",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          "text": "python import sys;sys.path.insert(0, '/usr/share/gcc/python');from libstdcxx.v6.printers import register_libstdcxx_printers;register_libstdcxx_printers(None)",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          "ignoreFailures": false</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        },</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        {</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          "description": "Enable pretty-printing for gdb",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          "text": "-enable-pretty-printing",</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          "ignoreFailures": true</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        }</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      ]</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    }</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  ]</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">}</span><br/></span></code></pre></div></div>
<p>之後如果要執行 debug，設定好斷點對著 test file 按 <code>F5</code> 即可。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=background>Background<a href=#background class=hash-link aria-label=Background的直接連結 title=Background的直接連結 translate=no>​</a></h2>
<p>在開始寫之前，強烈建議先讀一下作業說明中有關 Hyperloglog 的說明，接下來我也會簡單介紹一下 Hyperloglog 的原理。</p>
<p>HyperLogLog 是一種用來估算集合中不重複元素數量的資料結構。
它最大的優勢是能夠在固定空間與常數時間內完成估算，非常適合用於大規模資料處理。</p>
<p>舉例來說，假設我們想要計算過去一週有多少不同使用者造訪過我們的網站。傳統作法可能是 :</p>
<ul>
<li>使用一個 set 儲存所有使用者 ID</li>
<li>將所有紀錄排序，再透過類似 merge 的方法來計算不重複的 ID</li>
</ul>
<p>這些方法在理論上可行，但在使用者數量龐大時，會消耗大量的記憶體與 CPU，因此實務上難以應用。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=min-hash>Min Hash<a href=#min-hash class=hash-link aria-label="Min Hash的直接連結" title="Min Hash的直接連結" translate=no>​</a></h3>
<p>估算不重覆數字的方法有很多，其中一個做法是將數字 hash 成一個 0~1 之間的浮點數，然後估計這個不重覆的數量為 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mn>1</mn><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi mathvariant=normal>_</mi><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi></mrow></mfrac></mrow><annotation encoding=application/x-tex>\frac{1}{min\_hash}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.4071em;vertical-align:-0.562em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span><span class="mord mtight" style=margin-right:0.02778em>_</span><span class="mord mathnormal mtight">ha</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">h</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:0.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.562em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，其中 <code>min_hash</code> 是所有 hash 值中最小的那個。</p>
<p>這個做法的問題是有可能出現極端值，導致結果誤差很大。</p>
<figure class=image-modal-container><img src=/RulerChen-Website/img/cmu15-445/p0/image.webp alt="" width=100% class=image-modal-thumbnail style=cursor:pointer loading=lazy /><figcaption class=image-modal-caption>Min Hash</figcaption></figure>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=probabilistic-counting>Probabilistic Counting<a href=#probabilistic-counting class=hash-link aria-label="Probabilistic Counting的直接連結" title="Probabilistic Counting的直接連結" translate=no>​</a></h3>
<p>為了降低這個變異值，因此有了 probabilistic counting 的做法。
這個做法是將 hash 值轉成二進位的數字，然後計算從最左邊開始數到第一個 <code>1</code> 為止的 <code>leading zeros</code> 的數量。
假設所有集合中最大的 <code>leading zeros</code> 為 <code>k</code>，那麼我們就可以估計這個不重覆的數量為 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=application/x-tex>2^k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8491em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em><span style=top:-3.063em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em>k</span></span></span></span></span></span></span></span></span></span></span>。</p>
<p>這個做法在一定程度上降低了變異值，但仍然有可能出現極端值，導致結果誤差很大。</p>
<figure class=image-modal-container><img src=/RulerChen-Website/img/cmu15-445/p0/image-1.webp alt="" width=100% class=image-modal-thumbnail style=cursor:pointer loading=lazy /><figcaption class=image-modal-caption>Probabilistic Counting</figcaption></figure>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=multiple-hash-functions>Multiple Hash Functions<a href=#multiple-hash-functions class=hash-link aria-label="Multiple Hash Functions的直接連結" title="Multiple Hash Functions的直接連結" translate=no>​</a></h3>
<p>為了減輕單一資料的影響，後來有人提出了使用多個獨立的 hash function 的做法。
通過使用多個獨立的 hash function，我們可以得到多個不同的 <code>leading zeros</code> 數量，然後取這些數量的平均值來估計不重覆的數量。</p>
<p>缺點是計算成本較高，因為每筆資料都需要經過多次 hash。</p>
<figure class=image-modal-container><img src=/RulerChen-Website/img/cmu15-445/p0/image-2.webp alt="" width=100% class=image-modal-thumbnail style=cursor:pointer loading=lazy /><figcaption class=image-modal-caption>Multiple Hash Functions</figcaption></figure>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=loglog>LogLog<a href=#loglog class=hash-link aria-label=LogLog的直接連結 title=LogLog的直接連結 translate=no>​</a></h3>
<p>為了降低計算量，學者們提出了將 hash 值分成多個部分的做法，也就是 <code>LogLog</code>。</p>
<p>它將 hash 值分成前 <code>n_bits</code> 個 bits 跟後面的 bits，前面的 <code>n_bits</code> 個 bits 用來決定桶的 index，後面的 bits 用來計算 <code>leading zeros</code> 的數量。
這樣子我們就可以使用單一的 hash function 來達到類似多個獨立 hash function 的效果。</p>
<p>如下圖所示，前面 4 個 bits (1011 -> 11) 用來決定桶的 index，後面的 bits (0111...100000) 用來計算 <code>leading zeros</code> 的數量 (5)。
作業裡面是從前面開始算，這裡是從後面。</p>
<figure class=image-modal-container><img src=/RulerChen-Website/img/cmu15-445/p0/image-3.webp alt="" width=100% class=image-modal-thumbnail style=cursor:pointer loading=lazy /><figcaption class=image-modal-caption>LogLog</figcaption></figure>
<p>我們可以用以下的公式來計算基數 (cardinality) :</p>
<span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>C</mi><mi>a</mi><mi>r</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>t</mi><msub><mi>y</mi><mrow><mi>L</mi><mi>o</mi><mi>g</mi><mi>L</mi><mi>o</mi><mi>g</mi></mrow></msub><mo>=</mo><mi>C</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>t</mi><mo>∗</mo><mi>m</mi><mo>∗</mo><msup><mn>2</mn><mrow><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>R</mi><mi>j</mi></msub></mrow></msup></mrow><annotation encoding=application/x-tex>
Cardinality_{LogLog} = Constant * m * 2^{\frac{1}{m} \sum_{j=1}^{N} R_j}
</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.9805em;vertical-align:-0.2861em></span><span class="mord mathnormal" style=margin-right:0.07153em>C</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style=margin-right:0.02778em>r</span><span class="mord mathnormal">d</span><span class="mord mathnormal">ina</span><span class="mord mathnormal" style=margin-right:0.01968em>l</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">gL</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style=margin-right:0.03588em>g</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:0.6833em></span><span class="mord mathnormal" style=margin-right:0.07153em>C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mord mathnormal">t</span><span class=mspace style=margin-right:0.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:0.2222em></span></span><span class=base><span class=strut style=height:0.4653em></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:0.2222em></span></span><span class=base><span class=strut style=height:1.0733em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.0733em><span style=top:-3.43em;margin-right:0.05em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8443em><span style=top:-2.656em><span class=pstrut style=height:3em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style=top:-3.2255em><span class=pstrut style=height:3em></span><span class="frac-line mtight" style=border-bottom-width:0.049em></span></span><span style=top:-3.384em><span class=pstrut style=height:3em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.344em><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mspace mtight" style=margin-right:0.1952em></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style=position:relative;top:0em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.9191em><span style=top:-2.1786em;margin-left:0em;margin-right:0.0714em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em>j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-2.931em;margin-right:0.0714em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4603em><span></span></span></span></span></span></span><span class="mspace mtight" style=margin-right:0.1952em></span><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3281em><span style=top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2819em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>Constant 經過統計推導出來的值為 0.79402，m 為桶的數量，<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub></mrow><annotation encoding=application/x-tex>R_j</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.9694em;vertical-align:-0.2861em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:-0.0077em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em><span></span></span></span></span></span></span></span></span></span> 為第 j 個桶中的 <code>leading zeros</code> 的數量，這樣的結果可以使誤差到達到 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mn>1.3</mn><msqrt><mi>m</mi></msqrt></mfrac></mrow><annotation encoding=application/x-tex>\frac{1.3}{\sqrt{m}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3831em;vertical-align:-0.538em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em><span style=top:-2.6259em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8059em><span class=svg-align style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mtight" style=padding-left:0.833em><span class="mord mathnormal mtight">m</span></span></span><span style=top:-2.7659em><span class=pstrut style=height:3em></span><span class="hide-tail mtight" style=min-width:0.853em;height:1.08em><svg xmlns=http://www.w3.org/2000/svg width=400em height=1.08em viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2341em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:0.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1.3</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.538em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=superloglog--hyperloglog>SuperLogLog & HyperLogLog<a href=#superloglog--hyperloglog class=hash-link aria-label="SuperLogLog & HyperLogLog的直接連結" title="SuperLogLog & HyperLogLog的直接連結" translate=no>​</a></h3>
<p>後續又有進一步改良版本，有名的有 <code>SuperLogLog</code> 和 <code>HyperLogLog</code> 兩種 :</p>
<ul>
<li>SuperLogLog : 丟棄最大 30% 的桶值再取平均，可以使誤差到達 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mn>1.05</mn><msqrt><mi>m</mi></msqrt></mfrac></mrow><annotation encoding=application/x-tex>\frac{1.05}{\sqrt{m}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3831em;vertical-align:-0.538em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em><span style=top:-2.6259em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8059em><span class=svg-align style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mtight" style=padding-left:0.833em><span class="mord mathnormal mtight">m</span></span></span><span style=top:-2.7659em><span class=pstrut style=height:3em></span><span class="hide-tail mtight" style=min-width:0.853em;height:1.08em><svg xmlns=http://www.w3.org/2000/svg width=400em height=1.08em viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2341em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:0.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1.05</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.538em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>HyperLogLog : 使用調和平均 (harmonic mean) 來取代算術平均 (arithmetic mean)，可以使誤差到達 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mn>1.04</mn><msqrt><mi>m</mi></msqrt></mfrac></mrow><annotation encoding=application/x-tex>\frac{1.04}{\sqrt{m}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3831em;vertical-align:-0.538em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8451em><span style=top:-2.6259em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8059em><span class=svg-align style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mtight" style=padding-left:0.833em><span class="mord mathnormal mtight">m</span></span></span><span style=top:-2.7659em><span class=pstrut style=height:3em></span><span class="hide-tail mtight" style=min-width:0.853em;height:1.08em><svg xmlns=http://www.w3.org/2000/svg width=400em height=1.08em viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2341em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:0.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1.04</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.538em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
<p>而這次的作業要實作的就是 HyperLogLog。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=task-1---hyperloglog>Task 1 - Hyperloglog<a href=#task-1---hyperloglog class=hash-link aria-label="Task 1 - Hyperloglog的直接連結" title="Task 1 - Hyperloglog的直接連結" translate=no>​</a></h2>
<p>首先我們會將所有的元素 hash 成一個 64 bits 的整數，然後將這個整數分成兩個部分，右邊數來前面的 <code>n_bits</code> 代表桶的 index (總共有 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mn>2</mn><mrow><mi>n</mi><mi mathvariant=normal>_</mi><mi>b</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></msup></mrow><annotation encoding=application/x-tex>2^{n\_bits}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8491em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em><span style=top:-3.063em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight" style=margin-right:0.02778em>_</span><span class="mord mathnormal mtight">bi</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span></span></span> 個桶)，在這些數字之後，我們就要開始數 <code>leading zeros</code> 的數量直到遇到第一個 <code>1</code> 為止 (包含 <code>1</code>)，再把 <code>leading zeros</code> 取最大值之後放進桶裡面，最後再用這些桶來估計不重複的元素的數量。</p>
<p>舉例來說，如果 <code>n_bits</code> 為 4，然後 hash 出來的值為 <code>101101110000011111...</code>，那麼 bucket index 為 <code>1011</code> (11)，<code>leading zeros</code> 為 <code>01</code> (2)。</p>
<p>這個 task 有兩個寫好的 function，分別是 :</p>
<ul>
<li><code>CalculateHash</code> : 將傳進來的值做 hash，並回傳 <code>unsigned long</code> (64 bits)的整數</li>
<li><code>ComputeBinary</code> : 將 hash 值轉成二進位的數字</li>
</ul>
<p>在 <code>AddElem</code> 中，我們會呼叫這兩個 function 來取得二進位的表示法。</p>
<p>有四個 function 需要實作，分別是 :</p>
<ul>
<li><code>HyperLogLog</code> : 初始化桶的數量，並且將所有的桶的值設成 0，需要注意的是需要處理傳進來的 <code>n_bits</code> 有可能會是負數的情況</li>
<li><code>PositionOfLeftmostOne</code> : 計算二進位表示法中從 bucket_index 結束後的下一個 bit 開始到第一個 <code>1</code> 的位置，要特別注意的是 <code>1</code> 的位置也需要計算，並且如果 <code>n_bits</code> 為 0，也需要保留第一個 bit 當作 index</li>
<li><code>AddElem</code> : 使用提供的函數將 <code>val</code> 轉成 <code>std::bitset</code>，接著計算桶的 index 和 <code>leading zeros</code> 的數量，最後取最大值放進桶裡面</li>
<li><code>ComputeCardinality</code> : 回傳計算後的 cardinality，依照公式來寫即可，最後記得用 <code>std::floor</code> 來取整數，並且要注意 <code>n_bits</code> 為 0 的情況</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=task-2---presto-hyperloglog>Task 2 - Presto Hyperloglog<a href=#task-2---presto-hyperloglog class=hash-link aria-label="Task 2 - Presto Hyperloglog的直接連結" title="Task 2 - Presto Hyperloglog的直接連結" translate=no>​</a></h2>
<p>Task 2 主要是要實作 Presto Hyperloglog，是一種 Hyperloglog 的修改版，可以優化空間使用率。</p>
<p>在這個修改版中，儲存會分成兩個部分，分別是 <code>dense_bucket_</code> 跟 <code>overflow_bucket_</code>，我們會將最後 4 bits 放到 <code>dense_bucket_</code>，剩下的 bits 放到 <code>overflow_bucket_</code>。</p>
<p>舉例來說，如果 <code>n_bits</code> 為 4，然後 hash 出來的值為 <code>1011...0000100001</code>，那麼 dense bucket 為 <code>0001</code> (1)，overflow bucket 為 <code>010</code> (2)。</p>
<p>這個 task 主要有三個 function 需要實作，這三個的邏輯跟 task 1 的差不多，只需要注意 <code>dense_bucket_</code> 和 <code>overflow_bucket_</code> 的處理。</p>
<ul>
<li><code>PrestoHyperLogLog</code> : 與 task 1 類似，只是改成要初始化 <code>dense_bucket_</code></li>
<li><code>AddElem</code> : 與 task 1 類似，只是要注意計算方式改成從最右邊開始取值到第一個 <code>1</code> 的位置 (不包含 <code>1</code>)</li>
<li><code>ComputeCardinality</code> : 與 task 1 類似，只是將 <code>overflow_bucket_</code> 左移 4 bits 再相加</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=common-mistakes>Common Mistakes<a href=#common-mistakes class=hash-link aria-label="Common Mistakes的直接連結" title="Common Mistakes的直接連結" translate=no>​</a></h2>
<p>我覺得這個作業需要注意的是類別，特別是 <code>hash_t</code> 是 <code>unsigned long</code> (無正負數 64 bits)，要特別小心 overflow 的問題。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=submit>Submit<a href=#submit class=hash-link aria-label=Submit的直接連結 title=Submit的直接連結 translate=no>​</a></h2>
<ol>
<li>將 <code>/test/primer/hyperloglog_test.cpp</code> 的所有 test case 中的 <code>DISABLE_</code> 都移除，舉例來說 :</li>
</ol>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockTitle_OeMC>test/primer/hyperloglog_test.cpp</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token function" style="color:rgb(80, 250, 123)">TEST</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">HyperLogLogTest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> DISABLE_BasicTest1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br/></span></code></pre></div></div>
<p>改成</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockTitle_OeMC>test/primer/hyperloglog_test.cpp</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token function" style="color:rgb(80, 250, 123)">TEST</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">HyperLogLogTest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> BasicTest1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br/></span></code></pre></div></div>
<ol start=2>
<li>修改 <code>CMakeLists.txt</code>，將 <code>P0_FILES</code> 設定為以下 (也可以順便把 <code>P1_FILES</code> 也加入這個，後面會用到) :</li>
</ol>
<div class="language-CMake language-cmake codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockTitle_OeMC>CMakeLists.txt</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">set(P0_FILES</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        "src/include/primer/hyperloglog.h"</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        "src/include/primer/hyperloglog_presto.h"</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        "src/primer/hyperloglog.cpp"</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        "src/primer/hyperloglog_presto.cpp"</span></span><br/></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">        "GRADESCOPE.md"</span></span><br/></span><span class="token-line codeLine_lJS_" style=color:#F8F8F2><span class=codeLineNumber_Tfdd></span><span class=codeLineContent_feaV><span class="token plain">)</span></span><br/></span></code></pre></div></div>
<ol start=3>
<li>排版，確定消除所有 error 和 warning (可以忽略 <code>DeprecationWarning: module 'sre_compile' is deprecated</code> 的 warning) :</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">make format && check-format && make check-lint && make check-clang-tidy-p0</span><br/></span></code></pre></div></div>
<ol start=4>
<li>編譯並測試所有的 test case</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_C_COMPILER=/usr/bin/clang-14 -DCMAKE_CXX_COMPILER=/usr/bin/clang++-14 -B build</span><br/></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">cd build</span><br/></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">make -j$(nproc) hyperloglog_test && ./test/hyperloglog_test</span><br/></span></code></pre></div></div>
<p>並確認所有的 test case 都能通過。</p>
<ol start=5>
<li>簽名，會產生一個 <code>GRADESCOPE.md</code> :</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">python3 gradescope_sign.py</span><br/></span></code></pre></div></div>
<ol start=6>
<li>繳交作業，可能需要先執行 <code>sudo apt-get install zip</code> 來安裝 <code>zip</code>，然後執行以下指令 :</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">make submit-p0</span><br/></span></code></pre></div></div>
<ol start=7>
<li>
<p>註冊 GradeScope，可以參考 <a href=https://15445.courses.cs.cmu.edu/fall2024/faq.html target=_blank rel="noopener noreferrer">官網</a> 的 Q7。</p>
</li>
<li>
<p>上傳 <code>.zip</code> 檔到 GradeScope</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=takeaways>Takeaways<a href=#takeaways class=hash-link aria-label=Takeaways的直接連結 title=Takeaways的直接連結 translate=no>​</a></h2>
<p>這是我第一次接觸 C++ 的專案，之前都只有用來寫 leetcode 題目，對於 C++ 如何建構專案花了蠻多時間在研究的，不然我覺得純寫 code 的時間應該 1-2 天可以搞定 (吧?)。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=references>References<a href=#references class=hash-link aria-label=References的直接連結 title=References的直接連結 translate=no>​</a></h2>
<ul>
<li><a href=https://engineering.fb.com/2018/12/13/data-infrastructure/hyperloglog/ target=_blank rel="noopener noreferrer">HyperLogLog in Presto: A significantly faster way to handle cardinality estimation</a></li>
</ul></div><div style=margin-top:32px></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class=col><b>標籤：</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/RulerChen-Website/docs/tags/cmu-15-445/>CMU15-445</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/RulerChen-Website/docs/tags/cmu-15-445-projects/>CMU15-445 Projects</a></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/RulerChen/RulerChen-Website/tree/main/docs/CMU15-445/p0.mdx target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>編輯此頁</a></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>最後<!-- -->於 <b><time datetime=2025-09-16T12:39:40.000Z itemprop=dateModified>2025年9月16日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label=文件選項卡><a class="pagination-nav__link pagination-nav__link--prev" href=/RulerChen-Website/docs/CMU15-445/c24/><div class=pagination-nav__sublabel>上一頁</div><div class=pagination-nav__label>Distributed OLAP Database Systems</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/RulerChen-Website/docs/CMU15-445/p1/><div class=pagination-nav__sublabel>下一頁</div><div class=pagination-nav__label>P1 - Buffer Pool Manager</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#learning-resource class="table-of-contents__link toc-highlight">Learning Resource</a><li><a href=#environment-setup class="table-of-contents__link toc-highlight">Environment Setup</a><li><a href=#background class="table-of-contents__link toc-highlight">Background</a><ul><li><a href=#min-hash class="table-of-contents__link toc-highlight">Min Hash</a><li><a href=#probabilistic-counting class="table-of-contents__link toc-highlight">Probabilistic Counting</a><li><a href=#multiple-hash-functions class="table-of-contents__link toc-highlight">Multiple Hash Functions</a><li><a href=#loglog class="table-of-contents__link toc-highlight">LogLog</a><li><a href=#superloglog--hyperloglog class="table-of-contents__link toc-highlight">SuperLogLog & HyperLogLog</a></ul><li><a href=#task-1---hyperloglog class="table-of-contents__link toc-highlight">Task 1 - Hyperloglog</a><li><a href=#task-2---presto-hyperloglog class="table-of-contents__link toc-highlight">Task 2 - Presto Hyperloglog</a><li><a href=#common-mistakes class="table-of-contents__link toc-highlight">Common Mistakes</a><li><a href=#submit class="table-of-contents__link toc-highlight">Submit</a><li><a href=#takeaways class="table-of-contents__link toc-highlight">Takeaways</a><li><a href=#references class="table-of-contents__link toc-highlight">References</a></ul></div></div></div></div></main></div></div></div></div></body>